{{ define "institutions/form.html" }}

{{ template "shared/_header.html" .}}

<!-- TODO: Make this an actual modal instead of a page -->
<div class="modal-edit">
  <form action="{{ .form.Action }}" id="instForm" method="post">

    {{ if .FormError }}
    <div class="row form-error">
      {{ .FormError }}
    </div>
    {{ end }}
  
    <div class="columns">
      <div class="column">{{ template "forms/text_input.html" .form.Fields.Name }}</div>
      <div class="column">{{ template "forms/text_input.html" .form.Fields.Identifier }}</div>
      <div class="column">{{ template "forms/select.html" .form.Fields.Type }}</div>
    </div>
  
    <div class="columns">
      <div class="column">{{ template "forms/select.html" .form.Fields.MemberInstitutionID }}</div>
      <div class="column">{{ template "forms/select.html" .form.Fields.OTPEnabled }}</div>
      <div class="column">{{ template "forms/select.html" .form.Fields.EnableSpotRestore }}</div>
    </div>
  
    <div class="columns">
      <div class="column">{{ template "forms/text_input.html" .form.Fields.ReceivingBucket }}</div>
      <div class="column">{{ template "forms/text_input.html" .form.Fields.RestoreBucket }}</div>
    </div>
  
    {{ template "forms/csrf_token.html" . }}
  
    <div class="is-flex">
      <input class="button is-primary mr-4" type="submit" value="Submit">
      <a class="button" href="javascript:history.back()">Cancel</a>
    </div>  
  
  </form>
</div>

<script>
// Enable/disable parent institution select list based on institution type.
window.addEventListener('load', (event) => {
  let typeList = document.forms['instForm'].elements.Type
  let parentList = document.forms['instForm'].elements.MemberInstitutionID
  typeList.addEventListener('change', (e) => {
      if (typeList.value == "MemberInstitution") {
        parentList.value = ''
        parentList.disabled = true
      } else {
        parentList.disabled = false
      }
  })
});
</script>

{{ template "shared/_footer.html" .}}

{{ end }}
