{{ define "reports/_deposit_chart.html" }}

<!-- Chart -->
<div class="row">
  <canvas id="depositChart" style="height: 400px;"></canvas>
</div>

<script>
 const depositData = {{ toJSON .deposits }};

 // TODO: Move colors from Go to JS, so that when chart is redrawn,
 // it can pick up new colors. Each redrawing will change the number
 // of elements in the chart.
 //
 // See: helpers/template.go, template_test.go, and constants/charts.go.
 // This stuff should probably go into static/js/modules/chart.js
 const data = {
     labels: [
         {{- range $index, $label := .chartLabels -}}
         "{{ $label }}",
         {{- end -}}
     ],
     datasets: [{
         label: 'Deposits as of {{ dateUS .reportParams.UpdatedBefore }}',
         data: [65, 59, 80, 81, 56, 55, 40],
         backgroundColor: [
             {{- range $index, $label := .chartLabels -}}
             "{{ chartColor $index }}",
             {{- end -}}
         ],
         borderColor: [
             {{- range $index, $label := .chartLabels -}}
             "{{ chartBorderColor $index }}",
             {{- end -}}
         ],
         borderWidth: 1
     }]
 };

 // TODO: Allow re-initialization to chart different values.
 // e.g. - GB or TB or Cost by institution or storage type.
 function initChart(elementId, label) {
     let ctx = document.getElementById(elementId);
     let copyOfData = JSON.parse(JSON.stringify(data))
     copyOfData.datasets[0].label = label
     return new Chart(ctx, { type: 'bar', data: copyOfData })
 }

 window.addEventListener('load', (event) => {
     initChart("depositChart", "Deposits")
 });

</script>

{{ end }}
