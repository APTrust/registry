{{ define "users/validate_totp.html" }}

<!-- Show the header unless query string says modal=true -->
{{ if not .showAsModal }}
  {{ template "shared/_header.html" .}}
{{ end }}

<div class="box" style="padding: 5px 30px;">
  <div class="box-header">
    <h2>Enter One-Time Code From Your Authenticator App</h2>
  </div>

  <div class="modal-content">
    <p class="mb-5">Using your authenticator app, please enter the one-time code that you see for APTrust.</p>

    {{ if .errorMessage }}
      <p class="mb-5">{{ .errorMessage }}</p> 
    {{ end }}

    <form name="validateTOTP" method="post" action="/users/validate_totp">
      <input name="totpCode" type="password" label="One-Time Code" autofocus>
      {{ if .firstConfirm }}
          <input name="firstConfirm" type="text" value="firstConfirm" style="visibility:hidden">  
      {{ end }}
      {{ template "forms/csrf_token.html" . }}
      <input class="button" type="submit" value="Continue">
      {{ if .firstConfirm }}
          <input class="button" onclick="cancelSetup()" value="Cancel Setup">
      {{ end }}
    </form>
    <br/><br/>
  </div>
</div>

<script>
    function cancelSetup(){
        window.location = "/users/my_account"
    }
</script>
<!-- Show the footer unless query string says modal=true -->
{{ if not .showAsModal }}
  {{ template "shared/_footer.html" .}}
{{ end }}


{{ end }}
