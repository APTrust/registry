{"level":"info","time":"2022-06-22T13:30:17-04:00","message":"Email service is disabled. Alerts will be written to the log file."}
{"level":"info","time":"2022-06-22T13:30:17-04:00","message":"Two-factor SMS is disabled. OTP codes will be written to the log file."}
{"level":"info","time":"2022-06-22T13:30:17-04:00","message":"Initializing cron jobs"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"info","time":"2022-06-22T13:30:17-04:00","message":"cron: starting update_counts() to refresh views"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: select update_counts()"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:17-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"cron: update_counts completed after 0.108914 seconds"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: select update_counts();"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\" FROM \"users\" AS \"user\" LIMIT 3"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" LIMIT 3"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" LIMIT 3"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: INSERT INTO \"alerts\" (\"id\", \"institution_id\", \"type\", \"subject\", \"content\", \"deletion_request_id\", \"created_at\") VALUES (DEFAULT, 2, 'Restoration Completed', 'Order Up!', 'Your fries are ready.', DEFAULT, '2022-06-22 17:30:18.714854+00:00:00') RETURNING \"id\", \"deletion_request_id\""}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_premis_events (alert_id, premis_event_id) values (9, 1) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_premis_events (alert_id, premis_event_id) values (9, 2) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_premis_events (alert_id, premis_event_id) values (9, 3) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_work_items (alert_id, work_item_id) values (9, 1) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_work_items (alert_id, work_item_id) values (9, 2) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_work_items (alert_id, work_item_id) values (9, 3) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_users (alert_id, user_id, sent_at, read_at) values (9, 4, NULL, NULL) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_users (alert_id, user_id, sent_at, read_at) values (9, 5, NULL, NULL) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: insert into alerts_users (alert_id, user_id, sent_at, read_at) values (9, 7, NULL, NULL) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert\".\"id\", \"alert\".\"institution_id\", \"alert\".\"type\", \"alert\".\"subject\", \"alert\".\"content\", \"alert\".\"deletion_request_id\", \"alert\".\"created_at\", \"deletion_request\".\"id\" AS \"deletion_request__id\", \"deletion_request\".\"institution_id\" AS \"deletion_request__institution_id\", \"deletion_request\".\"requested_by_id\" AS \"deletion_request__requested_by_id\", \"deletion_request\".\"requested_at\" AS \"deletion_request__requested_at\", \"deletion_request\".\"encrypted_confirmation_token\" AS \"deletion_request__encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\" AS \"deletion_request__confirmed_by_id\", \"deletion_request\".\"confirmed_at\" AS \"deletion_request__confirmed_at\", \"deletion_request\".\"cancelled_by_id\" AS \"deletion_request__cancelled_by_id\", \"deletion_request\".\"cancelled_at\" AS \"deletion_request__cancelled_at\", \"deletion_request\".\"work_item_id\" AS \"deletion_request__work_item_id\" FROM \"alerts\" AS \"alert\" LEFT JOIN \"deletion_requests\" AS \"deletion_request\" ON \"deletion_request\".\"id\" = \"alert\".\"deletion_request_id\" WHERE ((\"alert\".\"id\" = 9))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alerts_premis_events\".*, \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" JOIN \"alerts_premis_events\" AS \"alerts_premis_events\" ON (\"alerts_premis_events\".\"alert_id\") IN (9) WHERE (\"premis_event\".\"id\" = \"alerts_premis_events\".\"premis_event_id\")"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alerts_users\".*, \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\" FROM \"users\" AS \"user\" JOIN \"alerts_users\" AS \"alerts_users\" ON (\"alerts_users\".\"alert_id\") IN (9) WHERE (\"user\".\"id\" = \"alerts_users\".\"user_id\")"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alerts_work_items\".*, \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" JOIN \"alerts_work_items\" AS \"alerts_work_items\" ON (\"alerts_work_items\".\"alert_id\") IN (9) WHERE (\"work_item\".\"id\" = \"alerts_work_items\".\"work_item_id\")"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 9) AND (\"alert_view\".\"user_id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: update alerts_users set sent_at = '2022-06-22 17:30:18.736448+00:00:00' where alert_id = 9 and user_id = 4"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 9) AND (\"alert_view\".\"user_id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 9) AND (\"alert_view\".\"user_id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: update alerts_users set read_at = '2022-06-22 17:30:18.741048+00:00:00' where alert_id = 9 and user_id = 4"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 9) AND (\"alert_view\".\"user_id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 9) AND (\"alert_view\".\"user_id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: update alerts_users set read_at = null where alert_id = 9 and user_id = 4"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 9) AND (\"alert_view\".\"user_id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert\".\"id\", \"alert\".\"institution_id\", \"alert\".\"type\", \"alert\".\"subject\", \"alert\".\"content\", \"alert\".\"deletion_request_id\", \"alert\".\"created_at\" FROM \"alerts\" AS \"alert\" WHERE ((institution_id = 2))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 1) AND (\"alert_view\".\"user_id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = 1)) ORDER BY \"created_at\" asc"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((\"checksum\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((algorithm = 'sha256')) LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((algorithm = 'sha256')) LIMIT 4"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:18.755362+00:00:00', '2022-06-22 17:30:18.755387+00:00:00', 'md5', '2022-06-22 17:30:18.755362+00:00:00', '6a78c1954fce4ffdbb05da7db35bba40', 1) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFile"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEvent"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItem"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): User"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type User: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): UserView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type UserView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): Institution"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type Institution: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): InstitutionView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type InstitutionView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFile"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEvent"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItem"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): User"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type User: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): UserView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type UserView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): Institution"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type Institution: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): InstitutionView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Cannot query count view for type InstitutionView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFile"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEvent"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for PremisEvent: state -> institution_id, event_type, outcome"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for PremisEventView: state -> institution_id, event_type, outcome"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItem"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for WorkItem: state -> institution_id, action"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for WorkItemView: state -> institution_id, action"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItem"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFile"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for GenericFile: action -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for GenericFileView: action -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for IntellectualObject: action -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for IntellectualObjectView: action -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEvent"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for PremisEvent: action -> institution_id, event_type, outcome"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for PremisEventView: action -> institution_id, event_type, outcome"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEvent"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFile"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for GenericFile: event_type -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for GenericFileView: event_type -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for IntellectualObject: event_type -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for IntellectualObjectView: event_type -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItem"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for WorkItem: event_type -> institution_id, action"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for WorkItemView: event_type -> institution_id, action"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFile"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for GenericFile: storage_option -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for GenericFileView: storage_option -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for IntellectualObject: storage_option -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for IntellectualObjectView: storage_option -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEvent"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for PremisEvent: storage_option -> institution_id, event_type, outcome"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for PremisEventView: storage_option -> institution_id, event_type, outcome"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItem"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for WorkItem: storage_option -> institution_id, action"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:18-04:00","message":"Filter too specific for WorkItemView: storage_option -> institution_id, action"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:18-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: select update_counts();"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFile"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id is null) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFileView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id is null) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id is null) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id is null) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEvent"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id is null) AND (event_type is null) AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id is null) AND (event_type is null) AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItem"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id is null) AND (action is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id is null) AND (action is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFile"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 3) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFileView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 3) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id = 3) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id = 3) AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEvent"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 3) AND (event_type is null) AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 3) AND (event_type is null) AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItem"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 3) AND (action is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 3) AND (action is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFile"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 3) AND (state = 'A'))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFileView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 3) AND (state = 'A'))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): IntellectualObject"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id = 3) AND (state = 'A'))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id = 3) AND (state = 'A'))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEvent"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 3) AND (state = 'A') AND (event_type is null) AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 3) AND (state = 'A') AND (event_type is null) AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItem"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 3) AND (state = 'A') AND (action is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 3) AND (state = 'A') AND (action is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItem"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 2) AND (action = 'Ingest'))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 2) AND (action = 'Ingest'))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFile"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 2) AND (action = 'Ingest') AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): GenericFileView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 2) AND (action = 'Ingest') AND (state is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEvent"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 2) AND (event_type = 'ingestion') AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 2) AND (event_type = 'ingestion') AND (outcome is null))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEvent"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 2) AND (event_type = 'ingestion') AND (outcome = 'Failure'))"}
{"level":"info","time":"2022-06-22T13:30:19-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 2) AND (event_type = 'ingestion') AND (outcome = 'Failure'))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_request\".\"id\", \"deletion_request\".\"institution_id\", \"deletion_request\".\"requested_by_id\", \"deletion_request\".\"requested_at\", \"deletion_request\".\"encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\", \"deletion_request\".\"confirmed_at\", \"deletion_request\".\"cancelled_by_id\", \"deletion_request\".\"cancelled_at\", \"deletion_request\".\"work_item_id\", \"requested_by\".\"id\" AS \"requested_by__id\", \"requested_by\".\"created_at\" AS \"requested_by__created_at\", \"requested_by\".\"updated_at\" AS \"requested_by__updated_at\", \"requested_by\".\"name\" AS \"requested_by__name\", \"requested_by\".\"email\" AS \"requested_by__email\", \"requested_by\".\"phone_number\" AS \"requested_by__phone_number\", \"requested_by\".\"encrypted_password\" AS \"requested_by__encrypted_password\", \"requested_by\".\"reset_password_token\" AS \"requested_by__reset_password_token\", \"requested_by\".\"reset_password_sent_at\" AS \"requested_by__reset_password_sent_at\", \"requested_by\".\"remember_created_at\" AS \"requested_by__remember_created_at\", \"requested_by\".\"sign_in_count\" AS \"requested_by__sign_in_count\", \"requested_by\".\"current_sign_in_at\" AS \"requested_by__current_sign_in_at\", \"requested_by\".\"last_sign_in_at\" AS \"requested_by__last_sign_in_at\", \"requested_by\".\"current_sign_in_ip\" AS \"requested_by__current_sign_in_ip\", \"requested_by\".\"last_sign_in_ip\" AS \"requested_by__last_sign_in_ip\", \"requested_by\".\"institution_id\" AS \"requested_by__institution_id\", \"requested_by\".\"encrypted_api_secret_key\" AS \"requested_by__encrypted_api_secret_key\", \"requested_by\".\"password_changed_at\" AS \"requested_by__password_changed_at\", \"requested_by\".\"encrypted_otp_secret\" AS \"requested_by__encrypted_otp_secret\", \"requested_by\".\"encrypted_otp_secret_iv\" AS \"requested_by__encrypted_otp_secret_iv\", \"requested_by\".\"encrypted_otp_secret_salt\" AS \"requested_by__encrypted_otp_secret_salt\", \"requested_by\".\"encrypted_otp_sent_at\" AS \"requested_by__encrypted_otp_sent_at\", \"requested_by\".\"consumed_timestep\" AS \"requested_by__consumed_timestep\", \"requested_by\".\"otp_required_for_login\" AS \"requested_by__otp_required_for_login\", \"requested_by\".\"deactivated_at\" AS \"requested_by__deactivated_at\", \"requested_by\".\"enabled_two_factor\" AS \"requested_by__enabled_two_factor\", \"requested_by\".\"confirmed_two_factor\" AS \"requested_by__confirmed_two_factor\", \"requested_by\".\"otp_backup_codes\" AS \"requested_by__otp_backup_codes\", \"requested_by\".\"authy_id\" AS \"requested_by__authy_id\", \"requested_by\".\"last_sign_in_with_authy\" AS \"requested_by__last_sign_in_with_authy\", \"requested_by\".\"authy_status\" AS \"requested_by__authy_status\", \"requested_by\".\"email_verified\" AS \"requested_by__email_verified\", \"requested_by\".\"initial_password_updated\" AS \"requested_by__initial_password_updated\", \"requested_by\".\"force_password_update\" AS \"requested_by__force_password_update\", \"requested_by\".\"grace_period\" AS \"requested_by__grace_period\", \"requested_by\".\"awaiting_second_factor\" AS \"requested_by__awaiting_second_factor\", \"requested_by\".\"role\" AS \"requested_by__role\", \"confirmed_by\".\"id\" AS \"confirmed_by__id\", \"confirmed_by\".\"created_at\" AS \"confirmed_by__created_at\", \"confirmed_by\".\"updated_at\" AS \"confirmed_by__updated_at\", \"confirmed_by\".\"name\" AS \"confirmed_by__name\", \"confirmed_by\".\"email\" AS \"confirmed_by__email\", \"confirmed_by\".\"phone_number\" AS \"confirmed_by__phone_number\", \"confirmed_by\".\"encrypted_password\" AS \"confirmed_by__encrypted_password\", \"confirmed_by\".\"reset_password_token\" AS \"confirmed_by__reset_password_token\", \"confirmed_by\".\"reset_password_sent_at\" AS \"confirmed_by__reset_password_sent_at\", \"confirmed_by\".\"remember_created_at\" AS \"confirmed_by__remember_created_at\", \"confirmed_by\".\"sign_in_count\" AS \"confirmed_by__sign_in_count\", \"confirmed_by\".\"current_sign_in_at\" AS \"confirmed_by__current_sign_in_at\", \"confirmed_by\".\"last_sign_in_at\" AS \"confirmed_by__last_sign_in_at\", \"confirmed_by\".\"current_sign_in_ip\" AS \"confirmed_by__current_sign_in_ip\", \"confirmed_by\".\"last_sign_in_ip\" AS \"confirmed_by__last_sign_in_ip\", \"confirmed_by\".\"institution_id\" AS \"confirmed_by__institution_id\", \"confirmed_by\".\"encrypted_api_secret_key\" AS \"confirmed_by__encrypted_api_secret_key\", \"confirmed_by\".\"password_changed_at\" AS \"confirmed_by__password_changed_at\", \"confirmed_by\".\"encrypted_otp_secret\" AS \"confirmed_by__encrypted_otp_secret\", \"confirmed_by\".\"encrypted_otp_secret_iv\" AS \"confirmed_by__encrypted_otp_secret_iv\", \"confirmed_by\".\"encrypted_otp_secret_salt\" AS \"confirmed_by__encrypted_otp_secret_salt\", \"confirmed_by\".\"encrypted_otp_sent_at\" AS \"confirmed_by__encrypted_otp_sent_at\", \"confirmed_by\".\"consumed_timestep\" AS \"confirmed_by__consumed_timestep\", \"confirmed_by\".\"otp_required_for_login\" AS \"confirmed_by__otp_required_for_login\", \"confirmed_by\".\"deactivated_at\" AS \"confirmed_by__deactivated_at\", \"confirmed_by\".\"enabled_two_factor\" AS \"confirmed_by__enabled_two_factor\", \"confirmed_by\".\"confirmed_two_factor\" AS \"confirmed_by__confirmed_two_factor\", \"confirmed_by\".\"otp_backup_codes\" AS \"confirmed_by__otp_backup_codes\", \"confirmed_by\".\"authy_id\" AS \"confirmed_by__authy_id\", \"confirmed_by\".\"last_sign_in_with_authy\" AS \"confirmed_by__last_sign_in_with_authy\", \"confirmed_by\".\"authy_status\" AS \"confirmed_by__authy_status\", \"confirmed_by\".\"email_verified\" AS \"confirmed_by__email_verified\", \"confirmed_by\".\"initial_password_updated\" AS \"confirmed_by__initial_password_updated\", \"confirmed_by\".\"force_password_update\" AS \"confirmed_by__force_password_update\", \"confirmed_by\".\"grace_period\" AS \"confirmed_by__grace_period\", \"confirmed_by\".\"awaiting_second_factor\" AS \"confirmed_by__awaiting_second_factor\", \"confirmed_by\".\"role\" AS \"confirmed_by__role\", \"cancelled_by\".\"id\" AS \"cancelled_by__id\", \"cancelled_by\".\"created_at\" AS \"cancelled_by__created_at\", \"cancelled_by\".\"updated_at\" AS \"cancelled_by__updated_at\", \"cancelled_by\".\"name\" AS \"cancelled_by__name\", \"cancelled_by\".\"email\" AS \"cancelled_by__email\", \"cancelled_by\".\"phone_number\" AS \"cancelled_by__phone_number\", \"cancelled_by\".\"encrypted_password\" AS \"cancelled_by__encrypted_password\", \"cancelled_by\".\"reset_password_token\" AS \"cancelled_by__reset_password_token\", \"cancelled_by\".\"reset_password_sent_at\" AS \"cancelled_by__reset_password_sent_at\", \"cancelled_by\".\"remember_created_at\" AS \"cancelled_by__remember_created_at\", \"cancelled_by\".\"sign_in_count\" AS \"cancelled_by__sign_in_count\", \"cancelled_by\".\"current_sign_in_at\" AS \"cancelled_by__current_sign_in_at\", \"cancelled_by\".\"last_sign_in_at\" AS \"cancelled_by__last_sign_in_at\", \"cancelled_by\".\"current_sign_in_ip\" AS \"cancelled_by__current_sign_in_ip\", \"cancelled_by\".\"last_sign_in_ip\" AS \"cancelled_by__last_sign_in_ip\", \"cancelled_by\".\"institution_id\" AS \"cancelled_by__institution_id\", \"cancelled_by\".\"encrypted_api_secret_key\" AS \"cancelled_by__encrypted_api_secret_key\", \"cancelled_by\".\"password_changed_at\" AS \"cancelled_by__password_changed_at\", \"cancelled_by\".\"encrypted_otp_secret\" AS \"cancelled_by__encrypted_otp_secret\", \"cancelled_by\".\"encrypted_otp_secret_iv\" AS \"cancelled_by__encrypted_otp_secret_iv\", \"cancelled_by\".\"encrypted_otp_secret_salt\" AS \"cancelled_by__encrypted_otp_secret_salt\", \"cancelled_by\".\"encrypted_otp_sent_at\" AS \"cancelled_by__encrypted_otp_sent_at\", \"cancelled_by\".\"consumed_timestep\" AS \"cancelled_by__consumed_timestep\", \"cancelled_by\".\"otp_required_for_login\" AS \"cancelled_by__otp_required_for_login\", \"cancelled_by\".\"deactivated_at\" AS \"cancelled_by__deactivated_at\", \"cancelled_by\".\"enabled_two_factor\" AS \"cancelled_by__enabled_two_factor\", \"cancelled_by\".\"confirmed_two_factor\" AS \"cancelled_by__confirmed_two_factor\", \"cancelled_by\".\"otp_backup_codes\" AS \"cancelled_by__otp_backup_codes\", \"cancelled_by\".\"authy_id\" AS \"cancelled_by__authy_id\", \"cancelled_by\".\"last_sign_in_with_authy\" AS \"cancelled_by__last_sign_in_with_authy\", \"cancelled_by\".\"authy_status\" AS \"cancelled_by__authy_status\", \"cancelled_by\".\"email_verified\" AS \"cancelled_by__email_verified\", \"cancelled_by\".\"initial_password_updated\" AS \"cancelled_by__initial_password_updated\", \"cancelled_by\".\"force_password_update\" AS \"cancelled_by__force_password_update\", \"cancelled_by\".\"grace_period\" AS \"cancelled_by__grace_period\", \"cancelled_by\".\"awaiting_second_factor\" AS \"cancelled_by__awaiting_second_factor\", \"cancelled_by\".\"role\" AS \"cancelled_by__role\", \"work_item\".\"id\" AS \"work_item__id\", \"work_item\".\"created_at\" AS \"work_item__created_at\", \"work_item\".\"updated_at\" AS \"work_item__updated_at\", \"work_item\".\"name\" AS \"work_item__name\", \"work_item\".\"etag\" AS \"work_item__etag\", \"work_item\".\"institution_id\" AS \"work_item__institution_id\", \"work_item\".\"intellectual_object_id\" AS \"work_item__intellectual_object_id\", \"work_item\".\"generic_file_id\" AS \"work_item__generic_file_id\", \"work_item\".\"bucket\" AS \"work_item__bucket\", \"work_item\".\"user\" AS \"work_item__user\", \"work_item\".\"note\" AS \"work_item__note\", \"work_item\".\"action\" AS \"work_item__action\", \"work_item\".\"stage\" AS \"work_item__stage\", \"work_item\".\"status\" AS \"work_item__status\", \"work_item\".\"outcome\" AS \"work_item__outcome\", \"work_item\".\"bag_date\" AS \"work_item__bag_date\", \"work_item\".\"date_processed\" AS \"work_item__date_processed\", \"work_item\".\"retry\" AS \"work_item__retry\", \"work_item\".\"node\" AS \"work_item__node\", \"work_item\".\"pid\" AS \"work_item__pid\", \"work_item\".\"needs_admin_review\" AS \"work_item__needs_admin_review\", \"work_item\".\"queued_at\" AS \"work_item__queued_at\", \"work_item\".\"size\" AS \"work_item__size\", \"work_item\".\"stage_started_at\" AS \"work_item__stage_started_at\", \"work_item\".\"aptrust_approver\" AS \"work_item__aptrust_approver\", \"work_item\".\"inst_approver\" AS \"work_item__inst_approver\" FROM \"deletion_requests\" AS \"deletion_request\" LEFT JOIN \"users\" AS \"requested_by\" ON \"requested_by\".\"id\" = \"deletion_request\".\"requested_by_id\" LEFT JOIN \"users\" AS \"confirmed_by\" ON \"confirmed_by\".\"id\" = \"deletion_request\".\"confirmed_by_id\" LEFT JOIN \"users\" AS \"cancelled_by\" ON \"cancelled_by\".\"id\" = \"deletion_request\".\"cancelled_by_id\" LEFT JOIN \"work_items\" AS \"work_item\" ON \"work_item\".\"id\" = \"deletion_request\".\"work_item_id\" WHERE ((\"deletion_request\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_requests_generic_files\".*, \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" JOIN \"deletion_requests_generic_files\" AS \"deletion_requests_generic_files\" ON (\"deletion_requests_generic_files\".\"deletion_request_id\") IN (1) WHERE (\"generic_file\".\"id\" = \"deletion_requests_generic_files\".\"generic_file_id\")"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_requests_intellectual_objects\".*, \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" FROM \"intellectual_objects\" AS \"intellectual_object\" JOIN \"deletion_requests_intellectual_objects\" AS \"deletion_requests_intellectual_objects\" ON (\"deletion_requests_intellectual_objects\".\"deletion_request_id\") IN (1) WHERE (\"intellectual_object\".\"id\" = \"deletion_requests_intellectual_objects\".\"intellectual_object_id\")"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_request\".\"id\", \"deletion_request\".\"institution_id\", \"deletion_request\".\"requested_by_id\", \"deletion_request\".\"requested_at\", \"deletion_request\".\"encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\", \"deletion_request\".\"confirmed_at\", \"deletion_request\".\"cancelled_by_id\", \"deletion_request\".\"cancelled_at\", \"deletion_request\".\"work_item_id\", \"requested_by\".\"id\" AS \"requested_by__id\", \"requested_by\".\"created_at\" AS \"requested_by__created_at\", \"requested_by\".\"updated_at\" AS \"requested_by__updated_at\", \"requested_by\".\"name\" AS \"requested_by__name\", \"requested_by\".\"email\" AS \"requested_by__email\", \"requested_by\".\"phone_number\" AS \"requested_by__phone_number\", \"requested_by\".\"encrypted_password\" AS \"requested_by__encrypted_password\", \"requested_by\".\"reset_password_token\" AS \"requested_by__reset_password_token\", \"requested_by\".\"reset_password_sent_at\" AS \"requested_by__reset_password_sent_at\", \"requested_by\".\"remember_created_at\" AS \"requested_by__remember_created_at\", \"requested_by\".\"sign_in_count\" AS \"requested_by__sign_in_count\", \"requested_by\".\"current_sign_in_at\" AS \"requested_by__current_sign_in_at\", \"requested_by\".\"last_sign_in_at\" AS \"requested_by__last_sign_in_at\", \"requested_by\".\"current_sign_in_ip\" AS \"requested_by__current_sign_in_ip\", \"requested_by\".\"last_sign_in_ip\" AS \"requested_by__last_sign_in_ip\", \"requested_by\".\"institution_id\" AS \"requested_by__institution_id\", \"requested_by\".\"encrypted_api_secret_key\" AS \"requested_by__encrypted_api_secret_key\", \"requested_by\".\"password_changed_at\" AS \"requested_by__password_changed_at\", \"requested_by\".\"encrypted_otp_secret\" AS \"requested_by__encrypted_otp_secret\", \"requested_by\".\"encrypted_otp_secret_iv\" AS \"requested_by__encrypted_otp_secret_iv\", \"requested_by\".\"encrypted_otp_secret_salt\" AS \"requested_by__encrypted_otp_secret_salt\", \"requested_by\".\"encrypted_otp_sent_at\" AS \"requested_by__encrypted_otp_sent_at\", \"requested_by\".\"consumed_timestep\" AS \"requested_by__consumed_timestep\", \"requested_by\".\"otp_required_for_login\" AS \"requested_by__otp_required_for_login\", \"requested_by\".\"deactivated_at\" AS \"requested_by__deactivated_at\", \"requested_by\".\"enabled_two_factor\" AS \"requested_by__enabled_two_factor\", \"requested_by\".\"confirmed_two_factor\" AS \"requested_by__confirmed_two_factor\", \"requested_by\".\"otp_backup_codes\" AS \"requested_by__otp_backup_codes\", \"requested_by\".\"authy_id\" AS \"requested_by__authy_id\", \"requested_by\".\"last_sign_in_with_authy\" AS \"requested_by__last_sign_in_with_authy\", \"requested_by\".\"authy_status\" AS \"requested_by__authy_status\", \"requested_by\".\"email_verified\" AS \"requested_by__email_verified\", \"requested_by\".\"initial_password_updated\" AS \"requested_by__initial_password_updated\", \"requested_by\".\"force_password_update\" AS \"requested_by__force_password_update\", \"requested_by\".\"grace_period\" AS \"requested_by__grace_period\", \"requested_by\".\"awaiting_second_factor\" AS \"requested_by__awaiting_second_factor\", \"requested_by\".\"role\" AS \"requested_by__role\", \"confirmed_by\".\"id\" AS \"confirmed_by__id\", \"confirmed_by\".\"created_at\" AS \"confirmed_by__created_at\", \"confirmed_by\".\"updated_at\" AS \"confirmed_by__updated_at\", \"confirmed_by\".\"name\" AS \"confirmed_by__name\", \"confirmed_by\".\"email\" AS \"confirmed_by__email\", \"confirmed_by\".\"phone_number\" AS \"confirmed_by__phone_number\", \"confirmed_by\".\"encrypted_password\" AS \"confirmed_by__encrypted_password\", \"confirmed_by\".\"reset_password_token\" AS \"confirmed_by__reset_password_token\", \"confirmed_by\".\"reset_password_sent_at\" AS \"confirmed_by__reset_password_sent_at\", \"confirmed_by\".\"remember_created_at\" AS \"confirmed_by__remember_created_at\", \"confirmed_by\".\"sign_in_count\" AS \"confirmed_by__sign_in_count\", \"confirmed_by\".\"current_sign_in_at\" AS \"confirmed_by__current_sign_in_at\", \"confirmed_by\".\"last_sign_in_at\" AS \"confirmed_by__last_sign_in_at\", \"confirmed_by\".\"current_sign_in_ip\" AS \"confirmed_by__current_sign_in_ip\", \"confirmed_by\".\"last_sign_in_ip\" AS \"confirmed_by__last_sign_in_ip\", \"confirmed_by\".\"institution_id\" AS \"confirmed_by__institution_id\", \"confirmed_by\".\"encrypted_api_secret_key\" AS \"confirmed_by__encrypted_api_secret_key\", \"confirmed_by\".\"password_changed_at\" AS \"confirmed_by__password_changed_at\", \"confirmed_by\".\"encrypted_otp_secret\" AS \"confirmed_by__encrypted_otp_secret\", \"confirmed_by\".\"encrypted_otp_secret_iv\" AS \"confirmed_by__encrypted_otp_secret_iv\", \"confirmed_by\".\"encrypted_otp_secret_salt\" AS \"confirmed_by__encrypted_otp_secret_salt\", \"confirmed_by\".\"encrypted_otp_sent_at\" AS \"confirmed_by__encrypted_otp_sent_at\", \"confirmed_by\".\"consumed_timestep\" AS \"confirmed_by__consumed_timestep\", \"confirmed_by\".\"otp_required_for_login\" AS \"confirmed_by__otp_required_for_login\", \"confirmed_by\".\"deactivated_at\" AS \"confirmed_by__deactivated_at\", \"confirmed_by\".\"enabled_two_factor\" AS \"confirmed_by__enabled_two_factor\", \"confirmed_by\".\"confirmed_two_factor\" AS \"confirmed_by__confirmed_two_factor\", \"confirmed_by\".\"otp_backup_codes\" AS \"confirmed_by__otp_backup_codes\", \"confirmed_by\".\"authy_id\" AS \"confirmed_by__authy_id\", \"confirmed_by\".\"last_sign_in_with_authy\" AS \"confirmed_by__last_sign_in_with_authy\", \"confirmed_by\".\"authy_status\" AS \"confirmed_by__authy_status\", \"confirmed_by\".\"email_verified\" AS \"confirmed_by__email_verified\", \"confirmed_by\".\"initial_password_updated\" AS \"confirmed_by__initial_password_updated\", \"confirmed_by\".\"force_password_update\" AS \"confirmed_by__force_password_update\", \"confirmed_by\".\"grace_period\" AS \"confirmed_by__grace_period\", \"confirmed_by\".\"awaiting_second_factor\" AS \"confirmed_by__awaiting_second_factor\", \"confirmed_by\".\"role\" AS \"confirmed_by__role\", \"cancelled_by\".\"id\" AS \"cancelled_by__id\", \"cancelled_by\".\"created_at\" AS \"cancelled_by__created_at\", \"cancelled_by\".\"updated_at\" AS \"cancelled_by__updated_at\", \"cancelled_by\".\"name\" AS \"cancelled_by__name\", \"cancelled_by\".\"email\" AS \"cancelled_by__email\", \"cancelled_by\".\"phone_number\" AS \"cancelled_by__phone_number\", \"cancelled_by\".\"encrypted_password\" AS \"cancelled_by__encrypted_password\", \"cancelled_by\".\"reset_password_token\" AS \"cancelled_by__reset_password_token\", \"cancelled_by\".\"reset_password_sent_at\" AS \"cancelled_by__reset_password_sent_at\", \"cancelled_by\".\"remember_created_at\" AS \"cancelled_by__remember_created_at\", \"cancelled_by\".\"sign_in_count\" AS \"cancelled_by__sign_in_count\", \"cancelled_by\".\"current_sign_in_at\" AS \"cancelled_by__current_sign_in_at\", \"cancelled_by\".\"last_sign_in_at\" AS \"cancelled_by__last_sign_in_at\", \"cancelled_by\".\"current_sign_in_ip\" AS \"cancelled_by__current_sign_in_ip\", \"cancelled_by\".\"last_sign_in_ip\" AS \"cancelled_by__last_sign_in_ip\", \"cancelled_by\".\"institution_id\" AS \"cancelled_by__institution_id\", \"cancelled_by\".\"encrypted_api_secret_key\" AS \"cancelled_by__encrypted_api_secret_key\", \"cancelled_by\".\"password_changed_at\" AS \"cancelled_by__password_changed_at\", \"cancelled_by\".\"encrypted_otp_secret\" AS \"cancelled_by__encrypted_otp_secret\", \"cancelled_by\".\"encrypted_otp_secret_iv\" AS \"cancelled_by__encrypted_otp_secret_iv\", \"cancelled_by\".\"encrypted_otp_secret_salt\" AS \"cancelled_by__encrypted_otp_secret_salt\", \"cancelled_by\".\"encrypted_otp_sent_at\" AS \"cancelled_by__encrypted_otp_sent_at\", \"cancelled_by\".\"consumed_timestep\" AS \"cancelled_by__consumed_timestep\", \"cancelled_by\".\"otp_required_for_login\" AS \"cancelled_by__otp_required_for_login\", \"cancelled_by\".\"deactivated_at\" AS \"cancelled_by__deactivated_at\", \"cancelled_by\".\"enabled_two_factor\" AS \"cancelled_by__enabled_two_factor\", \"cancelled_by\".\"confirmed_two_factor\" AS \"cancelled_by__confirmed_two_factor\", \"cancelled_by\".\"otp_backup_codes\" AS \"cancelled_by__otp_backup_codes\", \"cancelled_by\".\"authy_id\" AS \"cancelled_by__authy_id\", \"cancelled_by\".\"last_sign_in_with_authy\" AS \"cancelled_by__last_sign_in_with_authy\", \"cancelled_by\".\"authy_status\" AS \"cancelled_by__authy_status\", \"cancelled_by\".\"email_verified\" AS \"cancelled_by__email_verified\", \"cancelled_by\".\"initial_password_updated\" AS \"cancelled_by__initial_password_updated\", \"cancelled_by\".\"force_password_update\" AS \"cancelled_by__force_password_update\", \"cancelled_by\".\"grace_period\" AS \"cancelled_by__grace_period\", \"cancelled_by\".\"awaiting_second_factor\" AS \"cancelled_by__awaiting_second_factor\", \"cancelled_by\".\"role\" AS \"cancelled_by__role\", \"work_item\".\"id\" AS \"work_item__id\", \"work_item\".\"created_at\" AS \"work_item__created_at\", \"work_item\".\"updated_at\" AS \"work_item__updated_at\", \"work_item\".\"name\" AS \"work_item__name\", \"work_item\".\"etag\" AS \"work_item__etag\", \"work_item\".\"institution_id\" AS \"work_item__institution_id\", \"work_item\".\"intellectual_object_id\" AS \"work_item__intellectual_object_id\", \"work_item\".\"generic_file_id\" AS \"work_item__generic_file_id\", \"work_item\".\"bucket\" AS \"work_item__bucket\", \"work_item\".\"user\" AS \"work_item__user\", \"work_item\".\"note\" AS \"work_item__note\", \"work_item\".\"action\" AS \"work_item__action\", \"work_item\".\"stage\" AS \"work_item__stage\", \"work_item\".\"status\" AS \"work_item__status\", \"work_item\".\"outcome\" AS \"work_item__outcome\", \"work_item\".\"bag_date\" AS \"work_item__bag_date\", \"work_item\".\"date_processed\" AS \"work_item__date_processed\", \"work_item\".\"retry\" AS \"work_item__retry\", \"work_item\".\"node\" AS \"work_item__node\", \"work_item\".\"pid\" AS \"work_item__pid\", \"work_item\".\"needs_admin_review\" AS \"work_item__needs_admin_review\", \"work_item\".\"queued_at\" AS \"work_item__queued_at\", \"work_item\".\"size\" AS \"work_item__size\", \"work_item\".\"stage_started_at\" AS \"work_item__stage_started_at\", \"work_item\".\"aptrust_approver\" AS \"work_item__aptrust_approver\", \"work_item\".\"inst_approver\" AS \"work_item__inst_approver\" FROM \"deletion_requests\" AS \"deletion_request\" LEFT JOIN \"users\" AS \"requested_by\" ON \"requested_by\".\"id\" = \"deletion_request\".\"requested_by_id\" LEFT JOIN \"users\" AS \"confirmed_by\" ON \"confirmed_by\".\"id\" = \"deletion_request\".\"confirmed_by_id\" LEFT JOIN \"users\" AS \"cancelled_by\" ON \"cancelled_by\".\"id\" = \"deletion_request\".\"cancelled_by_id\" LEFT JOIN \"work_items\" AS \"work_item\" ON \"work_item\".\"id\" = \"deletion_request\".\"work_item_id\" WHERE ((\"deletion_request\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_requests_generic_files\".*, \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" JOIN \"deletion_requests_generic_files\" AS \"deletion_requests_generic_files\" ON (\"deletion_requests_generic_files\".\"deletion_request_id\") IN (2) WHERE (\"generic_file\".\"id\" = \"deletion_requests_generic_files\".\"generic_file_id\")"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_requests_intellectual_objects\".*, \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" FROM \"intellectual_objects\" AS \"intellectual_object\" JOIN \"deletion_requests_intellectual_objects\" AS \"deletion_requests_intellectual_objects\" ON (\"deletion_requests_intellectual_objects\".\"deletion_request_id\") IN (2) WHERE (\"intellectual_object\".\"id\" = \"deletion_requests_intellectual_objects\".\"intellectual_object_id\")"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_request\".\"id\", \"deletion_request\".\"institution_id\", \"deletion_request\".\"requested_by_id\", \"deletion_request\".\"requested_at\", \"deletion_request\".\"encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\", \"deletion_request\".\"confirmed_at\", \"deletion_request\".\"cancelled_by_id\", \"deletion_request\".\"cancelled_at\", \"deletion_request\".\"work_item_id\", \"requested_by\".\"id\" AS \"requested_by__id\", \"requested_by\".\"created_at\" AS \"requested_by__created_at\", \"requested_by\".\"updated_at\" AS \"requested_by__updated_at\", \"requested_by\".\"name\" AS \"requested_by__name\", \"requested_by\".\"email\" AS \"requested_by__email\", \"requested_by\".\"phone_number\" AS \"requested_by__phone_number\", \"requested_by\".\"encrypted_password\" AS \"requested_by__encrypted_password\", \"requested_by\".\"reset_password_token\" AS \"requested_by__reset_password_token\", \"requested_by\".\"reset_password_sent_at\" AS \"requested_by__reset_password_sent_at\", \"requested_by\".\"remember_created_at\" AS \"requested_by__remember_created_at\", \"requested_by\".\"sign_in_count\" AS \"requested_by__sign_in_count\", \"requested_by\".\"current_sign_in_at\" AS \"requested_by__current_sign_in_at\", \"requested_by\".\"last_sign_in_at\" AS \"requested_by__last_sign_in_at\", \"requested_by\".\"current_sign_in_ip\" AS \"requested_by__current_sign_in_ip\", \"requested_by\".\"last_sign_in_ip\" AS \"requested_by__last_sign_in_ip\", \"requested_by\".\"institution_id\" AS \"requested_by__institution_id\", \"requested_by\".\"encrypted_api_secret_key\" AS \"requested_by__encrypted_api_secret_key\", \"requested_by\".\"password_changed_at\" AS \"requested_by__password_changed_at\", \"requested_by\".\"encrypted_otp_secret\" AS \"requested_by__encrypted_otp_secret\", \"requested_by\".\"encrypted_otp_secret_iv\" AS \"requested_by__encrypted_otp_secret_iv\", \"requested_by\".\"encrypted_otp_secret_salt\" AS \"requested_by__encrypted_otp_secret_salt\", \"requested_by\".\"encrypted_otp_sent_at\" AS \"requested_by__encrypted_otp_sent_at\", \"requested_by\".\"consumed_timestep\" AS \"requested_by__consumed_timestep\", \"requested_by\".\"otp_required_for_login\" AS \"requested_by__otp_required_for_login\", \"requested_by\".\"deactivated_at\" AS \"requested_by__deactivated_at\", \"requested_by\".\"enabled_two_factor\" AS \"requested_by__enabled_two_factor\", \"requested_by\".\"confirmed_two_factor\" AS \"requested_by__confirmed_two_factor\", \"requested_by\".\"otp_backup_codes\" AS \"requested_by__otp_backup_codes\", \"requested_by\".\"authy_id\" AS \"requested_by__authy_id\", \"requested_by\".\"last_sign_in_with_authy\" AS \"requested_by__last_sign_in_with_authy\", \"requested_by\".\"authy_status\" AS \"requested_by__authy_status\", \"requested_by\".\"email_verified\" AS \"requested_by__email_verified\", \"requested_by\".\"initial_password_updated\" AS \"requested_by__initial_password_updated\", \"requested_by\".\"force_password_update\" AS \"requested_by__force_password_update\", \"requested_by\".\"grace_period\" AS \"requested_by__grace_period\", \"requested_by\".\"awaiting_second_factor\" AS \"requested_by__awaiting_second_factor\", \"requested_by\".\"role\" AS \"requested_by__role\", \"confirmed_by\".\"id\" AS \"confirmed_by__id\", \"confirmed_by\".\"created_at\" AS \"confirmed_by__created_at\", \"confirmed_by\".\"updated_at\" AS \"confirmed_by__updated_at\", \"confirmed_by\".\"name\" AS \"confirmed_by__name\", \"confirmed_by\".\"email\" AS \"confirmed_by__email\", \"confirmed_by\".\"phone_number\" AS \"confirmed_by__phone_number\", \"confirmed_by\".\"encrypted_password\" AS \"confirmed_by__encrypted_password\", \"confirmed_by\".\"reset_password_token\" AS \"confirmed_by__reset_password_token\", \"confirmed_by\".\"reset_password_sent_at\" AS \"confirmed_by__reset_password_sent_at\", \"confirmed_by\".\"remember_created_at\" AS \"confirmed_by__remember_created_at\", \"confirmed_by\".\"sign_in_count\" AS \"confirmed_by__sign_in_count\", \"confirmed_by\".\"current_sign_in_at\" AS \"confirmed_by__current_sign_in_at\", \"confirmed_by\".\"last_sign_in_at\" AS \"confirmed_by__last_sign_in_at\", \"confirmed_by\".\"current_sign_in_ip\" AS \"confirmed_by__current_sign_in_ip\", \"confirmed_by\".\"last_sign_in_ip\" AS \"confirmed_by__last_sign_in_ip\", \"confirmed_by\".\"institution_id\" AS \"confirmed_by__institution_id\", \"confirmed_by\".\"encrypted_api_secret_key\" AS \"confirmed_by__encrypted_api_secret_key\", \"confirmed_by\".\"password_changed_at\" AS \"confirmed_by__password_changed_at\", \"confirmed_by\".\"encrypted_otp_secret\" AS \"confirmed_by__encrypted_otp_secret\", \"confirmed_by\".\"encrypted_otp_secret_iv\" AS \"confirmed_by__encrypted_otp_secret_iv\", \"confirmed_by\".\"encrypted_otp_secret_salt\" AS \"confirmed_by__encrypted_otp_secret_salt\", \"confirmed_by\".\"encrypted_otp_sent_at\" AS \"confirmed_by__encrypted_otp_sent_at\", \"confirmed_by\".\"consumed_timestep\" AS \"confirmed_by__consumed_timestep\", \"confirmed_by\".\"otp_required_for_login\" AS \"confirmed_by__otp_required_for_login\", \"confirmed_by\".\"deactivated_at\" AS \"confirmed_by__deactivated_at\", \"confirmed_by\".\"enabled_two_factor\" AS \"confirmed_by__enabled_two_factor\", \"confirmed_by\".\"confirmed_two_factor\" AS \"confirmed_by__confirmed_two_factor\", \"confirmed_by\".\"otp_backup_codes\" AS \"confirmed_by__otp_backup_codes\", \"confirmed_by\".\"authy_id\" AS \"confirmed_by__authy_id\", \"confirmed_by\".\"last_sign_in_with_authy\" AS \"confirmed_by__last_sign_in_with_authy\", \"confirmed_by\".\"authy_status\" AS \"confirmed_by__authy_status\", \"confirmed_by\".\"email_verified\" AS \"confirmed_by__email_verified\", \"confirmed_by\".\"initial_password_updated\" AS \"confirmed_by__initial_password_updated\", \"confirmed_by\".\"force_password_update\" AS \"confirmed_by__force_password_update\", \"confirmed_by\".\"grace_period\" AS \"confirmed_by__grace_period\", \"confirmed_by\".\"awaiting_second_factor\" AS \"confirmed_by__awaiting_second_factor\", \"confirmed_by\".\"role\" AS \"confirmed_by__role\", \"cancelled_by\".\"id\" AS \"cancelled_by__id\", \"cancelled_by\".\"created_at\" AS \"cancelled_by__created_at\", \"cancelled_by\".\"updated_at\" AS \"cancelled_by__updated_at\", \"cancelled_by\".\"name\" AS \"cancelled_by__name\", \"cancelled_by\".\"email\" AS \"cancelled_by__email\", \"cancelled_by\".\"phone_number\" AS \"cancelled_by__phone_number\", \"cancelled_by\".\"encrypted_password\" AS \"cancelled_by__encrypted_password\", \"cancelled_by\".\"reset_password_token\" AS \"cancelled_by__reset_password_token\", \"cancelled_by\".\"reset_password_sent_at\" AS \"cancelled_by__reset_password_sent_at\", \"cancelled_by\".\"remember_created_at\" AS \"cancelled_by__remember_created_at\", \"cancelled_by\".\"sign_in_count\" AS \"cancelled_by__sign_in_count\", \"cancelled_by\".\"current_sign_in_at\" AS \"cancelled_by__current_sign_in_at\", \"cancelled_by\".\"last_sign_in_at\" AS \"cancelled_by__last_sign_in_at\", \"cancelled_by\".\"current_sign_in_ip\" AS \"cancelled_by__current_sign_in_ip\", \"cancelled_by\".\"last_sign_in_ip\" AS \"cancelled_by__last_sign_in_ip\", \"cancelled_by\".\"institution_id\" AS \"cancelled_by__institution_id\", \"cancelled_by\".\"encrypted_api_secret_key\" AS \"cancelled_by__encrypted_api_secret_key\", \"cancelled_by\".\"password_changed_at\" AS \"cancelled_by__password_changed_at\", \"cancelled_by\".\"encrypted_otp_secret\" AS \"cancelled_by__encrypted_otp_secret\", \"cancelled_by\".\"encrypted_otp_secret_iv\" AS \"cancelled_by__encrypted_otp_secret_iv\", \"cancelled_by\".\"encrypted_otp_secret_salt\" AS \"cancelled_by__encrypted_otp_secret_salt\", \"cancelled_by\".\"encrypted_otp_sent_at\" AS \"cancelled_by__encrypted_otp_sent_at\", \"cancelled_by\".\"consumed_timestep\" AS \"cancelled_by__consumed_timestep\", \"cancelled_by\".\"otp_required_for_login\" AS \"cancelled_by__otp_required_for_login\", \"cancelled_by\".\"deactivated_at\" AS \"cancelled_by__deactivated_at\", \"cancelled_by\".\"enabled_two_factor\" AS \"cancelled_by__enabled_two_factor\", \"cancelled_by\".\"confirmed_two_factor\" AS \"cancelled_by__confirmed_two_factor\", \"cancelled_by\".\"otp_backup_codes\" AS \"cancelled_by__otp_backup_codes\", \"cancelled_by\".\"authy_id\" AS \"cancelled_by__authy_id\", \"cancelled_by\".\"last_sign_in_with_authy\" AS \"cancelled_by__last_sign_in_with_authy\", \"cancelled_by\".\"authy_status\" AS \"cancelled_by__authy_status\", \"cancelled_by\".\"email_verified\" AS \"cancelled_by__email_verified\", \"cancelled_by\".\"initial_password_updated\" AS \"cancelled_by__initial_password_updated\", \"cancelled_by\".\"force_password_update\" AS \"cancelled_by__force_password_update\", \"cancelled_by\".\"grace_period\" AS \"cancelled_by__grace_period\", \"cancelled_by\".\"awaiting_second_factor\" AS \"cancelled_by__awaiting_second_factor\", \"cancelled_by\".\"role\" AS \"cancelled_by__role\", \"work_item\".\"id\" AS \"work_item__id\", \"work_item\".\"created_at\" AS \"work_item__created_at\", \"work_item\".\"updated_at\" AS \"work_item__updated_at\", \"work_item\".\"name\" AS \"work_item__name\", \"work_item\".\"etag\" AS \"work_item__etag\", \"work_item\".\"institution_id\" AS \"work_item__institution_id\", \"work_item\".\"intellectual_object_id\" AS \"work_item__intellectual_object_id\", \"work_item\".\"generic_file_id\" AS \"work_item__generic_file_id\", \"work_item\".\"bucket\" AS \"work_item__bucket\", \"work_item\".\"user\" AS \"work_item__user\", \"work_item\".\"note\" AS \"work_item__note\", \"work_item\".\"action\" AS \"work_item__action\", \"work_item\".\"stage\" AS \"work_item__stage\", \"work_item\".\"status\" AS \"work_item__status\", \"work_item\".\"outcome\" AS \"work_item__outcome\", \"work_item\".\"bag_date\" AS \"work_item__bag_date\", \"work_item\".\"date_processed\" AS \"work_item__date_processed\", \"work_item\".\"retry\" AS \"work_item__retry\", \"work_item\".\"node\" AS \"work_item__node\", \"work_item\".\"pid\" AS \"work_item__pid\", \"work_item\".\"needs_admin_review\" AS \"work_item__needs_admin_review\", \"work_item\".\"queued_at\" AS \"work_item__queued_at\", \"work_item\".\"size\" AS \"work_item__size\", \"work_item\".\"stage_started_at\" AS \"work_item__stage_started_at\", \"work_item\".\"aptrust_approver\" AS \"work_item__aptrust_approver\", \"work_item\".\"inst_approver\" AS \"work_item__inst_approver\" FROM \"deletion_requests\" AS \"deletion_request\" LEFT JOIN \"users\" AS \"requested_by\" ON \"requested_by\".\"id\" = \"deletion_request\".\"requested_by_id\" LEFT JOIN \"users\" AS \"confirmed_by\" ON \"confirmed_by\".\"id\" = \"deletion_request\".\"confirmed_by_id\" LEFT JOIN \"users\" AS \"cancelled_by\" ON \"cancelled_by\".\"id\" = \"deletion_request\".\"cancelled_by_id\" LEFT JOIN \"work_items\" AS \"work_item\" ON \"work_item\".\"id\" = \"deletion_request\".\"work_item_id\" WHERE ((\"deletion_request\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_requests_generic_files\".*, \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" JOIN \"deletion_requests_generic_files\" AS \"deletion_requests_generic_files\" ON (\"deletion_requests_generic_files\".\"deletion_request_id\") IN (3) WHERE (\"generic_file\".\"id\" = \"deletion_requests_generic_files\".\"generic_file_id\")"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_requests_intellectual_objects\".*, \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" FROM \"intellectual_objects\" AS \"intellectual_object\" JOIN \"deletion_requests_intellectual_objects\" AS \"deletion_requests_intellectual_objects\" ON (\"deletion_requests_intellectual_objects\".\"deletion_request_id\") IN (3) WHERE (\"intellectual_object\".\"id\" = \"deletion_requests_intellectual_objects\".\"intellectual_object_id\")"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_request\".\"id\", \"deletion_request\".\"institution_id\", \"deletion_request\".\"requested_by_id\", \"deletion_request\".\"requested_at\", \"deletion_request\".\"encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\", \"deletion_request\".\"confirmed_at\", \"deletion_request\".\"cancelled_by_id\", \"deletion_request\".\"cancelled_at\", \"deletion_request\".\"work_item_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE ((confirmed_at is null)) ORDER BY \"id\" asc LIMIT 2"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 559988))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 331149))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 808080))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:19-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((institution_id = 2))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: \n    select\n        sum(\"size\") as \"total_bytes\",\n        (sum(\"size\") / 1073741824) as \"total_gb\",\n        (sum(\"size\") / 1099511627776) as \"total_tb\",\n        count(*) as file_count,\n        coalesce(file_format, 'Total') as \"file_format\"\n        from generic_files\n        where (3 = 0 or institution_id = 3)\n        and   (6 = 0 or intellectual_object_id = 6)\n        and   (state = 'A')\n        group by rollup(file_format)\n        order by file_format\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: \n    select\n        sum(\"size\") as \"total_bytes\",\n        (sum(\"size\") / 1073741824) as \"total_gb\",\n        (sum(\"size\") / 1099511627776) as \"total_tb\",\n        count(*) as file_count,\n        coalesce(file_format, 'Total') as \"file_format\"\n        from generic_files\n        where (0 = 0 or institution_id = 0)\n        and   (6 = 0 or intellectual_object_id = 6)\n        and   (state = 'A')\n        group by rollup(file_format)\n        order by file_format\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: \n    select\n        sum(\"size\") as \"total_bytes\",\n        (sum(\"size\") / 1073741824) as \"total_gb\",\n        (sum(\"size\") / 1099511627776) as \"total_tb\",\n        count(*) as file_count,\n        coalesce(file_format, 'Total') as \"file_format\"\n        from generic_files\n        where (3 = 0 or institution_id = 3)\n        and   (0 = 0 or intellectual_object_id = 0)\n        and   (state = 'A')\n        group by rollup(file_format)\n        order by file_format\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (3 = 0 or i.id = 3)\n\t\t  and ('Standard' = '' or gf.storage_option = 'Standard')\n\t\t  and ('2010-01-01 00:00:00+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2010-01-01 00:00:00+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (3 = 0 or i.id = 3)\n\t\t  and ('Standard' = '' or gf.storage_option = 'Standard')\n\t\t  and ('2030-01-01 00:00:00+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2030-01-01 00:00:00+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (3 = 0 or i.id = 3)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2030-01-01 00:00:00+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2030-01-01 00:00:00+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (0 = 0 or i.id = 0)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2030-01-01 00:00:00+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2030-01-01 00:00:00+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"id\" FROM \"generic_files\" AS \"generic_file\" WHERE ((\"generic_file\".\"identifier\" = 'institution2.edu/toads/toad19'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"id\" FROM \"generic_files\" AS \"generic_file\" WHERE ((\"generic_file\".\"identifier\" = 'institution1.edu/gl-or/file1.epub'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"id\" FROM \"generic_files\" AS \"generic_file\" WHERE ((\"generic_file\".\"identifier\" = 'bad identifier'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 1) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (1)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = -999) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE ((\"generic_file\".\"identifier\" = 'institution2.edu/toads/toad16'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE ((\"generic_file\".\"identifier\" = '-- does not exist --'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: select update_counts();"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"intellectual_objects\" (\"id\", \"created_at\", \"updated_at\", \"title\", \"description\", \"identifier\", \"alt_identifier\", \"access\", \"bag_name\", \"institution_id\", \"state\", \"etag\", \"bag_group_identifier\", \"storage_option\", \"bagit_profile_identifier\", \"source_organization\", \"internal_sender_identifier\", \"internal_sender_description\") VALUES (DEFAULT, '2022-06-22 17:30:20.724943+00:00:00', '2022-06-22 17:30:20.724943+00:00:00', 'neural extranet paradigms', 'The JBOD panel is down, input the digital panel so we can calculate the HDD bus!', 'test.edu/Shoulderprevent', 'Llama', 'institution', 'cross-platform.tar', 4, 'A', 'e1da50c294904187bf4d2b41227c7c67', 'chest', 'Standard', 'https://example.com/profile.json', 'Test University', 'Nacho', 'Paleo tacos put a bird on it hella vegan readymade bitters keytar beard schlitz migas ramps.') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:20.726434+00:00:00', '2022-06-22 17:30:20.726669+00:00:00', 'amphibians', 8034573309387541591, 'test.edu/Shoulderprevent/data/buswear29.ics', 15, 'A', '2022-02-22 17:30:20.726434+00:00:00', 4, 'Standard', '914f0bc7-d5b9-4027-924a-ae770b7972c5') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.728304+00:00:00', '2022-06-22 17:30:20.728415+00:00:00', 'Chicken', '2022-06-22 17:30:20.728304+00:00:00', 'Application sort period strengthen.', 'ingestion', 63, '5cadeff1-b9ac-4837-bf7f-b8d592cf3347', 4, 15, 'Gold method focus doubt.', DEFAULT, 'Character offer application happen get.', 'Samuel Smith’s Imperial IPA', 'Wilhelm Ortiz') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.728399+00:00:00', '2022-06-22 17:30:20.730575+00:00:00', 'Sheep', '2022-06-22 17:30:20.728399+00:00:00', 'Valley submit recession approach.', 'identifier assignment', 63, 'faaf23e5-0a96-445a-b4cf-00bb9efaab50', 4, 15, 'Traffic provide give farm.', DEFAULT, 'Happen lead manage mother respond.', 'Founders Breakfast Stout', 'Knowledge Agency') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.732065+00:00:00', '2022-06-22 17:30:20.73208+00:00:00', 'md5', '2022-06-22 17:30:20.732065+00:00:00', '1058bb6fca274dd7bf0cf466a1fa6539', 63) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.732077+00:00:00', '2022-06-22 17:30:20.734286+00:00:00', 'sha256', '2022-06-22 17:30:20.732077+00:00:00', '0b4e4c93ddcb4d1d9b124bc948720131', 63) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'http://www.internationalinfrastructures.name/syndicate/value-added/bandwidth') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'https://www.internationalpartnerships.name/iterate') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:20.740294+00:00:00', '2022-06-22 17:30:20.74055+00:00:00', 'invertebrates', 5178680183102762208, 'test.edu/Shoulderprevent/data/offenceexplain631.wpd', 15, 'A', '2022-02-22 17:30:20.740294+00:00:00', 4, 'Standard', '7fcbe7f8-6032-4c8d-b9f5-53931d1c6fb2') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.741916+00:00:00', '2022-06-22 17:30:20.741972+00:00:00', 'Sheep', '2022-06-22 17:30:20.741916+00:00:00', 'Withdraw comparison discover manage.', 'ingestion', 64, '87b1a89a-9d96-44c0-a39d-f99bc91dfa7b', 4, 15, 'Charge light suit understand.', DEFAULT, 'Move restore term upset employ.', 'Chocolate St', 'Clara Kertzmann') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.741947+00:00:00', '2022-06-22 17:30:20.744082+00:00:00', 'Cow', '2022-06-22 17:30:20.741947+00:00:00', 'Pull wait dog advance.', 'identifier assignment', 64, '5e09c321-5efe-40c0-8cd9-c58eaca4fe55', 4, 15, 'Efficiency survey metal complete.', DEFAULT, 'Emphasis qualify king transfer pray.', 'Trappistes Rochefort 8', 'The Schork Report') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.746159+00:00:00', '2022-06-22 17:30:20.746176+00:00:00', 'md5', '2022-06-22 17:30:20.746159+00:00:00', '7703a04e2e814b66ad3608979de66c55', 64) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.746173+00:00:00', '2022-06-22 17:30:20.747716+00:00:00', 'sha256', '2022-06-22 17:30:20.746173+00:00:00', 'fb2e367a83bd4c71881b82639c040dbb', 64) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'http://www.investorinnovate.com/methodologies/infomediaries/grow/supply-chains') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'https://www.principaldeliverables.net/mission-critical/enhance') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:20.752538+00:00:00', '2022-06-22 17:30:20.752815+00:00:00', 'mammals', 2030712247461512174, 'test.edu/Shoulderprevent/data/drivegenerate383.flv', 15, 'A', '2022-02-22 17:30:20.752538+00:00:00', 4, 'Standard', '344fed14-5b21-42bb-8c21-4d074a2fc588') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.754067+00:00:00', '2022-06-22 17:30:20.754107+00:00:00', 'Llama', '2022-06-22 17:30:20.754067+00:00:00', 'Close band remove offer.', 'ingestion', 65, '558a554f-9b17-435f-a75d-9ed49300270e', 4, 15, 'Brown combination trial press.', DEFAULT, 'Contribution research response graham stop.', 'Bourbon County Stout', 'Zackery Sanford') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.754094+00:00:00', '2022-06-22 17:30:20.755857+00:00:00', 'Horse', '2022-06-22 17:30:20.754094+00:00:00', 'Efficiency glass land be.', 'identifier assignment', 65, '6c7d1545-92c5-4a6d-b935-c917bd970f09', 4, 15, 'Competition control marriage question.', DEFAULT, 'Improve pattern type plate examine.', 'Ten FIDY', 'Jaclyn Ondricka') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.757403+00:00:00', '2022-06-22 17:30:20.757422+00:00:00', 'md5', '2022-06-22 17:30:20.757403+00:00:00', '2a4d46cc2a22457f8762a83afbcc2b20', 65) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.757418+00:00:00', '2022-06-22 17:30:20.759225+00:00:00', 'sha256', '2022-06-22 17:30:20.757418+00:00:00', '3bb2cc8d999945c593ef96b901130ee2', 65) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'http://www.dynamicsyndicate.biz/optimize/robust') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'http://www.globalrobust.org/deliverables/markets') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:20.764344+00:00:00', '2022-06-22 17:30:20.764572+00:00:00', 'fish', 114988035190499725, 'test.edu/Shoulderprevent/data/machineresult758.indd', 15, 'A', '2022-02-22 17:30:20.764344+00:00:00', 4, 'Standard', '9cc8b56a-3837-4036-b36d-8ae4bf392f92') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.765555+00:00:00', '2022-06-22 17:30:20.765593+00:00:00', 'Goose', '2022-06-22 17:30:20.765555+00:00:00', 'Kill gun present challenge.', 'ingestion', 66, '151be3d0-120f-4c46-a530-3cc0e6db1bf4', 4, 15, 'Gap revolution tradition suit.', DEFAULT, 'Damage grant believe capital job.', 'Westmalle Trappist Tripel', 'Capital Cube') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.765585+00:00:00', '2022-06-22 17:30:20.766748+00:00:00', 'Turkey', '2022-06-22 17:30:20.765585+00:00:00', 'Currency truth cancer represent.', 'identifier assignment', 66, 'b4d7e842-359a-4cf9-a934-373114509e3b', 4, 15, 'Section county seem telephone.', DEFAULT, 'Stone employ officer cook miss.', 'Hercules Double IPA', 'Randi Langworth') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.767946+00:00:00', '2022-06-22 17:30:20.767968+00:00:00', 'md5', '2022-06-22 17:30:20.767946+00:00:00', '80b8773ef8024bf192fee32ae2e3c7f2', 66) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.767966+00:00:00', '2022-06-22 17:30:20.76908+00:00:00', 'sha256', '2022-06-22 17:30:20.767966+00:00:00', '6b69b7a7fb114e8dbead51f6cb0cc264', 66) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'http://www.leaditerate.name/revolutionize') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'https://www.humanseamless.org/best-of-breed') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:20.772403+00:00:00', '2022-06-22 17:30:20.772673+00:00:00', 'invertebrates', 7869991353255454468, 'test.edu/Shoulderprevent/data/musicparticipate719.asp', 15, 'A', '2022-02-22 17:30:20.772403+00:00:00', 4, 'Standard', 'b6eafde2-80e1-4c94-aa96-d1e9afce32f0') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.773606+00:00:00', '2022-06-22 17:30:20.773643+00:00:00', 'Chicken', '2022-06-22 17:30:20.773606+00:00:00', 'Floor fact predict cover.', 'ingestion', 67, '5c21bdfc-a090-46f5-845c-1796c5b22021', 4, 15, 'Bed lady of experience.', DEFAULT, 'Hurt compare involvement obtain play.', 'Péché Mortel', 'Jaylon Ferry') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.773636+00:00:00', '2022-06-22 17:30:20.774671+00:00:00', 'Sheep', '2022-06-22 17:30:20.773636+00:00:00', 'Effect act come live.', 'identifier assignment', 67, '9da8ccb8-8a0d-4315-82f1-2793cfa0d9c1', 4, 15, 'Shoot sale look technology.', DEFAULT, 'Fail enjoy draw experience participate.', 'La Fin Du Monde', 'Oversight Systems') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.775973+00:00:00', '2022-06-22 17:30:20.775986+00:00:00', 'md5', '2022-06-22 17:30:20.775973+00:00:00', 'f5ae403db0f340c88593cf79b38935f0', 67) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:20.775984+00:00:00', '2022-06-22 17:30:20.777095+00:00:00', 'sha256', '2022-06-22 17:30:20.775984+00:00:00', '4f5520fdcf2b4858ab67fb43cddda1cc', 67) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'http://www.leadroi.io/productize/visualize') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'https://www.internaloptimize.io/utilize/out-of-the-box/enhance') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.78222+00:00:00', '2022-06-22 17:30:20.782266+00:00:00', 'Horse', '2022-06-22 17:30:20.78222+00:00:00', 'Kitchen crown get bottom.', 'ingestion', DEFAULT, 'e01baba7-1576-4365-ba83-bdbeb066d4e9', 4, 15, 'Mirror bear afford act.', DEFAULT, 'Taylor return site look interview.', 'Ten FIDY', 'Amazon Web Services') RETURNING \"id\", \"generic_file_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.782255+00:00:00', '2022-06-22 17:30:20.783781+00:00:00', 'Horse', '2022-06-22 17:30:20.782255+00:00:00', 'Challenge shoulder reputation establish.', 'identifier assignment', DEFAULT, '311ce53a-97bd-4fe8-9f2c-f0db8ebe06a3', 4, 15, 'Affect lane limit start.', DEFAULT, 'Flat delivery core office face.', 'Bell’s Expedition', 'Adobe Digital Government') RETURNING \"id\", \"generic_file_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE ((intellectual_object_id = 15)) ORDER BY \"identifier\" asc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (63, 65, 66, 67, 64))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (63, 65, 66, 67, 64))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (63, 65, 66, 67, 64))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 1) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (1)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:20.791653+00:00:00', '2022-06-22 17:30:20.791961+00:00:00', 'birds', 6065306489966238531, 'inst1.edu/photos/unit-test.txt/data/distanceact321.ps', 1, 'A', '2022-02-22 17:30:20.791653+00:00:00', 4, 'Standard', 'da783b78-e5d2-46fb-884c-ee7514b1f4de') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE ((\"generic_file\".\"identifier\" = 'inst1.edu/photos/unit-test.txt/data/distanceact321.ps'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: UPDATE \"generic_files\" AS \"generic_file\" SET \"created_at\" = '2022-06-22 17:30:20.791653+00:00:00', \"updated_at\" = '2022-06-22 17:30:20.794012+00:00:00', \"file_format\" = 'this-has/been-changed', \"size\" = 6065306489966238531, \"identifier\" = 'inst1.edu/photos/unit-test.txt/data/distanceact321.ps', \"intellectual_object_id\" = 1, \"state\" = 'A', \"last_fixity_check\" = '2022-01-02 11:42:00+00:00:00', \"institution_id\" = 4, \"storage_option\" = 'Standard', \"uuid\" = 'da783b78-e5d2-46fb-884c-ee7514b1f4de' WHERE \"generic_file\".\"id\" = 68"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE ((\"generic_file\".\"identifier\" = 'inst1.edu/photos/unit-test.txt/data/distanceact321.ps'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT count(*) FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 1 and state = 'A')"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT count(*) FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 1 and state = 'D')"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: select count(distinct(gf.id)) from generic_files gf\n\t\tleft join checksums cs on cs.generic_file_id = gf.id\n\t\twhere gf.intellectual_object_id = 1 and state = 'A'\n\t\tand (gf.identifier like '%picture%' or cs.digest = 'picture')"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: select count(distinct(gf.id)) from generic_files gf\n\t\tleft join checksums cs on cs.generic_file_id = gf.id\n\t\twhere gf.intellectual_object_id = 1 and state = 'A'\n\t\tand (gf.identifier like '%doc%' or cs.digest = 'doc')"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: select count(distinct(gf.id)) from generic_files gf\n\t\tleft join checksums cs on cs.generic_file_id = gf.id\n\t\twhere gf.intellectual_object_id = 1 and state = 'A'\n\t\tand (gf.identifier like '%9876543210%' or cs.digest = '9876543210')"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 1 and state = 'A') LIMIT 20"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1, 2, 3, 68))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1, 2, 3, 68)) ORDER BY \"datetime\" desc, \"algorithm\" asc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 1 and state = 'D') LIMIT 20"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: select distinct(gf.id) from generic_files gf\n\t\tleft join checksums cs on cs.generic_file_id = gf.id\n\t\twhere gf.intellectual_object_id = 1 and state = 'A'\n\t\tand (gf.identifier like '%picture%' or cs.digest = 'picture')\n\t\torder by gf.id offset 0 limit 20"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE (id in (1,2,3))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1, 2, 3))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1, 2, 3)) ORDER BY \"datetime\" desc, \"algorithm\" asc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: select distinct(gf.id) from generic_files gf\n\t\tleft join checksums cs on cs.generic_file_id = gf.id\n\t\twhere gf.intellectual_object_id = 1 and state = 'A'\n\t\tand (gf.identifier like '%doc%' or cs.digest = 'doc')\n\t\torder by gf.id offset 0 limit 20"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: select distinct(gf.id) from generic_files gf\n\t\tleft join checksums cs on cs.generic_file_id = gf.id\n\t\twhere gf.intellectual_object_id = 1 and state = 'A'\n\t\tand (gf.identifier like '%9876543210%' or cs.digest = '9876543210')\n\t\torder by gf.id offset 0 limit 20"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE (id in (1))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1)) ORDER BY \"datetime\" desc, \"algorithm\" asc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 26) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (26)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (26)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (26))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:20.814731+00:00:00', '2022-06-22 17:30:20.814758+00:00:00', 'BaggerVance.tar', '278a31af78f44b369396ef75db1ab585', 4, 8, 26, 'blah.receiving.blah', 'someone@example.com', 'This item was created by the factory', 'Delete', 'Requested', 'Started', 'Outcome? WTF?', '2022-02-22 17:30:20.814731+00:00:00', '2022-06-22 17:30:20.814731+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, '2022-06-22 17:30:20.814731+00:00:00', 6636460955567234949, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"node\", \"pid\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2022-06-22 17:30:20.814731+00:00:00', \"updated_at\" = '2022-06-22 17:30:20.81858+00:00:00', \"name\" = 'BaggerVance.tar', \"etag\" = '278a31af78f44b369396ef75db1ab585', \"institution_id\" = 4, \"intellectual_object_id\" = 8, \"generic_file_id\" = 26, \"bucket\" = 'blah.receiving.blah', \"user\" = 'someone@example.com', \"note\" = 'This item was created by the factory', \"action\" = 'Delete', \"stage\" = 'Requested', \"status\" = 'Started', \"outcome\" = 'Outcome? WTF?', \"bag_date\" = '2022-02-22 17:30:20.814731+00:00:00', \"date_processed\" = '2022-06-22 17:30:20.814731+00:00:00', \"retry\" = TRUE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = '2022-06-22 17:30:20.814731+00:00:00', \"size\" = 6636460955567234949, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = 'some-guy@example.com' WHERE \"work_item\".\"id\" = 33"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 9))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"deletion_requests\" (\"id\", \"institution_id\", \"requested_by_id\", \"requested_at\", \"encrypted_confirmation_token\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\") VALUES (DEFAULT, 4, 9, '2022-06-22 16:30:20.833651+00:00:00', '$2a$10$ZGJ9MAAR2ihTw4y2RuI3Xe.Em2PkfqTgR9A/9DXkur8yU1eFJzHsO', DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: insert into deletion_requests_generic_files (deletion_request_id, generic_file_id) values (4, 26) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: UPDATE \"deletion_requests\" AS \"deletion_request\" SET \"institution_id\" = 4, \"requested_by_id\" = 9, \"requested_at\" = '2022-06-22 16:30:20.833651+00:00:00', \"encrypted_confirmation_token\" = '$2a$10$ZGJ9MAAR2ihTw4y2RuI3Xe.Em2PkfqTgR9A/9DXkur8yU1eFJzHsO', \"confirmed_by_id\" = NULL, \"confirmed_at\" = NULL, \"cancelled_by_id\" = NULL, \"cancelled_at\" = NULL, \"work_item_id\" = 33 WHERE \"deletion_request\".\"id\" = 4"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: insert into deletion_requests_generic_files (deletion_request_id, generic_file_id) values (4, 26) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request\".\"id\", \"deletion_request\".\"institution_id\", \"deletion_request\".\"requested_by_id\", \"deletion_request\".\"requested_at\", \"deletion_request\".\"encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\", \"deletion_request\".\"confirmed_at\", \"deletion_request\".\"cancelled_by_id\", \"deletion_request\".\"cancelled_at\", \"deletion_request\".\"work_item_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@test.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 9))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 8))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: UPDATE \"deletion_requests\" AS \"deletion_request\" SET \"institution_id\" = 4, \"requested_by_id\" = 9, \"requested_at\" = '2022-06-22 16:30:20.833651+00:00:00', \"encrypted_confirmation_token\" = '$2a$10$ZGJ9MAAR2ihTw4y2RuI3Xe.Em2PkfqTgR9A/9DXkur8yU1eFJzHsO', \"confirmed_by_id\" = 8, \"confirmed_at\" = NULL, \"cancelled_by_id\" = NULL, \"cancelled_at\" = NULL, \"work_item_id\" = 33 WHERE \"deletion_request\".\"id\" = 4"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 26 OR intellectual_object_id = 8) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: UPDATE \"generic_files\" AS \"generic_file\" SET \"created_at\" = '2020-08-26 15:26:41+00:00:00', \"updated_at\" = '2022-06-22 17:30:20.938275+00:00:00', \"file_format\" = 'application/json', \"size\" = 20471, \"identifier\" = 'test.edu/apt-test-restore/data/sample.json', \"intellectual_object_id\" = 8, \"state\" = 'D', \"last_fixity_check\" = '2020-08-26 15:26:33+00:00:00', \"institution_id\" = 4, \"storage_option\" = 'Standard', \"uuid\" = '1275dbcf-8bc9-4943-95d0-5ce27e8b4c08' WHERE \"generic_file\".\"id\" = 26"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:20.942654+00:00:00', '2022-06-22 17:30:20.942654+00:00:00', 'APTrust preservation services', '2022-06-22 17:30:20.942617+00:00:00', 'All copies of this file have been deleted from preservation storage', 'deletion', 26, 'b988760a-0bac-4284-ae69-1603f6f471a0', 4, 8, 'Minio S3 library', DEFAULT, 'Success', 'user@test.edu', 'File deleted at the request of user@test.edu. Institutional approver: admin@test.edu. This event confirms all preservation copies have been deleted.') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: DELETE FROM \"storage_records\" AS \"storage_record\" WHERE (id = 51)"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: DELETE FROM \"storage_records\" AS \"storage_record\" WHERE (id = 52)"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 26) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (26)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (26)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (26))"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 26) AND (event_type = 'deletion')) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:20-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: select update_counts();"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"intellectual_objects\" (\"id\", \"created_at\", \"updated_at\", \"title\", \"description\", \"identifier\", \"alt_identifier\", \"access\", \"bag_name\", \"institution_id\", \"state\", \"etag\", \"bag_group_identifier\", \"storage_option\", \"bagit_profile_identifier\", \"source_organization\", \"internal_sender_identifier\", \"internal_sender_description\") VALUES (DEFAULT, '2022-06-22 17:30:21.838387+00:00:00', '2022-06-22 17:30:21.838387+00:00:00', 'optical Pre-emptive integrated', 'If we quantify the hard drive, we can get to the PCI driver through the online RSS interface!', 'test.edu/Goosethink', 'Sheep', 'institution', 'virtual.tar', 4, 'A', 'a1f26b25bf764774be7276ed18ae95e5', 'thatcher', 'Standard', 'https://example.com/profile.json', 'Test University', 'Jimmy Chew', 'Intelligentsia hashtag tumblr actually keytar austin vinegar whatever blue bottle plaid keytar asymmetrical.') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841118+00:00:00', '2022-06-22 17:30:21.843023+00:00:00', 'birds', 4354019446006141466, 'test.edu/Goosethink/data/noisedrop815.dem', 15, 'A', '2022-02-22 17:30:21.841118+00:00:00', 4, 'Standard', 'edc3b08e-3f67-4153-95cb-0fce23583356') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841161+00:00:00', '2022-06-22 17:30:21.84429+00:00:00', 'sha1', '2022-06-22 17:30:21.841161+00:00:00', 'a4ec7256affe4b2f96e1393a6bd4f329', 63) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84119+00:00:00', '2022-06-22 17:30:21.846286+00:00:00', 'sha1', '2022-06-22 17:30:21.84119+00:00:00', '4c10b46bb8ca40748b16c61e467ec423', 63) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841247+00:00:00', '2022-06-22 17:30:21.847469+00:00:00', 'sha1', '2022-06-22 17:30:21.841247+00:00:00', '41f59377d5664fd9aacc94d1922f66e5', 63) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841269+00:00:00', '2022-06-22 17:30:21.848464+00:00:00', 'sha1', '2022-06-22 17:30:21.841269+00:00:00', '579d9d62abf249509e132e3e21266400', 63) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'http://www.globaltechnologies.net/envisioneer/scalable/user-centric/paradigms') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'http://www.centralmethodologies.biz/recontextualize/distributed') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'https://www.humanscale.info/redefine/convergence') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'https://www.regionalusers.io/markets/synergize') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841144+00:00:00', '2022-06-22 17:30:21.854426+00:00:00', 'Turkey', '2022-06-22 17:30:21.841144+00:00:00', 'Object name introduce sell.', 'ingestion', 63, '6190b9d3-36a0-412c-8c33-64fcc26733f8', 4, 15, 'Drink cry call faith.', DEFAULT, 'Success', 'Celebrator Doppelbock', 'Adolf Padberg') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841175+00:00:00', '2022-06-22 17:30:21.855497+00:00:00', 'Chicken', '2022-06-22 17:30:21.841175+00:00:00', 'Deserve describe ask drop.', 'ingestion', 63, '49726429-0a72-4248-80a7-00a49990e2dd', 4, 15, 'Responsibility sit standard brain.', DEFAULT, 'Success', 'Ten FIDY', 'Xzavier Considine') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841199+00:00:00', '2022-06-22 17:30:21.857064+00:00:00', 'Llama', '2022-06-22 17:30:21.841199+00:00:00', 'Resistance loss focus share.', 'ingestion', 63, 'd7026b5f-e86f-4171-9da8-8709b6c21f88', 4, 15, 'Abandon joe order reckon.', DEFAULT, 'Success', 'Racer 5 India Pale Ale, Bear Republic Bre', 'June Keebler') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841257+00:00:00', '2022-06-22 17:30:21.857917+00:00:00', 'Turkey', '2022-06-22 17:30:21.841257+00:00:00', 'End majority cook food.', 'ingestion', 63, '94c65b33-6ca4-404b-b573-83edd218268b', 4, 15, 'Introduce withdraw live state.', DEFAULT, 'Success', 'Celebrator Doppelbock', 'Maurice Larson') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841276+00:00:00', '2022-06-22 17:30:21.85881+00:00:00', 'reptiles', 3808564924205459265, 'test.edu/Goosethink/data/pleasurecomment576.drv', 15, 'A', '2022-02-22 17:30:21.841276+00:00:00', 4, 'Standard', '4fce182f-06fc-4f80-9d1b-9f5230686dad') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841294+00:00:00', '2022-06-22 17:30:21.859545+00:00:00', 'sha1', '2022-06-22 17:30:21.841294+00:00:00', '23bbbc46778c4d12b62d79f0fbf4c185', 64) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84131+00:00:00', '2022-06-22 17:30:21.860398+00:00:00', 'sha1', '2022-06-22 17:30:21.84131+00:00:00', '7a04c34c87cd4d59ae283f81a8e94f16', 64) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841328+00:00:00', '2022-06-22 17:30:21.861246+00:00:00', 'sha1', '2022-06-22 17:30:21.841328+00:00:00', 'ff347c022e3b42c0a45f6bbadbac84db', 64) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841349+00:00:00', '2022-06-22 17:30:21.862028+00:00:00', 'sha1', '2022-06-22 17:30:21.841349+00:00:00', '9f176c55ffa24ae489bae33ff6083e55', 64) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'http://www.leadout-of-the-box.io/brand') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'https://www.futureenable.net/unleash/seize/efficient') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'https://www.internationalenvisioneer.biz/24-7/engage/interfaces') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'https://www.dynamicscale.biz/out-of-the-box/bricks-and-clicks') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841283+00:00:00', '2022-06-22 17:30:21.867835+00:00:00', 'Horse', '2022-06-22 17:30:21.841283+00:00:00', 'Repeat influence deny emerge.', 'ingestion', 64, 'dc92e00b-0cbd-46cd-87f2-b47923408448', 4, 15, 'Fail end birth failure.', DEFAULT, 'Success', 'Racer 5 India Pale Ale, Bear Republic Bre', 'Kody Hand') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.8413+00:00:00', '2022-06-22 17:30:21.868433+00:00:00', 'Turkey', '2022-06-22 17:30:21.8413+00:00:00', 'Forget democracy produce disappear.', 'ingestion', 64, '088b612e-0c5b-493b-a140-845638ca5b61', 4, 15, 'Abandon bread lifespan strategy.', DEFAULT, 'Success', 'Weihenstephaner Hefeweissbier', 'Genability') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841318+00:00:00', '2022-06-22 17:30:21.868974+00:00:00', 'Pig', '2022-06-22 17:30:21.841318+00:00:00', 'Budget gate supply sample.', 'ingestion', 64, '8b25fe12-f584-44d8-b06b-d38dda1516df', 4, 15, 'Corporation search crown predict.', DEFAULT, 'Success', 'Westmalle Trappist Tripel', 'Creola Mertz') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841337+00:00:00', '2022-06-22 17:30:21.869496+00:00:00', 'Pig', '2022-06-22 17:30:21.841337+00:00:00', 'Wind title imply policy.', 'ingestion', 64, '38fa3cbd-ad1c-40cf-b7f1-07cf4c33df43', 4, 15, 'Point restore recall deal.', DEFAULT, 'Success', 'Ruination IPA', 'ASC Partners') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841356+00:00:00', '2022-06-22 17:30:21.870065+00:00:00', 'fish', 2911811989339045704, 'test.edu/Goosethink/data/disciplinedraw11.gif', 15, 'A', '2022-02-22 17:30:21.841356+00:00:00', 4, 'Standard', 'd2bbfcbf-e460-45ee-8f07-4b27add15e91') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841374+00:00:00', '2022-06-22 17:30:21.870539+00:00:00', 'sha1', '2022-06-22 17:30:21.841374+00:00:00', '0116ca08d4544469b22542bc824b67a0', 65) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841393+00:00:00', '2022-06-22 17:30:21.87103+00:00:00', 'sha1', '2022-06-22 17:30:21.841393+00:00:00', '5d90f49e1059463b92aecfaf615717db', 65) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841411+00:00:00', '2022-06-22 17:30:21.871531+00:00:00', 'sha1', '2022-06-22 17:30:21.841411+00:00:00', '085a19c9613b42118511cfcae7b937ff', 65) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841428+00:00:00', '2022-06-22 17:30:21.871983+00:00:00', 'sha1', '2022-06-22 17:30:21.841428+00:00:00', '9894f126a6964c3a84dba3bad8c9003e', 65) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'http://www.nationalrepurpose.io/recontextualize/back-end/one-to-one') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'http://www.productfrictionless.info/channels') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'http://www.futuretransform.name/exploit/innovate/turn-key/enable') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'http://www.productseize.biz/content/e-tailers/streamline') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841363+00:00:00', '2022-06-22 17:30:21.874402+00:00:00', 'Donkey', '2022-06-22 17:30:21.841363+00:00:00', 'Talk air behave compare.', 'ingestion', 65, '76445d06-6e9a-4206-9c46-daedd7994d50', 4, 15, 'Reject text spend island.', DEFAULT, 'Success', 'Shakespeare Oatmeal', 'Bing') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841382+00:00:00', '2022-06-22 17:30:21.875083+00:00:00', 'Sheep', '2022-06-22 17:30:21.841382+00:00:00', 'Order ensure restore resistance.', 'ingestion', 65, 'c614518c-e364-4f88-adcc-310f44e2281e', 4, 15, 'Gather decide differ fight.', DEFAULT, 'Success', 'Oak Aged Yeti Imperial Stout', 'Maymie Bartoletti') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.8414+00:00:00', '2022-06-22 17:30:21.875631+00:00:00', 'Donkey', '2022-06-22 17:30:21.8414+00:00:00', 'Land president suffer organise.', 'ingestion', 65, 'cde529df-eb38-4099-816a-1ecb605cb11e', 4, 15, 'Mountain station station image.', DEFAULT, 'Success', 'Schneider Aventinus', 'Vicente Keebler') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841418+00:00:00', '2022-06-22 17:30:21.876177+00:00:00', 'Donkey', '2022-06-22 17:30:21.841418+00:00:00', 'Intelligence china show cause.', 'ingestion', 65, '957b6adc-b005-4294-bd22-c94a3f48e2b0', 4, 15, 'Mill tone championship committee.', DEFAULT, 'Success', 'Maudite', 'Telenav') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841434+00:00:00', '2022-06-22 17:30:21.876865+00:00:00', 'amphibians', 5615050205469683175, 'test.edu/Goosethink/data/institutefeel773.dll', 15, 'A', '2022-02-22 17:30:21.841434+00:00:00', 4, 'Standard', 'd4ed1483-2e11-4439-b6a8-3fcd3a716153') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841449+00:00:00', '2022-06-22 17:30:21.877527+00:00:00', 'sha1', '2022-06-22 17:30:21.841449+00:00:00', 'fa5a028853ca4d3385e0f202fe2ddcfd', 66) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841466+00:00:00', '2022-06-22 17:30:21.87841+00:00:00', 'sha1', '2022-06-22 17:30:21.841466+00:00:00', '63d9694aceab47739d8f286b121aaab3', 66) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841487+00:00:00', '2022-06-22 17:30:21.879119+00:00:00', 'sha1', '2022-06-22 17:30:21.841487+00:00:00', '0f2449d47a9c40cb8c429071c1fe9d6b', 66) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841502+00:00:00', '2022-06-22 17:30:21.879637+00:00:00', 'sha1', '2022-06-22 17:30:21.841502+00:00:00', '03d1de3afb0946eea4a7585062d8ebca', 66) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'http://www.legacyarchitectures.io/schemas/streamline/incubate/facilitate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'https://www.futureproductize.name/harness/supply-chains/transparent/incubate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'https://www.futuremaximize.org/extend/methodologies') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'https://www.principalcommunities.io/visionary/vortals/metrics') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84144+00:00:00', '2022-06-22 17:30:21.882082+00:00:00', 'Duck', '2022-06-22 17:30:21.84144+00:00:00', 'Sight relax food fit.', 'ingestion', 66, 'aa167fca-4365-47f2-8f88-96b06802f3d4', 4, 15, 'Keep investment desk conclude.', DEFAULT, 'Success', 'La Fin Du Monde', 'CoreLogic') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841457+00:00:00', '2022-06-22 17:30:21.882658+00:00:00', 'Donkey', '2022-06-22 17:30:21.841457+00:00:00', 'Use context motor burst.', 'ingestion', 66, '057a85ce-44f6-45de-81c4-e216aebcfa59', 4, 15, 'Play result shake worry.', DEFAULT, 'Success', 'Bourbon County Stout', 'MapQuest') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841476+00:00:00', '2022-06-22 17:30:21.88319+00:00:00', 'Goose', '2022-06-22 17:30:21.841476+00:00:00', 'Work explore leave bother.', 'ingestion', 66, '91f02d04-384c-4c9a-a820-781a2ea01cc4', 4, 15, 'Guide contrast text abandon.', DEFAULT, 'Success', 'Celebrator Doppelbock', 'Factual') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841493+00:00:00', '2022-06-22 17:30:21.883695+00:00:00', 'Chicken', '2022-06-22 17:30:21.841493+00:00:00', 'District literature fail weather.', 'ingestion', 66, '0f69deb6-c0a0-43f0-b7a4-4b9249f1cb4d', 4, 15, 'Post meet touch party.', DEFAULT, 'Success', 'Brooklyn Black', 'Lonny Wyman') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841508+00:00:00', '2022-06-22 17:30:21.884208+00:00:00', 'birds', 7588243442289952841, 'test.edu/Goosethink/data/youthtest560.thm', 15, 'A', '2022-02-22 17:30:21.841508+00:00:00', 4, 'Standard', '70b4a45e-ea32-4954-8385-6d78f8a27822') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841524+00:00:00', '2022-06-22 17:30:21.884744+00:00:00', 'sha1', '2022-06-22 17:30:21.841524+00:00:00', '34bac2f8c20840f7abcd06efa3517790', 67) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84154+00:00:00', '2022-06-22 17:30:21.885225+00:00:00', 'sha1', '2022-06-22 17:30:21.84154+00:00:00', '8f25edd832b2491a9ae1b3607faf09b8', 67) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841555+00:00:00', '2022-06-22 17:30:21.885661+00:00:00', 'sha1', '2022-06-22 17:30:21.841555+00:00:00', '443d497215374e019ed8a35501be4b67', 67) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841579+00:00:00', '2022-06-22 17:30:21.886089+00:00:00', 'sha1', '2022-06-22 17:30:21.841579+00:00:00', '8975048b0e464cd1b31e3d8d00be5a22', 67) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'http://www.districtkiller.org/killer/maximize/integrate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'http://www.globalseize.biz/robust') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'https://www.futurebest-of-breed.biz/unleash/initiatives/distributed') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'https://www.corporateorchestrate.info/rich/real-time') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841514+00:00:00', '2022-06-22 17:30:21.889475+00:00:00', 'Duck', '2022-06-22 17:30:21.841514+00:00:00', 'Seek hole eye telephone.', 'ingestion', 67, 'ef251fd9-3e18-48ce-80bb-46eac97c3d21', 4, 15, 'Smith promise gas new.', DEFAULT, 'Success', 'Yeti Imperial Stout', 'Rigoberto Stehr') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84153+00:00:00', '2022-06-22 17:30:21.890242+00:00:00', 'Donkey', '2022-06-22 17:30:21.84153+00:00:00', 'Handle include sea face.', 'ingestion', 67, 'e714eddb-b016-4ff3-aa14-70080bada6d4', 4, 15, 'Note stick wonder require.', DEFAULT, 'Success', 'Weihenstephaner Hefeweissbier', 'Eleazar Dicki') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841545+00:00:00', '2022-06-22 17:30:21.891045+00:00:00', 'Cow', '2022-06-22 17:30:21.841545+00:00:00', 'Excuse world output match.', 'ingestion', 67, '19d6c4cd-8096-4327-b835-5f566f716537', 4, 15, 'Opposition sort own white.', DEFAULT, 'Success', 'Bourbon County Stout', 'CrowdANALYTIX') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841561+00:00:00', '2022-06-22 17:30:21.891963+00:00:00', 'Goose', '2022-06-22 17:30:21.841561+00:00:00', 'Sea regard hide base.', 'ingestion', 67, 'd3eacf11-9903-4be4-b797-eea9d92099f4', 4, 15, 'Murder secure abandon record.', DEFAULT, 'Success', 'Weihenstephaner Hefeweissbier', 'Dora Schuppe') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841586+00:00:00', '2022-06-22 17:30:21.893003+00:00:00', 'fish', 464304095770818358, 'test.edu/Goosethink/data/channelask659.icns', 15, 'A', '2022-02-22 17:30:21.841586+00:00:00', 4, 'Standard', '641ba1a6-2caa-4f61-a6e5-affff29b685c') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841601+00:00:00', '2022-06-22 17:30:21.893886+00:00:00', 'sha1', '2022-06-22 17:30:21.841601+00:00:00', 'b9fc73910b4042ccac6d7093d7d4273b', 68) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841619+00:00:00', '2022-06-22 17:30:21.894823+00:00:00', 'sha1', '2022-06-22 17:30:21.841619+00:00:00', 'b51715d97e0844a3b7f4560385cea637', 68) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841634+00:00:00', '2022-06-22 17:30:21.895591+00:00:00', 'sha1', '2022-06-22 17:30:21.841634+00:00:00', '85998ead0b634d0abeb4ac7bb540701c', 68) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84165+00:00:00', '2022-06-22 17:30:21.896538+00:00:00', 'sha1', '2022-06-22 17:30:21.84165+00:00:00', 'a708af10ec2c4ff7b4e9b5faf6f916ea', 68) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 68, 'https://www.internationalinitiatives.biz/transform/revolutionary') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 68, 'https://www.regionalvertical.biz/interactive/solutions') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 68, 'https://www.legacyturn-key.biz/robust/optimize') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 68, 'https://www.dynamicincubate.biz/e-business') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841592+00:00:00', '2022-06-22 17:30:21.900278+00:00:00', 'Chicken', '2022-06-22 17:30:21.841592+00:00:00', 'Appointment order observe liability.', 'ingestion', 68, '164cf929-bb6c-4242-8b3b-7d96eeaaa578', 4, 15, 'Length potential move parent.', DEFAULT, 'Success', 'Chocolate St', 'EMC') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841607+00:00:00', '2022-06-22 17:30:21.901187+00:00:00', 'Goose', '2022-06-22 17:30:21.841607+00:00:00', 'Sit account decide energy.', 'ingestion', 68, '21a7d2f7-23bc-4917-b461-d34473c4b5e4', 4, 15, 'Fight clear movement assessment.', DEFAULT, 'Success', 'Oaked Arrogant Bastard Ale', 'US Green Data') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841625+00:00:00', '2022-06-22 17:30:21.902036+00:00:00', 'Chicken', '2022-06-22 17:30:21.841625+00:00:00', 'Block prevent arise pressure.', 'ingestion', 68, '4d7e989b-b337-4ae6-9755-c210e4bd2234', 4, 15, 'Allow clear valley hope.', DEFAULT, 'Success', 'Shakespeare Oatmeal', 'Icie Berge') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841641+00:00:00', '2022-06-22 17:30:21.902735+00:00:00', 'Goat', '2022-06-22 17:30:21.841641+00:00:00', 'Break state succeed detect.', 'ingestion', 68, '317bf51d-270d-47e9-8488-20a3798ed79e', 4, 15, 'Defend include attend job.', DEFAULT, 'Success', 'Sierra Nevada Bigfoot Barleywine Style Ale', 'Morgan Stanley') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841655+00:00:00', '2022-06-22 17:30:21.903445+00:00:00', 'amphibians', 8619846379678315262, 'test.edu/Goosethink/data/approachcombine394.cbr', 15, 'A', '2022-02-22 17:30:21.841655+00:00:00', 4, 'Standard', 'dffca6a8-d645-4956-8bf1-bd03a91933f5') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841674+00:00:00', '2022-06-22 17:30:21.904188+00:00:00', 'sha1', '2022-06-22 17:30:21.841674+00:00:00', '387a00a4d1c34e45805a87a6533ef986', 69) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841689+00:00:00', '2022-06-22 17:30:21.904796+00:00:00', 'sha1', '2022-06-22 17:30:21.841689+00:00:00', '52d51aa952464f77a39e527c9e16a6ed', 69) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841707+00:00:00', '2022-06-22 17:30:21.905424+00:00:00', 'sha1', '2022-06-22 17:30:21.841707+00:00:00', '67f3665cd5f14d09a582893255d65d90', 69) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841724+00:00:00', '2022-06-22 17:30:21.906019+00:00:00', 'sha1', '2022-06-22 17:30:21.841724+00:00:00', 'eaca3e5992044abea2add1e3282285e3', 69) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 69, 'https://www.forwardubiquitous.io/plug-and-play/b2b/webservices') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 69, 'http://www.investormarkets.io/sexy') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 69, 'http://www.directsynergistic.info/open-source/bricks-and-clicks/empower') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 69, 'http://www.futuremission-critical.com/extensible') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841665+00:00:00', '2022-06-22 17:30:21.909217+00:00:00', 'Llama', '2022-06-22 17:30:21.841665+00:00:00', 'Arrange carry observe in.', 'ingestion', 69, '3c685dde-4282-4c68-8e4e-2d0536621858', 4, 15, 'Share pick reference port.', DEFAULT, 'Success', 'La Fin Du Monde', 'Winston Kub') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841681+00:00:00', '2022-06-22 17:30:21.910082+00:00:00', 'Sheep', '2022-06-22 17:30:21.841681+00:00:00', 'Drink refuse constitution practise.', 'ingestion', 69, '20cc07cc-2560-494c-a099-d0151fe614dc', 4, 15, 'Golf trial deliver god.', DEFAULT, 'Success', 'Shakespeare Oatmeal', 'Appallicious') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841696+00:00:00', '2022-06-22 17:30:21.910767+00:00:00', 'Pig', '2022-06-22 17:30:21.841696+00:00:00', 'Age growth remove depend.', 'ingestion', 69, 'c076d5b5-9704-4899-8fb8-be0a3e2c1787', 4, 15, 'Head dog participate carry.', DEFAULT, 'Success', 'Two Hearted Ale', 'Kenton Schamberger') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841714+00:00:00', '2022-06-22 17:30:21.911651+00:00:00', 'Goose', '2022-06-22 17:30:21.841714+00:00:00', 'Difference direction lane record.', 'ingestion', 69, '7d9eb327-bd9c-457d-b59b-c16e7db98c9e', 4, 15, 'Branch total weekend application.', DEFAULT, 'Success', 'Chocolate St', 'Janelle Prosacco') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841729+00:00:00', '2022-06-22 17:30:21.912603+00:00:00', 'birds', 1868367442497436475, 'test.edu/Goosethink/data/interviewmonitor177.yuv', 15, 'A', '2022-02-22 17:30:21.841729+00:00:00', 4, 'Standard', '5eb38d85-6ee5-41fd-aebe-bb42ded8585c') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841747+00:00:00', '2022-06-22 17:30:21.913352+00:00:00', 'sha1', '2022-06-22 17:30:21.841747+00:00:00', '9b5f1116f84e442b864e5cadb3bd358a', 70) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841761+00:00:00', '2022-06-22 17:30:21.913887+00:00:00', 'sha1', '2022-06-22 17:30:21.841761+00:00:00', '744186d3cc624d1591814cd6b13564a3', 70) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841777+00:00:00', '2022-06-22 17:30:21.914395+00:00:00', 'sha1', '2022-06-22 17:30:21.841777+00:00:00', '162f0fa34cc04d0e907649ca3f5ed92a', 70) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841791+00:00:00', '2022-06-22 17:30:21.914869+00:00:00', 'sha1', '2022-06-22 17:30:21.841791+00:00:00', 'f23f21d11ede497da6c8758be44b3fe1', 70) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 70, 'https://www.global24-365.org/transition/virtual') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 70, 'http://www.internalbrand.name/customized/innovate/incentivize/vortals') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 70, 'http://www.forwardfront-end.com/vertical') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 70, 'https://www.corporatedeploy.name/enable') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841736+00:00:00', '2022-06-22 17:30:21.917331+00:00:00', 'Horse', '2022-06-22 17:30:21.841736+00:00:00', 'Republic voice illustrate telephone.', 'ingestion', 70, 'af1da601-6782-4155-a6f3-b2dc1ad56890', 4, 15, 'Assembly version grow alter.', DEFAULT, 'Success', 'Dreadnaught IPA', 'Deloitte') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841753+00:00:00', '2022-06-22 17:30:21.917847+00:00:00', 'Donkey', '2022-06-22 17:30:21.841753+00:00:00', 'Accommodate relax gain commission.', 'ingestion', 70, 'cf53674e-b5e8-4619-8950-24fe46ee42d0', 4, 15, 'Manner sheet crime think.', DEFAULT, 'Success', 'HopSlam Ale', 'Think Computer Corporation') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841767+00:00:00', '2022-06-22 17:30:21.918464+00:00:00', 'Cow', '2022-06-22 17:30:21.841767+00:00:00', 'Station show release sound.', 'ingestion', 70, '8591ff11-8e1f-4203-a5da-7da4929d78c7', 4, 15, 'Secure divide establish hole.', DEFAULT, 'Success', 'Arrogant Bastard Ale', 'Reta Boyle') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841783+00:00:00', '2022-06-22 17:30:21.918967+00:00:00', 'Horse', '2022-06-22 17:30:21.841783+00:00:00', 'Seek resolve have major.', 'ingestion', 70, 'c5d94851-486d-4a35-9ef4-17cea61b1f64', 4, 15, 'Reach press provision watch.', DEFAULT, 'Success', 'Alpha King Pale Ale', 'Vital Axiom | Niinja') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841796+00:00:00', '2022-06-22 17:30:21.919533+00:00:00', 'birds', 4849978730362401251, 'test.edu/Goosethink/data/processfulfil464.ics', 15, 'A', '2022-02-22 17:30:21.841796+00:00:00', 4, 'Standard', 'fe1ee1a0-fb4a-4980-add3-8790f1a04829') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84181+00:00:00', '2022-06-22 17:30:21.920038+00:00:00', 'sha1', '2022-06-22 17:30:21.84181+00:00:00', 'e7cdfe037822450a9cd84d62dbc979db', 71) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841825+00:00:00', '2022-06-22 17:30:21.920504+00:00:00', 'sha1', '2022-06-22 17:30:21.841825+00:00:00', 'b7ae9aec95284694a0b1dd80b0c806fc', 71) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841843+00:00:00', '2022-06-22 17:30:21.920949+00:00:00', 'sha1', '2022-06-22 17:30:21.841843+00:00:00', 'ea701cc5694e474fa639652d68f1d7a5', 71) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84186+00:00:00', '2022-06-22 17:30:21.921901+00:00:00', 'sha1', '2022-06-22 17:30:21.84186+00:00:00', 'bda02cafabb04e85a97c273e0e41bb5e', 71) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 71, 'https://www.dynamic24-365.net/e-business/visualize') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 71, 'http://www.globalexpedite.org/cross-media/e-business/experiences') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 71, 'https://www.internationaltransition.org/integrate/visualize/global/expedite') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 71, 'https://www.humanempower.name/magnetic/architect/whiteboard') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841801+00:00:00', '2022-06-22 17:30:21.924544+00:00:00', 'Cow', '2022-06-22 17:30:21.841801+00:00:00', 'Conduct aim link recommend.', 'ingestion', 71, '78e40f1d-da9e-4742-abf6-086cc44ced42', 4, 15, 'Exclude influence post sheet.', DEFAULT, 'Success', 'Founders Breakfast Stout', 'Grant Satterfield') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841816+00:00:00', '2022-06-22 17:30:21.925228+00:00:00', 'Cow', '2022-06-22 17:30:21.841816+00:00:00', 'Help touch seem sell.', 'ingestion', 71, '682bb8d5-019e-47b3-ad5b-46b12e87248f', 4, 15, 'Forget scope apply reach.', DEFAULT, 'Success', 'Schneider Aventinus', 'Archimedes Inc.') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841833+00:00:00', '2022-06-22 17:30:21.925791+00:00:00', 'Llama', '2022-06-22 17:30:21.841833+00:00:00', 'Put box thank manage.', 'ingestion', 71, 'ce37d98d-58cf-4422-879d-88450e2c1842', 4, 15, 'Alter generate court decline.', DEFAULT, 'Success', 'Arrogant Bastard Ale', 'Clair Bins') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841851+00:00:00', '2022-06-22 17:30:21.926322+00:00:00', 'Goose', '2022-06-22 17:30:21.841851+00:00:00', 'Map aspect monitor position.', 'ingestion', 71, '2d2fcfcc-9bba-4339-a8a7-fd705a28c12b', 4, 15, 'Spend republic letter trip.', DEFAULT, 'Success', 'Stone IPA', 'Greyson Hills') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841868+00:00:00', '2022-06-22 17:30:21.92716+00:00:00', 'mammals', 3324998146201217959, 'test.edu/Goosethink/data/eastdescribe395.tar', 15, 'A', '2022-02-22 17:30:21.841868+00:00:00', 4, 'Standard', 'df28a723-1ad9-4bb7-86d9-0997b19c0d6f') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841882+00:00:00', '2022-06-22 17:30:21.927832+00:00:00', 'sha1', '2022-06-22 17:30:21.841882+00:00:00', '5404abbda2394e2081a4de9c233901be', 72) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841897+00:00:00', '2022-06-22 17:30:21.928435+00:00:00', 'sha1', '2022-06-22 17:30:21.841897+00:00:00', '3bd8a07f8e3747549bad37d759ce1546', 72) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841915+00:00:00', '2022-06-22 17:30:21.928937+00:00:00', 'sha1', '2022-06-22 17:30:21.841915+00:00:00', 'f804e9f265974c0e923dd39020a8dc81', 72) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841931+00:00:00', '2022-06-22 17:30:21.929447+00:00:00', 'sha1', '2022-06-22 17:30:21.841931+00:00:00', 'd340a8e1ba5a4797b99d03eb3f6aa95a', 72) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 72, 'https://www.futurebenchmark.info/deploy') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 72, 'http://www.investordrive.net/integrated/rich/infomediaries/sticky') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 72, 'https://www.chiefproactive.org/revolutionary/whiteboard/paradigms/generate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 72, 'https://www.internationalstrategize.biz/iterate/exploit') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841873+00:00:00', '2022-06-22 17:30:21.931993+00:00:00', 'Sheep', '2022-06-22 17:30:21.841873+00:00:00', 'Vary control station bread.', 'ingestion', 72, '18cc82d3-1f0e-48eb-942c-d28a7e9017ae', 4, 15, 'Text practice finance title.', DEFAULT, 'Success', 'Racer 5 India Pale Ale, Bear Republic Bre', 'Housefax') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841887+00:00:00', '2022-06-22 17:30:21.932838+00:00:00', 'Turkey', '2022-06-22 17:30:21.841887+00:00:00', 'Land turn stress hole.', 'ingestion', 72, '5a3e66c1-191d-4efb-9547-e0b58ae2c548', 4, 15, 'Christ accommodation assistance demand.', DEFAULT, 'Success', 'Yeti Imperial Stout', 'JJ Keller') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841905+00:00:00', '2022-06-22 17:30:21.933574+00:00:00', 'Duck', '2022-06-22 17:30:21.841905+00:00:00', 'Issue hole wait insist.', 'ingestion', 72, '2d8e25d3-e1b9-49fd-93f3-bb0908347414', 4, 15, 'Pound operation code cat.', DEFAULT, 'Success', 'Weihenstephaner Hefeweissbier', 'Izabella Hartmann') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841921+00:00:00', '2022-06-22 17:30:21.934285+00:00:00', 'Goat', '2022-06-22 17:30:21.841921+00:00:00', 'Touch listen check proposal.', 'ingestion', 72, 'd6210ec5-636a-4c7a-88f2-5f8907502881', 4, 15, 'Lead newspaper picture charge.', DEFAULT, 'Success', 'Sublimely Self-Righteous Ale', 'Maponics') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.841936+00:00:00', '2022-06-22 17:30:21.935044+00:00:00', 'invertebrates', 3753294915498883853, 'test.edu/Goosethink/data/materialspecify600.xcodeproj', 15, 'A', '2022-02-22 17:30:21.841936+00:00:00', 4, 'Standard', 'e73e5dfd-9e20-47a7-83f5-dd4c2cd2328c') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841952+00:00:00', '2022-06-22 17:30:21.935777+00:00:00', 'sha1', '2022-06-22 17:30:21.841952+00:00:00', 'bf62b7af650048a5bc4ac28c68cd2ff0', 73) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841975+00:00:00', '2022-06-22 17:30:21.936405+00:00:00', 'sha1', '2022-06-22 17:30:21.841975+00:00:00', '1bb78b4f4c5146388a8ea730b742ab84', 73) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.841991+00:00:00', '2022-06-22 17:30:21.936969+00:00:00', 'sha1', '2022-06-22 17:30:21.841991+00:00:00', 'b867671f94704a11a3e6931a780e3bc2', 73) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842012+00:00:00', '2022-06-22 17:30:21.93757+00:00:00', 'sha1', '2022-06-22 17:30:21.842012+00:00:00', '9b103ee3d9be4efbb234f9ce0be3502a', 73) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 73, 'https://www.chiefnetworks.org/solutions/e-enable') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 73, 'http://www.nationaldisintermediate.io/integrated/mindshare/relationships') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 73, 'http://www.direct24-365.org/embrace/extend') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 73, 'http://www.chiefincubate.name/disintermediate/expedite/eyeballs') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841942+00:00:00', '2022-06-22 17:30:21.940853+00:00:00', 'Pig', '2022-06-22 17:30:21.841942+00:00:00', 'Produce issue talk perform.', 'ingestion', 73, 'fb7e2916-1be5-4e20-9c25-16d2cf5040df', 4, 15, 'Stick milk weather curriculum.', DEFAULT, 'Success', 'Maudite', 'Araceli Champlin') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841966+00:00:00', '2022-06-22 17:30:21.941596+00:00:00', 'Duck', '2022-06-22 17:30:21.841966+00:00:00', 'Clear drink win abuse.', 'ingestion', 73, '7168d51e-1b3f-45d8-8c1e-5bad34a25d78', 4, 15, 'Mix gallery value body.', DEFAULT, 'Success', 'Pliny The Elder', 'Persint') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841982+00:00:00', '2022-06-22 17:30:21.942322+00:00:00', 'Horse', '2022-06-22 17:30:21.841982+00:00:00', 'Show theory sight launch.', 'ingestion', 73, 'd745ca02-2481-427b-b9a0-0f63ecd9ddc6', 4, 15, 'Cry water display owner.', DEFAULT, 'Success', 'Duvel', 'Amparo Adams') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.841999+00:00:00', '2022-06-22 17:30:21.943127+00:00:00', 'Duck', '2022-06-22 17:30:21.841999+00:00:00', 'Construct guarantee possess succeed.', 'ingestion', 73, '038a3453-53de-4ec7-aeff-df2efde589d9', 4, 15, 'Bed flight species deny.', DEFAULT, 'Success', 'Weihenstephaner Hefeweissbier', 'indoo.rs') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.842019+00:00:00', '2022-06-22 17:30:21.944635+00:00:00', 'birds', 4137393391575717466, 'test.edu/Goosethink/data/pasttest77.gadget', 15, 'A', '2022-02-22 17:30:21.842019+00:00:00', 4, 'Standard', '3de1dff7-2f74-40b0-884d-2e4032be5cf6') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842034+00:00:00', '2022-06-22 17:30:21.945572+00:00:00', 'sha1', '2022-06-22 17:30:21.842034+00:00:00', '9260040e157b4eb99fc9224c3f003343', 74) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842048+00:00:00', '2022-06-22 17:30:21.946347+00:00:00', 'sha1', '2022-06-22 17:30:21.842048+00:00:00', 'be3249c9c9ab42e998f8c250f40f18a1', 74) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842066+00:00:00', '2022-06-22 17:30:21.946992+00:00:00', 'sha1', '2022-06-22 17:30:21.842066+00:00:00', '97ddc5e02ebe41dbbfa2d35e799ca6ed', 74) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842082+00:00:00', '2022-06-22 17:30:21.948014+00:00:00', 'sha1', '2022-06-22 17:30:21.842082+00:00:00', 'cfe08b6d6c9c40279a7f5abb024e70d2', 74) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 74, 'https://www.dynamicstreamline.io/e-services/benchmark') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 74, 'http://www.dynamicgranular.net/dynamic/disintermediate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 74, 'https://www.districtcutting-edge.net/enterprise/sticky') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 74, 'https://www.centralarchitectures.info/revolutionize/facilitate/architect/repurpose') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842024+00:00:00', '2022-06-22 17:30:21.951392+00:00:00', 'Sheep', '2022-06-22 17:30:21.842024+00:00:00', 'Future behave legislation breakfast.', 'ingestion', 74, '41662fa7-61fb-43f4-8ed8-625b0c8674db', 4, 15, 'Concern talk strengthen river.', DEFAULT, 'Success', 'Ten FIDY', 'USSearch') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84204+00:00:00', '2022-06-22 17:30:21.952267+00:00:00', 'Sheep', '2022-06-22 17:30:21.84204+00:00:00', 'Tone train expert character.', 'ingestion', 74, '27d74b6a-2f5c-4400-a450-cee34608c065', 4, 15, 'Flat finish excuse section.', DEFAULT, 'Success', 'Trappistes Rochefort 8', 'GoodGuide') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842056+00:00:00', '2022-06-22 17:30:21.953064+00:00:00', 'Sheep', '2022-06-22 17:30:21.842056+00:00:00', 'Notice city preserve state.', 'ingestion', 74, 'c2171f9e-84b0-4c19-9dea-ed076f9d8153', 4, 15, 'Advantage minute conduct head.', DEFAULT, 'Success', 'Brooklyn Black', 'Jabari Mills') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842073+00:00:00', '2022-06-22 17:30:21.953824+00:00:00', 'Chicken', '2022-06-22 17:30:21.842073+00:00:00', 'Convention guy wife phone.', 'ingestion', 74, '439397f9-f73e-45a4-902b-923ea8dfa151', 4, 15, 'South gate mirror safety.', DEFAULT, 'Success', 'Alpha King Pale Ale', 'Adaptive') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.84209+00:00:00', '2022-06-22 17:30:21.954578+00:00:00', 'reptiles', 1321790196375216776, 'test.edu/Goosethink/data/presidentcall48.wpd', 15, 'A', '2022-02-22 17:30:21.84209+00:00:00', 4, 'Standard', 'fa99a5f3-a7ad-4859-a570-f0731dcb7d73') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842105+00:00:00', '2022-06-22 17:30:21.955317+00:00:00', 'sha1', '2022-06-22 17:30:21.842105+00:00:00', '1607a3719b3c498b91f5ca660024af55', 75) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842121+00:00:00', '2022-06-22 17:30:21.956058+00:00:00', 'sha1', '2022-06-22 17:30:21.842121+00:00:00', '79892a1f31374adfaa491a4a2e24e39f', 75) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842139+00:00:00', '2022-06-22 17:30:21.956793+00:00:00', 'sha1', '2022-06-22 17:30:21.842139+00:00:00', '736e313f6e634a8d81753c8085536b0f', 75) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842154+00:00:00', '2022-06-22 17:30:21.95755+00:00:00', 'sha1', '2022-06-22 17:30:21.842154+00:00:00', '2f0f1cefdbf94670951403014351fcc6', 75) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 75, 'http://www.principalvalue-added.com/extend/solutions') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 75, 'http://www.forwardenvisioneer.io/action-items/killer') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 75, 'https://www.internalniches.info/applications/content/cross-platform') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 75, 'https://www.futuredeploy.org/24-7') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842095+00:00:00', '2022-06-22 17:30:21.960966+00:00:00', 'Pig', '2022-06-22 17:30:21.842095+00:00:00', 'Accept species limit detect.', 'ingestion', 75, '6402eb75-1d23-4dbd-91f2-781bba99b18f', 4, 15, 'Amount us opportunity creation.', DEFAULT, 'Success', 'Bell’s Expedition', 'Juvenal Romaguera') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842112+00:00:00', '2022-06-22 17:30:21.961662+00:00:00', 'Goat', '2022-06-22 17:30:21.842112+00:00:00', 'Remind press view intend.', 'ingestion', 75, '5ae79b04-05ef-4abb-ba58-2d19a1fe7ae4', 4, 15, 'Watch destroy paul marriage.', DEFAULT, 'Success', 'Westmalle Trappist Tripel', 'AreaVibes Inc.') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842129+00:00:00', '2022-06-22 17:30:21.962538+00:00:00', 'Goat', '2022-06-22 17:30:21.842129+00:00:00', 'Can voice organise wear.', 'ingestion', 75, 'db3b24f9-5f6e-4ef4-bdaa-6a58f8d08b87', 4, 15, 'Dance own analysis should.', DEFAULT, 'Success', 'Trois Pistoles', 'Sandy Schmeler') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842145+00:00:00', '2022-06-22 17:30:21.963176+00:00:00', 'Horse', '2022-06-22 17:30:21.842145+00:00:00', 'Emerge reject benefit emphasis.', 'ingestion', 75, 'a244fe23-500d-454c-b77b-a841d75dd770', 4, 15, 'Investigate understand doubt product.', DEFAULT, 'Success', 'Bell’s Expedition', 'ideas42') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.842159+00:00:00', '2022-06-22 17:30:21.96368+00:00:00', 'fish', 2547999220962609240, 'test.edu/Goosethink/data/statementnotice628.csv', 15, 'A', '2022-02-22 17:30:21.842159+00:00:00', 4, 'Standard', 'b4e82c47-2f7f-433b-ab9b-c7cd617beabf') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842171+00:00:00', '2022-06-22 17:30:21.964259+00:00:00', 'sha1', '2022-06-22 17:30:21.842171+00:00:00', 'e958a8f54fa3472a911235a46cc729d3', 76) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842186+00:00:00', '2022-06-22 17:30:21.964714+00:00:00', 'sha1', '2022-06-22 17:30:21.842186+00:00:00', 'ad771aab3154420dbc8aa08e7b9042b3', 76) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842203+00:00:00', '2022-06-22 17:30:21.965196+00:00:00', 'sha1', '2022-06-22 17:30:21.842203+00:00:00', 'd15d3246376841219d645d6d9b1cd729', 76) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842218+00:00:00', '2022-06-22 17:30:21.965616+00:00:00', 'sha1', '2022-06-22 17:30:21.842218+00:00:00', '6f40b099bd2943daa71fbecec485a1e4', 76) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 76, 'http://www.nationalinnovative.net/orchestrate/generate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 76, 'http://www.productenvisioneer.info/seamless/web-enabled') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 76, 'http://www.globalviral.biz/one-to-one/vertical/partnerships') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 76, 'http://www.internalleverage.info/functionalities/initiatives/proactive') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842164+00:00:00', '2022-06-22 17:30:21.96801+00:00:00', 'Goose', '2022-06-22 17:30:21.842164+00:00:00', 'Earn system respect step.', 'ingestion', 76, '6c0c5894-ff05-45f8-9dc0-96083c6e25d4', 4, 15, 'Mum van respect charity.', DEFAULT, 'Success', 'Schneider Aventinus', 'Expert Health Data Programming, Inc.') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842177+00:00:00', '2022-06-22 17:30:21.968591+00:00:00', 'Turkey', '2022-06-22 17:30:21.842177+00:00:00', 'Empire victim comment club.', 'ingestion', 76, '909bea5d-bb81-41ab-b642-bac6b38bd008', 4, 15, 'Release control solve term.', DEFAULT, 'Success', '90 Minute IPA', 'Nielsen') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842192+00:00:00', '2022-06-22 17:30:21.969033+00:00:00', 'Chicken', '2022-06-22 17:30:21.842192+00:00:00', 'Concentrate pick risk begin.', 'ingestion', 76, '91a155d8-cf83-448e-8571-abe8fefd9994', 4, 15, 'Plane review reveal define.', DEFAULT, 'Success', 'Shakespeare Oatmeal', 'Maximo Langworth') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84221+00:00:00', '2022-06-22 17:30:21.969511+00:00:00', 'Goose', '2022-06-22 17:30:21.84221+00:00:00', 'Blame addition explain check.', 'ingestion', 76, 'cd081b64-4a30-448f-a9a8-ceb29f57f41e', 4, 15, 'Review earn sign silver.', DEFAULT, 'Success', 'Maharaj', 'Progressive Insurance Group') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.842225+00:00:00', '2022-06-22 17:30:21.970054+00:00:00', 'invertebrates', 1139995903317371904, 'test.edu/Goosethink/data/strugglelike326.rar', 15, 'A', '2022-02-22 17:30:21.842225+00:00:00', 4, 'Standard', '61d8e6e8-1d33-47c0-b8d5-f34fa52e7e63') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842237+00:00:00', '2022-06-22 17:30:21.970533+00:00:00', 'sha1', '2022-06-22 17:30:21.842237+00:00:00', 'b82ed901756d4a97965cc6854bcb72f1', 77) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842253+00:00:00', '2022-06-22 17:30:21.971017+00:00:00', 'sha1', '2022-06-22 17:30:21.842253+00:00:00', '86f250afc1cd43bb98b1a831edae3745', 77) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842268+00:00:00', '2022-06-22 17:30:21.971493+00:00:00', 'sha1', '2022-06-22 17:30:21.842268+00:00:00', '9a915d5635794725a5d614697e2f62f6', 77) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842283+00:00:00', '2022-06-22 17:30:21.971901+00:00:00', 'sha1', '2022-06-22 17:30:21.842283+00:00:00', '1d04c7d82755496d85a5503fe7396e5d', 77) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 77, 'http://www.legacymission-critical.info/networks/aggregate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 77, 'https://www.nationalexpedite.org/vertical/24-7') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 77, 'https://www.regionalwebservices.net/enable/mindshare/open-source/networks') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 77, 'https://www.directsexy.net/distributed/web-enabled/cultivate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842229+00:00:00', '2022-06-22 17:30:21.974254+00:00:00', 'Pig', '2022-06-22 17:30:21.842229+00:00:00', 'Expert overcome truth sort.', 'ingestion', 77, '4c6369d2-3fbe-4fba-b3fe-66b5f7ef8e66', 4, 15, 'Object offence bottle hate.', DEFAULT, 'Success', 'Chocolate St', 'United Mayflower') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842244+00:00:00', '2022-06-22 17:30:21.974792+00:00:00', 'Turkey', '2022-06-22 17:30:21.842244+00:00:00', 'Proposal enable provide constitute.', 'ingestion', 77, '1f72ac13-9292-497b-b995-021b63fc717a', 4, 15, 'Climb look ignore unemployment.', DEFAULT, 'Success', 'Schneider Aventinus', 'CAN Capital') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842258+00:00:00', '2022-06-22 17:30:21.97532+00:00:00', 'Donkey', '2022-06-22 17:30:21.842258+00:00:00', 'Forgive stuff rule victory.', 'ingestion', 77, '2d20e07b-e221-4366-a053-0fa3e339c27c', 4, 15, 'Magazine focus manage accept.', DEFAULT, 'Success', 'Trappistes Rochefort 10', 'Missouri Hilpert') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842275+00:00:00', '2022-06-22 17:30:21.975866+00:00:00', 'Horse', '2022-06-22 17:30:21.842275+00:00:00', 'Farm surprise meet of.', 'ingestion', 77, '96bcfea3-bd66-4a87-a4c3-0957a702b52c', 4, 15, 'Sit damage section generation.', DEFAULT, 'Success', '90 Minute IPA', 'OpenPlans') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.84229+00:00:00', '2022-06-22 17:30:21.976378+00:00:00', 'mammals', 6245597971838586257, 'test.edu/Goosethink/data/strikeachieve699.psd', 15, 'A', '2022-02-22 17:30:21.84229+00:00:00', 4, 'Standard', 'f848cab3-7279-422b-bdcf-ec44be1af8bd') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842304+00:00:00', '2022-06-22 17:30:21.977009+00:00:00', 'sha1', '2022-06-22 17:30:21.842304+00:00:00', '63e915f494fa4de8b55382fb0a7b8d39', 78) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84232+00:00:00', '2022-06-22 17:30:21.977685+00:00:00', 'sha1', '2022-06-22 17:30:21.84232+00:00:00', '0d4cdd1ab6c44ddd81a18ba25b202b5b', 78) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842334+00:00:00', '2022-06-22 17:30:21.978325+00:00:00', 'sha1', '2022-06-22 17:30:21.842334+00:00:00', '6325b0ee8ff84e738f048f48f170165f', 78) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842349+00:00:00', '2022-06-22 17:30:21.978976+00:00:00', 'sha1', '2022-06-22 17:30:21.842349+00:00:00', '6942405de4c841d994969cbf515e2ef0', 78) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 78, 'https://www.principalintegrate.org/empower/facilitate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 78, 'http://www.product24-365.name/innovate/vortals/virtual') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 78, 'http://www.leadfunctionalities.info/enable') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 78, 'http://www.investorredefine.net/synergize') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842295+00:00:00', '2022-06-22 17:30:21.981365+00:00:00', 'Goose', '2022-06-22 17:30:21.842295+00:00:00', 'Process implement brain window.', 'ingestion', 78, '24714e7d-d97a-45e4-8ac9-84859eebf104', 4, 15, 'Charge would behave money.', DEFAULT, 'Success', 'St. Bernardus Abt 12', 'Felix Mante') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842311+00:00:00', '2022-06-22 17:30:21.981925+00:00:00', 'Cow', '2022-06-22 17:30:21.842311+00:00:00', 'Involvement recognize material assess.', 'ingestion', 78, 'e77517e5-b149-4f43-9734-9a26d672a3ce', 4, 15, 'Treatment flight choose china.', DEFAULT, 'Success', 'Double Bastard Ale', 'Kenyon Larkin') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842326+00:00:00', '2022-06-22 17:30:21.982548+00:00:00', 'Turkey', '2022-06-22 17:30:21.842326+00:00:00', 'Forest effort name audience.', 'ingestion', 78, '0da94c43-0370-41a9-862a-c5cf637c3f3f', 4, 15, 'Life gate creation selection.', DEFAULT, 'Success', 'Sierra Nevada Celebration Ale', 'Redfin') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84234+00:00:00', '2022-06-22 17:30:21.983255+00:00:00', 'Cow', '2022-06-22 17:30:21.84234+00:00:00', 'Tv understand move send.', 'ingestion', 78, '6a4f20ad-a76b-4e76-aa43-03a28e1441b7', 4, 15, 'Parliament teach address side.', DEFAULT, 'Success', 'Westmalle Trappist Tripel', 'Mohammed Senger') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.842354+00:00:00', '2022-06-22 17:30:21.983986+00:00:00', 'amphibians', 8046376713117958441, 'test.edu/Goosethink/data/knowledgevoice77.sdf', 15, 'A', '2022-02-22 17:30:21.842354+00:00:00', 4, 'Standard', 'bc629218-6f8d-409a-91d8-7dd390779071') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842369+00:00:00', '2022-06-22 17:30:21.984754+00:00:00', 'sha1', '2022-06-22 17:30:21.842369+00:00:00', 'e7050c5b8f7d485b805a16473e7f769d', 79) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842383+00:00:00', '2022-06-22 17:30:21.985436+00:00:00', 'sha1', '2022-06-22 17:30:21.842383+00:00:00', '6a32f590979842a189197d06d91a4f84', 79) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842398+00:00:00', '2022-06-22 17:30:21.986107+00:00:00', 'sha1', '2022-06-22 17:30:21.842398+00:00:00', 'ceea038785664d54b35fdfe298e19b96', 79) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842412+00:00:00', '2022-06-22 17:30:21.98679+00:00:00', 'sha1', '2022-06-22 17:30:21.842412+00:00:00', '5d5a91ba755c4826ac78bc40d3fe3f04', 79) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 79, 'http://www.nationalworld-class.io/sticky') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 79, 'https://www.nationalrepurpose.biz/deliverables/intuitive/expedite/holistic') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 79, 'https://www.seniorenable.org/communities/magnetic') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 79, 'http://www.corporateoptimize.name/expedite/strategic/dynamic') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84236+00:00:00', '2022-06-22 17:30:21.990341+00:00:00', 'Goose', '2022-06-22 17:30:21.84236+00:00:00', 'Head monitor section relax.', 'ingestion', 79, '4655dd3c-9baf-4d01-9482-cbbab84321c4', 4, 15, 'Join sign garden difference.', DEFAULT, 'Success', 'Oaked Arrogant Bastard Ale', 'Granville Luettgen') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842375+00:00:00', '2022-06-22 17:30:21.991045+00:00:00', 'Turkey', '2022-06-22 17:30:21.842375+00:00:00', 'Start presence slip mention.', 'ingestion', 79, '2fcff2bd-be28-4d1a-8f6b-fb09e592ee89', 4, 15, 'Provide newspaper interpretation press.', DEFAULT, 'Success', 'Ten FIDY', 'ideas42') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84239+00:00:00', '2022-06-22 17:30:21.991833+00:00:00', 'Cow', '2022-06-22 17:30:21.84239+00:00:00', 'Drama hope throw professor.', 'ingestion', 79, 'cae9b2b2-b18d-44af-a0b9-3ce504a32671', 4, 15, 'Palace combination lift land.', DEFAULT, 'Success', 'Trois Pistoles', 'Careset.com') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842404+00:00:00', '2022-06-22 17:30:21.992636+00:00:00', 'Goose', '2022-06-22 17:30:21.842404+00:00:00', 'Pay advice acquire measure.', 'ingestion', 79, '6ea5169e-83bb-4b7d-933c-3eb4a85eac40', 4, 15, 'Letter floor waste occur.', DEFAULT, 'Success', 'Dreadnaught IPA', 'Alexandrea Cummerata') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.842418+00:00:00', '2022-06-22 17:30:21.993441+00:00:00', 'invertebrates', 9083841544145254022, 'test.edu/Goosethink/data/existencetrain734.mov', 15, 'A', '2022-02-22 17:30:21.842418+00:00:00', 4, 'Standard', '644b5158-e8e0-4a48-917e-c154e2af0457') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842485+00:00:00', '2022-06-22 17:30:21.994177+00:00:00', 'sha1', '2022-06-22 17:30:21.842485+00:00:00', '424e0f22b0184bf1882c5f439671d319', 80) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842504+00:00:00', '2022-06-22 17:30:21.994898+00:00:00', 'sha1', '2022-06-22 17:30:21.842504+00:00:00', 'e64e33a75b814d3a9a0779f98ad03d81', 80) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842518+00:00:00', '2022-06-22 17:30:21.995706+00:00:00', 'sha1', '2022-06-22 17:30:21.842518+00:00:00', 'c3dc6f7d4eba4c32ad8b7312e7694274', 80) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842533+00:00:00', '2022-06-22 17:30:21.996494+00:00:00', 'sha1', '2022-06-22 17:30:21.842533+00:00:00', 'ed8a0463796d43cfa081c4e5e0b4d0b1', 80) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 80, 'https://www.leadrobust.biz/experiences/mindshare') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 80, 'http://www.centralplug-and-play.com/real-time/web-enabled/functionalities') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 80, 'https://www.productmodels.org/matrix/compelling') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 80, 'http://www.customeroptimize.com/back-end/partnerships') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:21-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842423+00:00:00', '2022-06-22 17:30:21.999826+00:00:00', 'Horse', '2022-06-22 17:30:21.842423+00:00:00', 'Aim act window win.', 'ingestion', 80, '9b625698-cb6c-435a-b7ca-8cc152dd3f64', 4, 15, 'Taylor emerge theme weekend.', DEFAULT, 'Success', 'Bourbon County Stout', 'Suddath') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842496+00:00:00', '2022-06-22 17:30:22.000608+00:00:00', 'Horse', '2022-06-22 17:30:21.842496+00:00:00', 'Fact ice voice surface.', 'ingestion', 80, '9eaeb9b2-287a-479c-b93b-d34f04396ed2', 4, 15, 'Screen movement currency examine.', DEFAULT, 'Success', 'Trappistes Rochefort 8', 'HERE') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.84251+00:00:00', '2022-06-22 17:30:22.001459+00:00:00', 'Cow', '2022-06-22 17:30:21.84251+00:00:00', 'Clause constitution prove acknowledge.', 'ingestion', 80, '39579265-e40f-4c16-9bed-c7f598295402', 4, 15, 'Recommend hole continue grant.', DEFAULT, 'Success', 'La Fin Du Monde', 'Sydni Lindgren') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842523+00:00:00', '2022-06-22 17:30:22.002356+00:00:00', 'Turkey', '2022-06-22 17:30:21.842523+00:00:00', 'Row book approval throw.', 'ingestion', 80, '413dac7b-5101-47c7-a9e9-0aef5dd13be2', 4, 15, 'Eat move hope celebrate.', DEFAULT, 'Success', 'Dreadnaught IPA', 'Wilfrid Wunsch') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.842538+00:00:00', '2022-06-22 17:30:22.003139+00:00:00', 'amphibians', 46818822304625470, 'test.edu/Goosethink/data/speechexercise359.part', 15, 'A', '2022-02-22 17:30:21.842538+00:00:00', 4, 'Standard', '89f4cd90-cd11-4786-a5bd-227fa77660c5') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842551+00:00:00', '2022-06-22 17:30:22.004007+00:00:00', 'sha1', '2022-06-22 17:30:21.842551+00:00:00', '7cccb0ed742441cdb7f2d50a3aaf22fd', 81) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842566+00:00:00', '2022-06-22 17:30:22.004776+00:00:00', 'sha1', '2022-06-22 17:30:21.842566+00:00:00', 'c6ee2b9e49704049b87a9e9c93bc96eb', 81) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842579+00:00:00', '2022-06-22 17:30:22.005467+00:00:00', 'sha1', '2022-06-22 17:30:21.842579+00:00:00', '111514767cfe4ef799651e9def28db0f', 81) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842597+00:00:00', '2022-06-22 17:30:22.006155+00:00:00', 'sha1', '2022-06-22 17:30:21.842597+00:00:00', '649c37c7b2ee41be91c2c0b69df26764', 81) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 81, 'https://www.globalmarkets.info/bandwidth/morph/24-365/strategic') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 81, 'http://www.forwardstrategic.net/interfaces') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 81, 'https://www.internalclicks-and-mortar.name/efficient/redefine') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 81, 'http://www.leadembrace.info/applications/vertical') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842543+00:00:00', '2022-06-22 17:30:22.00958+00:00:00', 'Cow', '2022-06-22 17:30:21.842543+00:00:00', 'Determine submit name design.', 'ingestion', 81, 'fa4c0794-f6cc-49fe-a271-96642e41faa1', 4, 15, 'Fall officer foundation tree.', DEFAULT, 'Success', '90 Minute IPA', 'Donavon Carroll') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842557+00:00:00', '2022-06-22 17:30:22.010273+00:00:00', 'Goose', '2022-06-22 17:30:21.842557+00:00:00', 'Campaign market observe intend.', 'ingestion', 81, 'ce90496b-7483-470c-8297-5a43d8252f0d', 4, 15, 'Principle ignore response demonstrate.', DEFAULT, 'Success', 'Sierra Nevada Bigfoot Barleywine Style Ale', 'Virgil Koelpin') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842571+00:00:00', '2022-06-22 17:30:22.01097+00:00:00', 'Goat', '2022-06-22 17:30:21.842571+00:00:00', 'Blow improve level describe.', 'ingestion', 81, '124dc72f-4513-403a-83b0-c3329a135b46', 4, 15, 'Fail world offer sum.', DEFAULT, 'Success', 'Oaked Arrogant Bastard Ale', 'The DocGraph Journal') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842585+00:00:00', '2022-06-22 17:30:22.011683+00:00:00', 'Duck', '2022-06-22 17:30:21.842585+00:00:00', 'Price event lose claim.', 'ingestion', 81, '4fbebd2d-fb96-4e11-91ff-5ad8be1b868f', 4, 15, 'Replace ensure case offer.', DEFAULT, 'Success', 'Chocolate St', 'Nikita Fritsch') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:21.842603+00:00:00', '2022-06-22 17:30:22.012568+00:00:00', 'birds', 3721447550266618297, 'test.edu/Goosethink/data/messagecope182.obj', 15, 'A', '2022-02-22 17:30:21.842603+00:00:00', 4, 'Standard', '2ab15c0b-4342-4073-a4fd-17f5f7468d2e') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842616+00:00:00', '2022-06-22 17:30:22.013159+00:00:00', 'sha1', '2022-06-22 17:30:21.842616+00:00:00', '1f86917757494369a43233a1d8a7af66', 82) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.84263+00:00:00', '2022-06-22 17:30:22.013672+00:00:00', 'sha1', '2022-06-22 17:30:21.84263+00:00:00', 'fbbe9bb21c164cee9906c398e252efe6', 82) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842645+00:00:00', '2022-06-22 17:30:22.014174+00:00:00', 'sha1', '2022-06-22 17:30:21.842645+00:00:00', '2526cca04a564541810e33a4420d29b6', 82) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" AS \"checksum\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:21.842672+00:00:00', '2022-06-22 17:30:22.014594+00:00:00', 'sha1', '2022-06-22 17:30:21.842672+00:00:00', 'e19fb1ac0dea4215865e545c6e546ef1', 82) ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 82, 'http://www.chiefarchitect.biz/revolutionize/e-commerce/aggregate') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 82, 'http://www.humanreinvent.org/web-enabled/clicks-and-mortar/whiteboard') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 82, 'https://www.directfacilitate.io/end-to-end/value-added/efficient') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" AS \"storage_record\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 82, 'http://www.humanviral.biz/platforms/productize/cross-platform/matrix') ON CONFLICT DO NOTHING RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842608+00:00:00', '2022-06-22 17:30:22.016894+00:00:00', 'Donkey', '2022-06-22 17:30:21.842608+00:00:00', 'Expert set open cook.', 'ingestion', 82, 'ab2c3762-ec1d-4338-ad4e-f4a175c6b2d1', 4, 15, 'Come service save afternoon.', DEFAULT, 'Success', 'Dreadnaught IPA', 'Cappex') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842621+00:00:00', '2022-06-22 17:30:22.017395+00:00:00', 'Chicken', '2022-06-22 17:30:21.842621+00:00:00', 'Store cry avoid fight.', 'ingestion', 82, '67c556da-98dd-4cbe-bb45-c4e86c589eeb', 4, 15, 'Carry visit play wan.', DEFAULT, 'Success', 'Ruination IPA', 'Leda Rowe') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842636+00:00:00', '2022-06-22 17:30:22.017864+00:00:00', 'Duck', '2022-06-22 17:30:21.842636+00:00:00', 'Marry world may can.', 'ingestion', 82, 'a5f47027-f9e9-4b29-b464-938f61ce6a51', 4, 15, 'Length patient forest path.', DEFAULT, 'Success', 'Trappistes Rochefort 8', 'Ez-XBRL') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:21.842651+00:00:00', '2022-06-22 17:30:22.018404+00:00:00', 'Sheep', '2022-06-22 17:30:21.842651+00:00:00', 'Frank revenue dance peter.', 'ingestion', 82, 'd81038d8-bdf1-4df6-ac9d-f5c15f2fad5b', 4, 15, 'Clause operation challenge distribution.', DEFAULT, 'Success', 'Sierra Nevada Bigfoot Barleywine Style Ale', 'Robinson + Yu') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE ((intellectual_object_id = 15))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 63))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 63))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 63))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 64))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 64))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 64))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 65))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 65))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 65))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 66))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 66))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 66))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 67))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 67))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 67))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 68))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 68))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 68))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 69))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 69))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 69))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 70))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 70))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 70))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 71))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 71))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 71))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 72))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 72))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 72))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 73))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 73))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 73))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 74))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 74))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 74))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 75))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 75))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 75))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 76))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 76))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 76))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 77))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 77))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 77))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 78))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 78))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 78))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 79))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 79))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 79))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 80))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 80))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 80))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 81))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 81))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 81))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((generic_file_id = 82))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE ((generic_file_id = 82))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 82))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"generic_file_view\".\"id\", \"generic_file_view\".\"file_format\", \"generic_file_view\".\"size\", \"generic_file_view\".\"identifier\", \"generic_file_view\".\"intellectual_object_id\", \"generic_file_view\".\"object_identifier\", \"generic_file_view\".\"access\", \"generic_file_view\".\"state\", \"generic_file_view\".\"last_fixity_check\", \"generic_file_view\".\"institution_id\", \"generic_file_view\".\"institution_name\", \"generic_file_view\".\"institution_identifier\", \"generic_file_view\".\"storage_option\", \"generic_file_view\".\"uuid\", \"generic_file_view\".\"md5\", \"generic_file_view\".\"sha1\", \"generic_file_view\".\"sha256\", \"generic_file_view\".\"sha512\", \"generic_file_view\".\"created_at\", \"generic_file_view\".\"updated_at\" FROM \"generic_files_view\" AS \"generic_file_view\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"generic_file_view\".\"id\", \"generic_file_view\".\"file_format\", \"generic_file_view\".\"size\", \"generic_file_view\".\"identifier\", \"generic_file_view\".\"intellectual_object_id\", \"generic_file_view\".\"object_identifier\", \"generic_file_view\".\"access\", \"generic_file_view\".\"state\", \"generic_file_view\".\"last_fixity_check\", \"generic_file_view\".\"institution_id\", \"generic_file_view\".\"institution_name\", \"generic_file_view\".\"institution_identifier\", \"generic_file_view\".\"storage_option\", \"generic_file_view\".\"uuid\", \"generic_file_view\".\"md5\", \"generic_file_view\".\"sha1\", \"generic_file_view\".\"sha256\", \"generic_file_view\".\"sha512\", \"generic_file_view\".\"created_at\", \"generic_file_view\".\"updated_at\" FROM \"generic_files_view\" AS \"generic_file_view\" WHERE ((identifier = 'institution1.edu/photos/picture1'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"generic_file_view\".\"id\", \"generic_file_view\".\"file_format\", \"generic_file_view\".\"size\", \"generic_file_view\".\"identifier\", \"generic_file_view\".\"intellectual_object_id\", \"generic_file_view\".\"object_identifier\", \"generic_file_view\".\"access\", \"generic_file_view\".\"state\", \"generic_file_view\".\"last_fixity_check\", \"generic_file_view\".\"institution_id\", \"generic_file_view\".\"institution_name\", \"generic_file_view\".\"institution_identifier\", \"generic_file_view\".\"storage_option\", \"generic_file_view\".\"uuid\", \"generic_file_view\".\"md5\", \"generic_file_view\".\"sha1\", \"generic_file_view\".\"sha256\", \"generic_file_view\".\"sha512\", \"generic_file_view\".\"created_at\", \"generic_file_view\".\"updated_at\" FROM \"generic_files_view\" AS \"generic_file_view\" WHERE ((state = 'A')) ORDER BY \"created_at\" asc LIMIT 40"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'test.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((name = 'Institution One'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((name != 'Institution One') AND (name != 'Institution Two')) ORDER BY \"name\" asc"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"institutions\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"identifier\", \"state\", \"type\", \"member_institution_id\", \"deactivated_at\", \"otp_enabled\", \"enable_spot_restore\", \"receiving_bucket\", \"restore_bucket\") VALUES (DEFAULT, '2022-06-22 17:30:22.077374+00:00:00', '2022-06-22 17:30:22.077374+00:00:00', 'Unit Test Inst #1', 'test1.kom', 'A', 'MemberInstitution', DEFAULT, DEFAULT, FALSE, FALSE, 'aptrust.receiving.test.test1.kom', 'aptrust.restore.test.test1.kom') RETURNING \"id\", \"member_institution_id\", \"deactivated_at\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"institutions\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"identifier\", \"state\", \"type\", \"member_institution_id\", \"deactivated_at\", \"otp_enabled\", \"enable_spot_restore\", \"receiving_bucket\", \"restore_bucket\") VALUES (DEFAULT, '2022-06-22 17:30:22.079321+00:00:00', '2022-06-22 17:30:22.079321+00:00:00', 'Unit Test Inst #2', 'test2.kom', 'A', 'MemberInstitution', DEFAULT, DEFAULT, FALSE, FALSE, 'aptrust.receiving.test.test2.kom', 'aptrust.restore.test.test2.kom') RETURNING \"id\", \"member_institution_id\", \"deactivated_at\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"institutions\" AS \"institution\" SET \"created_at\" = '2022-06-22 17:30:22.079321+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.079321+00:00:00', \"name\" = 'Unit Test Inst #2', \"identifier\" = 'test2.kom', \"state\" = 'D', \"type\" = 'MemberInstitution', \"member_institution_id\" = NULL, \"deactivated_at\" = '2022-06-22 17:30:22.080647+00:00:00', \"otp_enabled\" = FALSE, \"enable_spot_restore\" = FALSE, \"receiving_bucket\" = 'aptrust.receiving.test.test2.kom', \"restore_bucket\" = 'aptrust.restore.test.test2.kom' WHERE \"institution\".\"id\" = 7"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"institutions\" AS \"institution\" SET \"created_at\" = '2022-06-22 17:30:22.079321+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.079321+00:00:00', \"name\" = 'Unit Test Inst #2', \"identifier\" = 'test2.kom', \"state\" = 'A', \"type\" = 'MemberInstitution', \"member_institution_id\" = NULL, \"deactivated_at\" = NULL, \"otp_enabled\" = FALSE, \"enable_spot_restore\" = FALSE, \"receiving_bucket\" = 'aptrust.receiving.test.test2.kom', \"restore_bucket\" = 'aptrust.restore.test.test2.kom' WHERE \"institution\".\"id\" = 7"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"id\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'institution1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"id\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'institution2.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"id\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'bad identifier'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"institution_view\".\"id\", \"institution_view\".\"name\", \"institution_view\".\"identifier\", \"institution_view\".\"state\", \"institution_view\".\"type\", \"institution_view\".\"deactivated_at\", \"institution_view\".\"otp_enabled\", \"institution_view\".\"enable_spot_restore\", \"institution_view\".\"receiving_bucket\", \"institution_view\".\"restore_bucket\", \"institution_view\".\"created_at\", \"institution_view\".\"updated_at\", \"institution_view\".\"parent_id\", \"institution_view\".\"parent_name\", \"institution_view\".\"parent_identifier\", \"institution_view\".\"parent_state\", \"institution_view\".\"parent_deactivated_at\" FROM \"institutions_view\" AS \"institution_view\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"institution_view\".\"id\", \"institution_view\".\"name\", \"institution_view\".\"identifier\", \"institution_view\".\"state\", \"institution_view\".\"type\", \"institution_view\".\"deactivated_at\", \"institution_view\".\"otp_enabled\", \"institution_view\".\"enable_spot_restore\", \"institution_view\".\"receiving_bucket\", \"institution_view\".\"restore_bucket\", \"institution_view\".\"created_at\", \"institution_view\".\"updated_at\", \"institution_view\".\"parent_id\", \"institution_view\".\"parent_name\", \"institution_view\".\"parent_identifier\", \"institution_view\".\"parent_state\", \"institution_view\".\"parent_deactivated_at\" FROM \"institutions_view\" AS \"institution_view\" WHERE ((identifier = 'aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"institution_view\".\"id\", \"institution_view\".\"name\", \"institution_view\".\"identifier\", \"institution_view\".\"state\", \"institution_view\".\"type\", \"institution_view\".\"deactivated_at\", \"institution_view\".\"otp_enabled\", \"institution_view\".\"enable_spot_restore\", \"institution_view\".\"receiving_bucket\", \"institution_view\".\"restore_bucket\", \"institution_view\".\"created_at\", \"institution_view\".\"updated_at\", \"institution_view\".\"parent_id\", \"institution_view\".\"parent_name\", \"institution_view\".\"parent_identifier\", \"institution_view\".\"parent_state\", \"institution_view\".\"parent_deactivated_at\" FROM \"institutions_view\" AS \"institution_view\" WHERE ((state = 'A')) ORDER BY \"created_at\" asc"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"identifier\" = 'institution1.edu/photos'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE ((institution_id = 2))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE ((institution_id = 2) AND (access = 'consortia'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE ((\"intellectual_object\".\"identifier\" = 'institution1.edu/photos'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE ((\"intellectual_object\".\"identifier\" = 'institution2.edu/coal'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE ((\"intellectual_object\".\"identifier\" = 'bad identifier'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 1 and state = 'A') LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 14))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 14 and state = 'A') LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 6))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 6) AND (event_type = 'ingestion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 6))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 6) AND (event_type = 'deletion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"intellectual_objects\" (\"id\", \"created_at\", \"updated_at\", \"title\", \"description\", \"identifier\", \"alt_identifier\", \"access\", \"bag_name\", \"institution_id\", \"state\", \"etag\", \"bag_group_identifier\", \"storage_option\", \"bagit_profile_identifier\", \"source_organization\", \"internal_sender_identifier\", \"internal_sender_description\") VALUES (DEFAULT, '2022-06-22 17:30:22.105283+00:00:00', '2022-06-22 17:30:22.105283+00:00:00', 'TestObject999', 'Obj Created by Test', 'test.edu/obj1', 'Yadda-Yadda-Yo', 'institution', 'TestObject999.tar', 4, 'A', '12345678-9', 'group-999', 'Standard', 'https://example.com/profile.json', 'Willy Wonka''s Chocolate Factory', 'yadda-999', 'Created by intel obj test') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"identifier\" = 'test.edu/obj1'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"intellectual_objects\" AS \"intellectual_object\" SET \"created_at\" = '2022-06-22 17:30:22.105283+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.108092+00:00:00', \"title\" = 'TestObject999', \"description\" = 'Updated description of obj1', \"identifier\" = 'test.edu/obj1', \"alt_identifier\" = 'Yadda-Yadda-Yo', \"access\" = 'institution', \"bag_name\" = 'TestObject999.tar', \"institution_id\" = 4, \"state\" = 'A', \"etag\" = '12345678-9', \"bag_group_identifier\" = 'group-999', \"storage_option\" = 'Standard', \"bagit_profile_identifier\" = 'https://example.com/profile.json', \"source_organization\" = 'Willy Wonka''s Chocolate Factory', \"internal_sender_identifier\" = 'yadda-999', \"internal_sender_description\" = 'Created by intel obj test' WHERE \"intellectual_object\".\"id\" = 16"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"intellectual_objects\" (\"id\", \"created_at\", \"updated_at\", \"title\", \"description\", \"identifier\", \"alt_identifier\", \"access\", \"bag_name\", \"institution_id\", \"state\", \"etag\", \"bag_group_identifier\", \"storage_option\", \"bagit_profile_identifier\", \"source_organization\", \"internal_sender_identifier\", \"internal_sender_description\") VALUES (DEFAULT, '2022-06-22 17:30:22.10996+00:00:00', '2022-06-22 17:30:22.10996+00:00:00', 'virtual context-sensitive incentivize', 'We need to back up the optical SSL microchip!', 'test.edu/Brownstrength', 'Duck', 'institution', 'auxiliary.tar', 4, 'A', 'd2a72cc9464149acafbb73e0dc544c65', 'individual', 'Standard', 'https://example.com/profile.json', 'Test University', 'Chalupa', 'Kickstarter yr humblebrag swag mixtape echo tattooed chicharrones hella ramps freegan blog.') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:22.111489+00:00:00', '2022-06-22 17:30:22.111729+00:00:00', 'mammals', 2637628464214655251, 'test.edu/Brownstrength/data/dramarecommend815.deskthemepack', 17, 'A', '2022-02-22 17:30:22.111489+00:00:00', 4, 'Standard', 'cf87e37f-00d8-4926-9163-b461c92ae7b3') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.113136+00:00:00', '2022-06-22 17:30:22.113176+00:00:00', 'Sheep', '2022-06-22 17:30:22.113136+00:00:00', 'Analysis use throw introduce.', 'ingestion', 83, '5b16108b-305c-4e97-aa1e-15ee8813191a', 4, 17, 'Sort aircraft mouth fear.', DEFAULT, 'Base deliver lady right offer.', 'Ten FIDY', 'Dora Schumm') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.113168+00:00:00', '2022-06-22 17:30:22.114841+00:00:00', 'Chicken', '2022-06-22 17:30:22.113168+00:00:00', 'Perform kind exercise flow.', 'identifier assignment', 83, 'b241299f-064b-4e90-817d-d9061995eb1a', 4, 17, 'Demonstrate need strength valley.', DEFAULT, 'Work maintenance child let smile.', 'Old Rasputin Russian Imperial Stout', 'GovTribe') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.116071+00:00:00', '2022-06-22 17:30:22.116096+00:00:00', 'md5', '2022-06-22 17:30:22.116071+00:00:00', '3c74d577e6db4b00be06e12db220e7a2', 83) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.116094+00:00:00', '2022-06-22 17:30:22.117185+00:00:00', 'sha256', '2022-06-22 17:30:22.116094+00:00:00', 'f230e3d2645a412187a03eb80cc47e34', 83) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 83, 'http://www.districtreal-time.org/real-time') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 83, 'http://www.chiefenvisioneer.biz/eyeballs/niches/viral') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:22.120413+00:00:00', '2022-06-22 17:30:22.120612+00:00:00', 'amphibians', 8287903916094194288, 'test.edu/Brownstrength/data/computerdrink103.tiff', 17, 'A', '2022-02-22 17:30:22.120413+00:00:00', 4, 'Standard', 'cf6a5dda-8fec-4240-9e37-362e137a3643') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.121577+00:00:00', '2022-06-22 17:30:22.121613+00:00:00', 'Sheep', '2022-06-22 17:30:22.121577+00:00:00', 'Style account quarter card.', 'ingestion', 84, '4de0d2f6-6416-4e2c-85c9-8a5e55b0729f', 4, 17, 'Kill race discussion lead.', DEFAULT, 'Tom expand report marriage right.', 'Founders Breakfast Stout', 'PlaceILive.com') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.121595+00:00:00', '2022-06-22 17:30:22.122696+00:00:00', 'Donkey', '2022-06-22 17:30:22.121595+00:00:00', 'Shall possess performance railway.', 'identifier assignment', 84, '442de1b9-4470-4e7d-bf23-7b487a5f4212', 4, 17, 'Enter sample case teacher.', DEFAULT, '''re commit conference cook officer.', 'Schneider Aventinus', 'Trintech') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.123797+00:00:00', '2022-06-22 17:30:22.12381+00:00:00', 'md5', '2022-06-22 17:30:22.123797+00:00:00', '7bd5ba7e698243c381d05b68f27b2788', 84) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.123808+00:00:00', '2022-06-22 17:30:22.124884+00:00:00', 'sha256', '2022-06-22 17:30:22.123808+00:00:00', '519f1866b8a245dfba6a602d9e16e2ef', 84) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 84, 'http://www.leadmorph.com/iterate/b2b/utilize') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 84, 'http://www.dynamicdistributed.net/holistic/enable/supply-chains') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:22.128977+00:00:00', '2022-06-22 17:30:22.129229+00:00:00', 'amphibians', 5283524861893823505, 'test.edu/Brownstrength/data/gapcontinue384.kmz', 17, 'A', '2022-02-22 17:30:22.128977+00:00:00', 4, 'Standard', '8170a205-22b3-4763-87a1-f46ae5a169cf') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.130208+00:00:00', '2022-06-22 17:30:22.130259+00:00:00', 'Duck', '2022-06-22 17:30:22.130208+00:00:00', 'Search truth government attend.', 'ingestion', 85, '28650f82-42dc-43ba-a23c-9ea75e11f4d1', 4, 17, 'Bet may contain finance.', DEFAULT, 'Interpretation analyse admit combine breakfast.', 'Nugget Nectar', 'Emmet Beatty') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.13024+00:00:00', '2022-06-22 17:30:22.131627+00:00:00', 'Pig', '2022-06-22 17:30:22.13024+00:00:00', 'Recommend world involve war.', 'identifier assignment', 85, '024de5a3-96a6-4ba6-b5fb-848d09ed3284', 4, 17, 'Loan wan compare plastic.', DEFAULT, 'Fulfil recognise prince gain bishop.', 'Racer 5 India Pale Ale, Bear Republic Bre', 'CareSet Systems') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.133328+00:00:00', '2022-06-22 17:30:22.133344+00:00:00', 'md5', '2022-06-22 17:30:22.133328+00:00:00', '4e4fcac3d8ff457fb64068c73a0efcac', 85) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.133341+00:00:00', '2022-06-22 17:30:22.134736+00:00:00', 'sha256', '2022-06-22 17:30:22.133341+00:00:00', '12eeb01080574869af57cdb6804db5fb', 85) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 85, 'http://www.leadrelationships.name/roi/cultivate') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 85, 'https://www.seniorchannels.biz/initiatives/global/portals/synergies') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:22.139025+00:00:00', '2022-06-22 17:30:22.139294+00:00:00', 'reptiles', 2963604144871788413, 'test.edu/Brownstrength/data/articleburst53.ini', 17, 'A', '2022-02-22 17:30:22.139025+00:00:00', 4, 'Standard', '0ab6f40b-a188-4253-a850-1c9d6fb09984') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.140482+00:00:00', '2022-06-22 17:30:22.14052+00:00:00', 'Sheep', '2022-06-22 17:30:22.140482+00:00:00', 'Press learn comment express.', 'ingestion', 86, 'fb99ce84-c7b0-4273-b7de-ae51c9f5b1ed', 4, 17, 'Fix search kingdom form.', DEFAULT, 'Compete make learn rise indicate.', 'Chimay Grande Réserve', 'Albertha Hintz') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.140507+00:00:00', '2022-06-22 17:30:22.142015+00:00:00', 'Duck', '2022-06-22 17:30:22.140507+00:00:00', 'Aim tom have measure.', 'identifier assignment', 86, 'a54606dc-86e7-4499-9796-771800489b57', 4, 17, 'Version offer monitor ability.', DEFAULT, 'Deserve score establish rise appeal.', 'Founders Kentucky Breakfast', 'United Mayflower') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.143625+00:00:00', '2022-06-22 17:30:22.143689+00:00:00', 'md5', '2022-06-22 17:30:22.143625+00:00:00', '1ebb64b33ee44c36899004c1d6434061', 86) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.143681+00:00:00', '2022-06-22 17:30:22.148081+00:00:00', 'sha256', '2022-06-22 17:30:22.143681+00:00:00', '4bf531b2d63a47b7a3b1b2873d09c01b', 86) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 86, 'http://www.futureholistic.info/initiatives/robust/e-tailers/rich') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 86, 'http://www.dynamicmorph.io/orchestrate/global/incubate') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:22.152496+00:00:00', '2022-06-22 17:30:22.152743+00:00:00', 'reptiles', 6524701669925052596, 'test.edu/Brownstrength/data/partyensure214.jar', 17, 'A', '2022-02-22 17:30:22.152496+00:00:00', 4, 'Standard', '80fa7576-2f59-4aa6-84a3-3974fab6a415') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.15427+00:00:00', '2022-06-22 17:30:22.154314+00:00:00', 'Chicken', '2022-06-22 17:30:22.15427+00:00:00', 'Seek st set history.', 'ingestion', 87, '9daa6353-f039-45ad-ba76-8f2d57ee754b', 4, 17, 'Gentleman eye overcome report.', DEFAULT, 'Damage incident perform county arrange.', 'Brooklyn Black', 'Russell Investments') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.1543+00:00:00', '2022-06-22 17:30:22.155921+00:00:00', 'Cow', '2022-06-22 17:30:22.1543+00:00:00', 'Record land lewis avoid.', 'identifier assignment', 87, 'b645c19f-fcdd-4671-8a3c-fb6e9bf5aef9', 4, 17, 'Climb manage prepare school.', DEFAULT, 'Fall permit knock fear exhibition.', 'Brooklyn Black', 'Galorath Incorporated') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.15751+00:00:00', '2022-06-22 17:30:22.157531+00:00:00', 'md5', '2022-06-22 17:30:22.15751+00:00:00', '1d70450b175849b89b80ecb1b5278547', 87) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:22.157527+00:00:00', '2022-06-22 17:30:22.159023+00:00:00', 'sha256', '2022-06-22 17:30:22.157527+00:00:00', '1b4c12d4195146e6b27d5d76ae3a5639', 87) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 87, 'https://www.globalstrategize.org/leading-edge/killer/methodologies') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 87, 'http://www.legacyincentivize.name/rich/scale') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.164326+00:00:00', '2022-06-22 17:30:22.164371+00:00:00', 'Chicken', '2022-06-22 17:30:22.164326+00:00:00', 'Complain expand apply club.', 'ingestion', DEFAULT, 'd57f83c3-176f-4dfb-b2f8-7eb5ee6ef8c9', 4, 17, 'Begin church friend experience.', DEFAULT, 'Care come wish miss sight.', 'Storm King Stout', 'Deron Stokes') RETURNING \"id\", \"generic_file_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.164362+00:00:00', '2022-06-22 17:30:22.165523+00:00:00', 'Sheep', '2022-06-22 17:30:22.164362+00:00:00', 'Hope adopt select sleep.', 'identifier assignment', DEFAULT, '4422bed7-db19-48ee-a71c-5deee1393eeb', 4, 17, 'Fear value face research.', DEFAULT, 'Mind democracy accommodate labour understand.', 'Double Bastard Ale', 'Viva Marvin') RETURNING \"id\", \"generic_file_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:22.167562+00:00:00', '2022-06-22 17:30:22.167575+00:00:00', 'auxiliary.tar', 'ab63e1e1968c4870ab55ba4e9e719f42', 4, 17, 83, 'blah.receiving.blah', 'someone@example.com', 'This item was created by the factory', 'Delete', 'Requested', 'Pending', 'Outcome? WTF?', '2022-02-22 17:30:22.167562+00:00:00', '2022-06-22 17:30:22.167562+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, '2022-06-22 17:30:22.167562+00:00:00', 1373261478682200303, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"node\", \"pid\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:22.169787+00:00:00', '2022-06-22 17:30:22.169798+00:00:00', 'auxiliary.tar', 'c929824c483b45e5af329e23989c494a', 4, 17, DEFAULT, 'blah.receiving.blah', 'someone@example.com', 'This item was created by the factory', 'Delete', 'Requested', 'Pending', 'Outcome? WTF?', '2022-02-22 17:30:22.169787+00:00:00', '2022-06-22 17:30:22.169787+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, '2022-06-22 17:30:22.169787+00:00:00', 3276430494841056985, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"generic_file_id\", \"node\", \"pid\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2022-06-22 17:30:22.169787+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.172009+00:00:00', \"name\" = 'auxiliary.tar', \"etag\" = 'c929824c483b45e5af329e23989c494a', \"institution_id\" = 4, \"intellectual_object_id\" = 17, \"generic_file_id\" = NULL, \"bucket\" = 'blah.receiving.blah', \"user\" = 'someone@example.com', \"note\" = 'This item was created by the factory', \"action\" = 'Delete', \"stage\" = 'Requested', \"status\" = 'Started', \"outcome\" = 'Outcome? WTF?', \"bag_date\" = '2022-02-22 17:30:22.169787+00:00:00', \"date_processed\" = '2022-06-22 17:30:22.169787+00:00:00', \"retry\" = TRUE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = '2022-06-22 17:30:22.169787+00:00:00', \"size\" = 3276430494841056985, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = NULL WHERE \"work_item\".\"id\" = 34"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 99999999999) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 9))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"deletion_requests\" (\"id\", \"institution_id\", \"requested_by_id\", \"requested_at\", \"encrypted_confirmation_token\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\") VALUES (DEFAULT, 4, 9, '2022-06-22 16:30:22.181648+00:00:00', '$2a$10$ps3xpMZymn96N8740D.Ex.TBb7hhUxiPnordhdq56upY62QFQWlBG', DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (4, 17) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"deletion_requests\" AS \"deletion_request\" SET \"institution_id\" = 4, \"requested_by_id\" = 9, \"requested_at\" = '2022-06-22 16:30:22.181648+00:00:00', \"encrypted_confirmation_token\" = '$2a$10$ps3xpMZymn96N8740D.Ex.TBb7hhUxiPnordhdq56upY62QFQWlBG', \"confirmed_by_id\" = NULL, \"confirmed_at\" = NULL, \"cancelled_by_id\" = NULL, \"cancelled_at\" = NULL, \"work_item_id\" = 34 WHERE \"deletion_request\".\"id\" = 4"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (4, 17) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 34) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 17 and state = 'A') LIMIT 1"}
{"level":"error","time":"2022-06-22T13:30:22-04:00","message":"Deletion precondition check failed for object 17 (test.edu/Brownstrength): cannot delete object with active files"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"generic_files\" AS \"generic_file\" SET \"created_at\" = '2022-06-22 17:30:22.111489+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.263535+00:00:00', \"file_format\" = 'mammals', \"size\" = 2637628464214655251, \"identifier\" = 'test.edu/Brownstrength/data/dramarecommend815.deskthemepack', \"intellectual_object_id\" = 17, \"state\" = 'D', \"last_fixity_check\" = '2022-02-22 17:30:22.111489+00:00:00', \"institution_id\" = 4, \"storage_option\" = 'Standard', \"uuid\" = 'cf87e37f-00d8-4926-9163-b461c92ae7b3' WHERE \"generic_file\".\"id\" = 83"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"generic_files\" AS \"generic_file\" SET \"created_at\" = '2022-06-22 17:30:22.120413+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.264812+00:00:00', \"file_format\" = 'amphibians', \"size\" = 8287903916094194288, \"identifier\" = 'test.edu/Brownstrength/data/computerdrink103.tiff', \"intellectual_object_id\" = 17, \"state\" = 'D', \"last_fixity_check\" = '2022-02-22 17:30:22.120413+00:00:00', \"institution_id\" = 4, \"storage_option\" = 'Standard', \"uuid\" = 'cf6a5dda-8fec-4240-9e37-362e137a3643' WHERE \"generic_file\".\"id\" = 84"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"generic_files\" AS \"generic_file\" SET \"created_at\" = '2022-06-22 17:30:22.128977+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.266079+00:00:00', \"file_format\" = 'amphibians', \"size\" = 5283524861893823505, \"identifier\" = 'test.edu/Brownstrength/data/gapcontinue384.kmz', \"intellectual_object_id\" = 17, \"state\" = 'D', \"last_fixity_check\" = '2022-02-22 17:30:22.128977+00:00:00', \"institution_id\" = 4, \"storage_option\" = 'Standard', \"uuid\" = '8170a205-22b3-4763-87a1-f46ae5a169cf' WHERE \"generic_file\".\"id\" = 85"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"generic_files\" AS \"generic_file\" SET \"created_at\" = '2022-06-22 17:30:22.139025+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.267285+00:00:00', \"file_format\" = 'reptiles', \"size\" = 2963604144871788413, \"identifier\" = 'test.edu/Brownstrength/data/articleburst53.ini', \"intellectual_object_id\" = 17, \"state\" = 'D', \"last_fixity_check\" = '2022-02-22 17:30:22.139025+00:00:00', \"institution_id\" = 4, \"storage_option\" = 'Standard', \"uuid\" = '0ab6f40b-a188-4253-a850-1c9d6fb09984' WHERE \"generic_file\".\"id\" = 86"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"generic_files\" AS \"generic_file\" SET \"created_at\" = '2022-06-22 17:30:22.152496+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.268374+00:00:00', \"file_format\" = 'reptiles', \"size\" = 6524701669925052596, \"identifier\" = 'test.edu/Brownstrength/data/partyensure214.jar', \"intellectual_object_id\" = 17, \"state\" = 'D', \"last_fixity_check\" = '2022-02-22 17:30:22.152496+00:00:00', \"institution_id\" = 4, \"storage_option\" = 'Standard', \"uuid\" = '80fa7576-2f59-4aa6-84a3-3974fab6a415' WHERE \"generic_file\".\"id\" = 87"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"intellectual_objects\" AS \"intellectual_object\" SET \"created_at\" = '2022-06-22 17:30:22.10996+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.269331+00:00:00', \"title\" = 'virtual context-sensitive incentivize', \"description\" = 'We need to back up the optical SSL microchip!', \"identifier\" = 'test.edu/Brownstrength', \"alt_identifier\" = 'Duck', \"access\" = 'institution', \"bag_name\" = 'auxiliary.tar', \"institution_id\" = 4, \"state\" = 'D', \"etag\" = 'd2a72cc9464149acafbb73e0dc544c65', \"bag_group_identifier\" = 'individual', \"storage_option\" = 'Standard', \"bagit_profile_identifier\" = 'https://example.com/profile.json', \"source_organization\" = 'Test University', \"internal_sender_identifier\" = 'Chalupa', \"internal_sender_description\" = 'Kickstarter yr humblebrag swag mixtape echo tattooed chicharrones hella ramps freegan blog.' WHERE \"intellectual_object\".\"id\" = 17"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 17 and state = 'A') LIMIT 1"}
{"level":"error","time":"2022-06-22T13:30:22-04:00","message":"Deletion precondition check failed for object 17 (test.edu/Brownstrength): Object is already in deleted state"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"intellectual_objects\" AS \"intellectual_object\" SET \"created_at\" = '2022-06-22 17:30:22.10996+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.270906+00:00:00', \"title\" = 'virtual context-sensitive incentivize', \"description\" = 'We need to back up the optical SSL microchip!', \"identifier\" = 'test.edu/Brownstrength', \"alt_identifier\" = 'Duck', \"access\" = 'institution', \"bag_name\" = 'auxiliary.tar', \"institution_id\" = 4, \"state\" = 'A', \"etag\" = 'd2a72cc9464149acafbb73e0dc544c65', \"bag_group_identifier\" = 'individual', \"storage_option\" = 'Standard', \"bagit_profile_identifier\" = 'https://example.com/profile.json', \"source_organization\" = 'Test University', \"internal_sender_identifier\" = 'Chalupa', \"internal_sender_description\" = 'Kickstarter yr humblebrag swag mixtape echo tattooed chicharrones hella ramps freegan blog.' WHERE \"intellectual_object\".\"id\" = 17"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:22.271933+00:00:00', '2022-06-22 17:30:22.271952+00:00:00', 'auxiliary.tar', 'ad5832bb209a44638518a2300ee8bc4a', 4, 17, DEFAULT, 'blah.receiving.blah', 'someone@example.com', 'This item was created by the factory', 'Delete', 'Requested', 'Started', 'Outcome? WTF?', '2022-02-22 17:30:22.271933+00:00:00', '2022-06-22 17:30:22.271933+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, '2022-06-22 17:30:22.271933+00:00:00', 8342568312288123630, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"generic_file_id\", \"node\", \"pid\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 17 and state = 'A') LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'ingestion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'deletion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"error","time":"2022-06-22T13:30:22-04:00","message":"Deletion precondition check failed for object 17 (test.edu/Brownstrength): Deletion work item is missing institutional approver"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2022-06-22 17:30:22.271933+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.275076+00:00:00', \"name\" = 'auxiliary.tar', \"etag\" = 'ad5832bb209a44638518a2300ee8bc4a', \"institution_id\" = 4, \"intellectual_object_id\" = 17, \"generic_file_id\" = NULL, \"bucket\" = 'blah.receiving.blah', \"user\" = 'someone@example.com', \"note\" = 'This item was created by the factory', \"action\" = 'Delete', \"stage\" = 'Requested', \"status\" = 'Started', \"outcome\" = 'Outcome? WTF?', \"bag_date\" = '2022-02-22 17:30:22.271933+00:00:00', \"date_processed\" = '2022-06-22 17:30:22.271933+00:00:00', \"retry\" = TRUE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = '2022-06-22 17:30:22.271933+00:00:00', \"size\" = 8342568312288123630, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = 'someone@example.com' WHERE \"work_item\".\"id\" = 35"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 17 and state = 'A') LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'ingestion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'deletion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 35) AND (object_count > 0) AND (file_count = 0))"}
{"level":"error","time":"2022-06-22T13:30:22-04:00","message":"Deletion precondition check failed for object 17 (test.edu/Brownstrength): No deletion request for work item 35"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 9))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"deletion_requests\" (\"id\", \"institution_id\", \"requested_by_id\", \"requested_at\", \"encrypted_confirmation_token\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\") VALUES (DEFAULT, 4, 9, '2022-06-22 16:30:22.282083+00:00:00', '$2a$10$7Go18plMJgn4ZHUFVnWhlO189r1t9ewb09qomrauYG1weVhi3LYq2', DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (5, 17) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"deletion_requests\" AS \"deletion_request\" SET \"institution_id\" = 4, \"requested_by_id\" = 9, \"requested_at\" = '2022-06-22 16:30:22.282083+00:00:00', \"encrypted_confirmation_token\" = '$2a$10$7Go18plMJgn4ZHUFVnWhlO189r1t9ewb09qomrauYG1weVhi3LYq2', \"confirmed_by_id\" = NULL, \"confirmed_at\" = NULL, \"cancelled_by_id\" = NULL, \"cancelled_at\" = NULL, \"work_item_id\" = 35 WHERE \"deletion_request\".\"id\" = 5"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (5, 17) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 17 and state = 'A') LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'ingestion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'deletion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 35) AND (object_count > 0) AND (file_count = 0))"}
{"level":"error","time":"2022-06-22T13:30:22-04:00","message":"Deletion precondition check failed for object 17 (test.edu/Brownstrength): Deletion request 5 has no approver"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@test.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 8))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"deletion_requests\" AS \"deletion_request\" SET \"institution_id\" = 4, \"requested_by_id\" = 9, \"requested_at\" = '2022-06-22 16:30:22.282083+00:00:00', \"encrypted_confirmation_token\" = '$2a$10$7Go18plMJgn4ZHUFVnWhlO189r1t9ewb09qomrauYG1weVhi3LYq2', \"confirmed_by_id\" = 8, \"confirmed_at\" = '2022-06-22 17:30:22.366854+00:00:00', \"cancelled_by_id\" = NULL, \"cancelled_at\" = NULL, \"work_item_id\" = 35 WHERE \"deletion_request\".\"id\" = 5"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (5, 17) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 17 and state = 'A') LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'ingestion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'deletion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 35) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT 1 FROM \"generic_files\" AS \"generic_file\" WHERE (intellectual_object_id = 17 and state = 'A') LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'ingestion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'deletion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 35) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 17) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 35) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: UPDATE \"intellectual_objects\" AS \"intellectual_object\" SET \"created_at\" = '2022-06-22 17:30:22.10996+00:00:00', \"updated_at\" = '2022-06-22 17:30:22.380877+00:00:00', \"title\" = 'virtual context-sensitive incentivize', \"description\" = 'We need to back up the optical SSL microchip!', \"identifier\" = 'test.edu/Brownstrength', \"alt_identifier\" = 'Duck', \"access\" = 'institution', \"bag_name\" = 'auxiliary.tar', \"institution_id\" = 4, \"state\" = 'D', \"etag\" = 'd2a72cc9464149acafbb73e0dc544c65', \"bag_group_identifier\" = 'individual', \"storage_option\" = 'Standard', \"bagit_profile_identifier\" = 'https://example.com/profile.json', \"source_organization\" = 'Test University', \"internal_sender_identifier\" = 'Chalupa', \"internal_sender_description\" = 'Kickstarter yr humblebrag swag mixtape echo tattooed chicharrones hella ramps freegan blog.' WHERE \"intellectual_object\".\"id\" = 17"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:22.384252+00:00:00', '2022-06-22 17:30:22.384252+00:00:00', 'APTrust preservation services', '2022-06-22 17:30:22.38423+00:00:00', 'Object deleted from preservation storage', 'deletion', DEFAULT, 'cde3c4c0-ed33-4224-bc33-d372f27fe236', 4, 17, 'Minio S3 library', DEFAULT, 'Success', 'user@test.edu', 'Object deleted at the request of user@test.edu. Institutional approver: admin@test.edu.') RETURNING \"id\", \"generic_file_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 17))"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((intellectual_object_id = 17) AND (event_type = 'deletion') AND (generic_file_id is null)) ORDER BY \"created_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:22-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: select update_counts();"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"intellectual_objects\" (\"id\", \"created_at\", \"updated_at\", \"title\", \"description\", \"identifier\", \"alt_identifier\", \"access\", \"bag_name\", \"institution_id\", \"state\", \"etag\", \"bag_group_identifier\", \"storage_option\", \"bagit_profile_identifier\", \"source_organization\", \"internal_sender_identifier\", \"internal_sender_description\") VALUES (DEFAULT, '2022-06-22 17:30:23.119824+00:00:00', '2022-06-22 17:30:23.119824+00:00:00', 'wireless encompassing utilize', 'I''ll input the open-source ADP bandwidth, that should parse the XSS system!', 'test.edu/Moosecomply', 'Chicken', 'institution', 'haptic.tar', 4, 'A', 'a6cb65d131724c699e11cd3a824ce735', 'failure', 'Standard', 'https://example.com/profile.json', 'Test University', 'Kareem Abdul Ja-Bark', 'Truffaut austin pop-up forage ethical deep v keytar pour-over pour-over food truck artisan tattooed.') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:23.121287+00:00:00', '2022-06-22 17:30:23.121552+00:00:00', 'mammals', 7005207772210248718, 'test.edu/Moosecomply/data/thatcherguess728.sav', 15, 'A', '2022-02-22 17:30:23.121287+00:00:00', 4, 'Standard', '9a560154-f21c-4a06-a72c-c33634c07245') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.122805+00:00:00', '2022-06-22 17:30:23.122832+00:00:00', 'Duck', '2022-06-22 17:30:23.122805+00:00:00', 'Source item intention carry.', 'ingestion', 63, '965aab0c-a597-4d87-8083-df2e1c0fd29f', 4, 15, 'Teach enhance present title.', DEFAULT, 'Pull implement stretch challenge drama.', 'Arrogant Bastard Ale', 'Murl Wunsch') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.122824+00:00:00', '2022-06-22 17:30:23.124374+00:00:00', 'Duck', '2022-06-22 17:30:23.122824+00:00:00', 'Pay view describe conduct.', 'identifier assignment', 63, '82c8134c-1332-4ec6-9727-0bfa5dd35d76', 4, 15, 'Payment limit problem transfer.', DEFAULT, 'Passage community brown television invest.', 'St. Bernardus Abt 12', 'Qado Energy, Inc.') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.12564+00:00:00', '2022-06-22 17:30:23.125653+00:00:00', 'md5', '2022-06-22 17:30:23.12564+00:00:00', 'bb38541fdda543d4983323a70489942c', 63) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.125651+00:00:00', '2022-06-22 17:30:23.127892+00:00:00', 'sha256', '2022-06-22 17:30:23.125651+00:00:00', 'bb8183b5cb5a4597a995eb74fe4d2c7f', 63) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'http://www.futureengineer.info/reintermediate/architectures') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 63, 'http://www.legacycultivate.info/user-centric/methodologies') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:23.133003+00:00:00', '2022-06-22 17:30:23.133322+00:00:00', 'fish', 5595422464860976504, 'test.edu/Moosecomply/data/houseexcuse508.srt', 15, 'A', '2022-02-22 17:30:23.133003+00:00:00', 4, 'Standard', '7911ce88-9e28-4f90-92af-bd5e47707212') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.134562+00:00:00', '2022-06-22 17:30:23.134604+00:00:00', 'Duck', '2022-06-22 17:30:23.134562+00:00:00', 'Eye lead supply feature.', 'ingestion', 64, '13ec3a9a-338c-4289-b105-8f60de74987a', 4, 15, 'Head choose assistance cry.', DEFAULT, 'Respect administration insist condition difference.', 'Hop Rod Rye', 'Gilberto Dickinson') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.134592+00:00:00', '2022-06-22 17:30:23.136273+00:00:00', 'Donkey', '2022-06-22 17:30:23.134592+00:00:00', 'Debt aircraft definition shock.', 'identifier assignment', 64, 'a641aef8-b990-476d-b295-5363841e3069', 4, 15, 'Man destroy iron economy.', DEFAULT, 'Dog use lewis length shop.', 'Old Rasputin Russian Imperial Stout', 'Fidelity Investments') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.137461+00:00:00', '2022-06-22 17:30:23.137473+00:00:00', 'md5', '2022-06-22 17:30:23.137461+00:00:00', '68e98aaca609439e80edf80d0fdd87a3', 64) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.137471+00:00:00', '2022-06-22 17:30:23.138797+00:00:00', 'sha256', '2022-06-22 17:30:23.137471+00:00:00', '64eb12667dcc417289c6ca1523b6217c', 64) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'http://www.customerarchitectures.biz/portals/convergence/e-tailers/intuitive') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 64, 'https://www.chiefend-to-end.info/integrate') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:23.142885+00:00:00', '2022-06-22 17:30:23.143115+00:00:00', 'mammals', 4594664218864502562, 'test.edu/Moosecomply/data/rugbyaddress105.sitx', 15, 'A', '2022-02-22 17:30:23.142885+00:00:00', 4, 'Standard', '93b41f52-b560-4877-a5cc-376c31cad02b') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.144655+00:00:00', '2022-06-22 17:30:23.144698+00:00:00', 'Sheep', '2022-06-22 17:30:23.144655+00:00:00', 'Bear recognize growth arrange.', 'ingestion', 65, 'a7fddb2e-a74a-40db-bcb0-964caf98720d', 4, 15, 'Predict support mike pretend.', DEFAULT, 'Heat framework sustain prison place.', 'Duvel', 'Colleen Morissette') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.144685+00:00:00', '2022-06-22 17:30:23.146496+00:00:00', 'Turkey', '2022-06-22 17:30:23.144685+00:00:00', 'Commit march resolve fire.', 'identifier assignment', 65, '21584e64-5b16-4698-b9e9-c59ca5af386b', 4, 15, 'Expansion deliver burst loss.', DEFAULT, 'Read grant bread recognise border.', 'Hennepin', 'KPMG') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.148113+00:00:00', '2022-06-22 17:30:23.148137+00:00:00', 'md5', '2022-06-22 17:30:23.148113+00:00:00', 'd96656d84634432d905da342fe7cd580', 65) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.148129+00:00:00', '2022-06-22 17:30:23.150024+00:00:00', 'sha256', '2022-06-22 17:30:23.148129+00:00:00', 'a7034bd863d7456b954a651e9db14b6e', 65) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'https://www.futuresolutions.net/redefine/methodologies/enhance/seamless') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 65, 'http://www.leadkiller.org/transition') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:23.155613+00:00:00', '2022-06-22 17:30:23.155876+00:00:00', 'invertebrates', 5087155032599911225, 'test.edu/Moosecomply/data/nameleave230.js', 15, 'A', '2022-02-22 17:30:23.155613+00:00:00', 4, 'Standard', '83d6a14b-bf60-422b-952f-514a0eeffb9e') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.157126+00:00:00', '2022-06-22 17:30:23.157164+00:00:00', 'Horse', '2022-06-22 17:30:23.157126+00:00:00', 'Protect skin district argue.', 'ingestion', 66, '2ef04f6b-f614-442d-aa8e-bc6313fa4e9c', 4, 15, 'Dinner telephone inquiry collection.', DEFAULT, 'Shoulder violence find possess bear.', 'Chocolate St', 'Justina Roberts') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.157151+00:00:00', '2022-06-22 17:30:23.158896+00:00:00', 'Pig', '2022-06-22 17:30:23.157151+00:00:00', 'Sleep recall shop should.', 'identifier assignment', 66, '26668338-5763-450e-8e80-b009c65b12b9', 4, 15, 'Speak complain countryside raise.', DEFAULT, 'Pull divide result wine stay.', 'Schneider Aventinus', 'Eli Upton') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.160378+00:00:00', '2022-06-22 17:30:23.160397+00:00:00', 'md5', '2022-06-22 17:30:23.160378+00:00:00', '6772dad8755a4e8eb0f2f09e3225fca4', 66) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.160394+00:00:00', '2022-06-22 17:30:23.161675+00:00:00', 'sha256', '2022-06-22 17:30:23.160394+00:00:00', 'b10d26251e324857b5791e87d2137e6d', 66) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'http://www.directsynergize.io/synergistic/seamless/b2b/extensible') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 66, 'https://www.dynamicsynthesize.name/incubate/vortals/reinvent') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"generic_files\" (\"id\", \"created_at\", \"updated_at\", \"file_format\", \"size\", \"identifier\", \"intellectual_object_id\", \"state\", \"last_fixity_check\", \"institution_id\", \"storage_option\", \"uuid\") VALUES (DEFAULT, '2022-06-22 17:30:23.165844+00:00:00', '2022-06-22 17:30:23.166067+00:00:00', 'reptiles', 8926940472630993578, 'test.edu/Moosecomply/data/eventcry55.accdb', 15, 'A', '2022-02-22 17:30:23.165844+00:00:00', 4, 'Standard', 'ef699b70-3263-4e9d-89af-13c81e72acda') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.16708+00:00:00', '2022-06-22 17:30:23.167115+00:00:00', 'Cow', '2022-06-22 17:30:23.16708+00:00:00', 'Empire key let''s writer.', 'ingestion', 67, 'd566e545-fcdd-4b30-a4f9-648be2ac024d', 4, 15, 'Finance sun prove remove.', DEFAULT, 'Fear republic representation must screen.', 'Orval Trappist Ale', 'WeMakeItSafer') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.167098+00:00:00', '2022-06-22 17:30:23.168336+00:00:00', 'Goat', '2022-06-22 17:30:23.167098+00:00:00', 'Class programme office name.', 'identifier assignment', 67, '86db5ef4-7523-40a2-8374-679219f8a911', 4, 15, 'Journey focus pension contain.', DEFAULT, 'Passage document lend release forget.', 'La Fin Du Monde', 'PolicyMap') RETURNING \"id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.169556+00:00:00', '2022-06-22 17:30:23.169579+00:00:00', 'md5', '2022-06-22 17:30:23.169556+00:00:00', 'f8bc009f1a3d4354abaacefe3e88d4e4', 67) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"checksums\" (\"id\", \"created_at\", \"updated_at\", \"algorithm\", \"datetime\", \"digest\", \"generic_file_id\") VALUES (DEFAULT, '2022-06-22 17:30:23.169576+00:00:00', '2022-06-22 17:30:23.170679+00:00:00', 'sha256', '2022-06-22 17:30:23.169576+00:00:00', '232c3220a2d0434e9003fff600cb25ea', 67) RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'http://www.principalleading-edge.com/front-end/whiteboard') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 67, 'http://www.regionalgenerate.net/matrix') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.173493+00:00:00', '2022-06-22 17:30:23.173526+00:00:00', 'Horse', '2022-06-22 17:30:23.173493+00:00:00', 'Impose fight react attend.', 'ingestion', DEFAULT, '6653e6f3-524e-4acf-a9d9-7a5aa568ae80', 4, 15, 'Report owe review design.', DEFAULT, 'Pension basis differ decision show.', 'Bourbon County Stout', 'Abdullah Schowalter') RETURNING \"id\", \"generic_file_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:23.173516+00:00:00', '2022-06-22 17:30:23.1745+00:00:00', 'Turkey', '2022-06-22 17:30:23.173516+00:00:00', 'Arrive goal alternative company.', 'identifier assignment', DEFAULT, '2a7ad6ce-c2eb-4a0d-afb2-4bc71c068ba3', 4, 15, 'Jump consider question holiday.', DEFAULT, 'Grant impression line would hate.', 'Alpha King Pale Ale', 'Jesus Stiedemann') RETURNING \"id\", \"generic_file_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 15) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:23.176174+00:00:00', '2022-06-22 17:30:23.176189+00:00:00', 'haptic.tar', '0eb5b5de527c47a58bd5e345ac3116db', 4, 15, DEFAULT, 'blah.receiving.blah', 'someone@example.com', 'This item was created by the factory', 'Delete', 'Requested', 'Started', 'Outcome? WTF?', '2022-02-22 17:30:23.176174+00:00:00', '2022-06-22 17:30:23.176174+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, '2022-06-22 17:30:23.176174+00:00:00', 8783222521891610345, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"generic_file_id\", \"node\", \"pid\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 15) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2022-06-22 17:30:23.176174+00:00:00', \"updated_at\" = '2022-06-22 17:30:23.179624+00:00:00', \"name\" = 'haptic.tar', \"etag\" = '0eb5b5de527c47a58bd5e345ac3116db', \"institution_id\" = 4, \"intellectual_object_id\" = 15, \"generic_file_id\" = NULL, \"bucket\" = 'blah.receiving.blah', \"user\" = 'someone@example.com', \"note\" = 'This item was created by the factory', \"action\" = 'Delete', \"stage\" = 'Requested', \"status\" = 'Started', \"outcome\" = 'Outcome? WTF?', \"bag_date\" = '2022-02-22 17:30:23.176174+00:00:00', \"date_processed\" = '2022-06-22 17:30:23.176174+00:00:00', \"retry\" = TRUE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = '2022-06-22 17:30:23.176174+00:00:00', \"size\" = 8783222521891610345, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = 'someone@example.com' WHERE \"work_item\".\"id\" = 33"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 15) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 9))"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: INSERT INTO \"deletion_requests\" (\"id\", \"institution_id\", \"requested_by_id\", \"requested_at\", \"encrypted_confirmation_token\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\") VALUES (DEFAULT, 4, 9, '2022-06-22 16:30:23.190783+00:00:00', '$2a$10$0F63g1UOeIZq3RRi873m1.j2JhMHrOBWfQnMLR59TYWXcdn5wFubO', DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"confirmed_by_id\", \"confirmed_at\", \"cancelled_by_id\", \"cancelled_at\", \"work_item_id\""}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (4, 15) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: UPDATE \"deletion_requests\" AS \"deletion_request\" SET \"institution_id\" = 4, \"requested_by_id\" = 9, \"requested_at\" = '2022-06-22 16:30:23.190783+00:00:00', \"encrypted_confirmation_token\" = '$2a$10$0F63g1UOeIZq3RRi873m1.j2JhMHrOBWfQnMLR59TYWXcdn5wFubO', \"confirmed_by_id\" = NULL, \"confirmed_at\" = NULL, \"cancelled_by_id\" = NULL, \"cancelled_at\" = NULL, \"work_item_id\" = 33 WHERE \"deletion_request\".\"id\" = 4"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (4, 15) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 15) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@test.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 8))"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: UPDATE \"deletion_requests\" AS \"deletion_request\" SET \"institution_id\" = 4, \"requested_by_id\" = 9, \"requested_at\" = '2022-06-22 16:30:23.190783+00:00:00', \"encrypted_confirmation_token\" = '$2a$10$0F63g1UOeIZq3RRi873m1.j2JhMHrOBWfQnMLR59TYWXcdn5wFubO', \"confirmed_by_id\" = 8, \"confirmed_at\" = '2022-06-22 17:30:23.273076+00:00:00', \"cancelled_by_id\" = NULL, \"cancelled_at\" = NULL, \"work_item_id\" = 33 WHERE \"deletion_request\".\"id\" = 4"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: insert into deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id) values (4, 15) on conflict do nothing"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 15) AND (generic_file_id is null) AND (action = 'Delete') AND (status = 'Started')) ORDER BY \"updated_at\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((work_item_id = 33) AND (object_count > 0) AND (file_count = 0))"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((id = 4))"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:23-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: select update_counts();"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((\"intellectual_object_view\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((\"intellectual_object_view\".\"identifier\" = 'institution1.edu/photos'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((state = 'A')) ORDER BY \"created_at\" asc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"generic_file\".\"institution_id\" AS \"generic_file__institution_id\" FROM \"checksums\" AS \"checksum\" LEFT JOIN \"generic_files\" AS \"generic_file\" ON \"generic_file\".\"id\" = \"checksum\".\"generic_file_id\" WHERE (\"checksum\".\"id\" = 8)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"generic_files\" AS \"generic_file\" WHERE (id = 5)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE (id = 6)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"premis_events\" AS \"premis_event\" WHERE (id = 8)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"generic_file\".\"institution_id\" AS \"generic_file__institution_id\" FROM \"storage_records\" AS \"storage_record\" LEFT JOIN \"generic_files\" AS \"generic_file\" ON \"generic_file\".\"id\" = \"storage_record\".\"generic_file_id\" WHERE (\"storage_record\".\"id\" = 8)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"users\" AS \"user\" WHERE (id = 4)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"work_items\" AS \"work_item\" WHERE (id = 4)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"work_items\" AS \"work_item\" WHERE (id = -100)"}
{"level":"error","time":"2022-06-22T13:30:24-04:00","message":"pgmodels.InstIDFor got unknown type 'UnknownType'"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"alert\".\"id\", \"alert\".\"institution_id\", \"alert\".\"type\", \"alert\".\"subject\", \"alert\".\"content\", \"alert\".\"deletion_request_id\", \"alert\".\"created_at\", \"deletion_request\".\"id\" AS \"deletion_request__id\", \"deletion_request\".\"institution_id\" AS \"deletion_request__institution_id\", \"deletion_request\".\"requested_by_id\" AS \"deletion_request__requested_by_id\", \"deletion_request\".\"requested_at\" AS \"deletion_request__requested_at\", \"deletion_request\".\"encrypted_confirmation_token\" AS \"deletion_request__encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\" AS \"deletion_request__confirmed_by_id\", \"deletion_request\".\"confirmed_at\" AS \"deletion_request__confirmed_at\", \"deletion_request\".\"cancelled_by_id\" AS \"deletion_request__cancelled_by_id\", \"deletion_request\".\"cancelled_at\" AS \"deletion_request__cancelled_at\", \"deletion_request\".\"work_item_id\" AS \"deletion_request__work_item_id\" FROM \"alerts\" AS \"alert\" LEFT JOIN \"deletion_requests\" AS \"deletion_request\" ON \"deletion_request\".\"id\" = \"alert\".\"deletion_request_id\" WHERE ((\"alert\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"alerts_premis_events\".*, \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" JOIN \"alerts_premis_events\" AS \"alerts_premis_events\" ON (\"alerts_premis_events\".\"alert_id\") IN (1) WHERE (\"premis_event\".\"id\" = \"alerts_premis_events\".\"premis_event_id\")"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"alerts_users\".*, \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\" FROM \"users\" AS \"user\" JOIN \"alerts_users\" AS \"alerts_users\" ON (\"alerts_users\".\"alert_id\") IN (1) WHERE (\"user\".\"id\" = \"alerts_users\".\"user_id\")"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"alerts_work_items\".*, \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" JOIN \"alerts_work_items\" AS \"alerts_work_items\" ON (\"alerts_work_items\".\"alert_id\") IN (1) WHERE (\"work_item\".\"id\" = \"alerts_work_items\".\"work_item_id\")"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"alerts\" AS \"alert\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"deletion_request\".\"id\", \"deletion_request\".\"institution_id\", \"deletion_request\".\"requested_by_id\", \"deletion_request\".\"requested_at\", \"deletion_request\".\"encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\", \"deletion_request\".\"confirmed_at\", \"deletion_request\".\"cancelled_by_id\", \"deletion_request\".\"cancelled_at\", \"deletion_request\".\"work_item_id\", \"requested_by\".\"id\" AS \"requested_by__id\", \"requested_by\".\"created_at\" AS \"requested_by__created_at\", \"requested_by\".\"updated_at\" AS \"requested_by__updated_at\", \"requested_by\".\"name\" AS \"requested_by__name\", \"requested_by\".\"email\" AS \"requested_by__email\", \"requested_by\".\"phone_number\" AS \"requested_by__phone_number\", \"requested_by\".\"encrypted_password\" AS \"requested_by__encrypted_password\", \"requested_by\".\"reset_password_token\" AS \"requested_by__reset_password_token\", \"requested_by\".\"reset_password_sent_at\" AS \"requested_by__reset_password_sent_at\", \"requested_by\".\"remember_created_at\" AS \"requested_by__remember_created_at\", \"requested_by\".\"sign_in_count\" AS \"requested_by__sign_in_count\", \"requested_by\".\"current_sign_in_at\" AS \"requested_by__current_sign_in_at\", \"requested_by\".\"last_sign_in_at\" AS \"requested_by__last_sign_in_at\", \"requested_by\".\"current_sign_in_ip\" AS \"requested_by__current_sign_in_ip\", \"requested_by\".\"last_sign_in_ip\" AS \"requested_by__last_sign_in_ip\", \"requested_by\".\"institution_id\" AS \"requested_by__institution_id\", \"requested_by\".\"encrypted_api_secret_key\" AS \"requested_by__encrypted_api_secret_key\", \"requested_by\".\"password_changed_at\" AS \"requested_by__password_changed_at\", \"requested_by\".\"encrypted_otp_secret\" AS \"requested_by__encrypted_otp_secret\", \"requested_by\".\"encrypted_otp_secret_iv\" AS \"requested_by__encrypted_otp_secret_iv\", \"requested_by\".\"encrypted_otp_secret_salt\" AS \"requested_by__encrypted_otp_secret_salt\", \"requested_by\".\"encrypted_otp_sent_at\" AS \"requested_by__encrypted_otp_sent_at\", \"requested_by\".\"consumed_timestep\" AS \"requested_by__consumed_timestep\", \"requested_by\".\"otp_required_for_login\" AS \"requested_by__otp_required_for_login\", \"requested_by\".\"deactivated_at\" AS \"requested_by__deactivated_at\", \"requested_by\".\"enabled_two_factor\" AS \"requested_by__enabled_two_factor\", \"requested_by\".\"confirmed_two_factor\" AS \"requested_by__confirmed_two_factor\", \"requested_by\".\"otp_backup_codes\" AS \"requested_by__otp_backup_codes\", \"requested_by\".\"authy_id\" AS \"requested_by__authy_id\", \"requested_by\".\"last_sign_in_with_authy\" AS \"requested_by__last_sign_in_with_authy\", \"requested_by\".\"authy_status\" AS \"requested_by__authy_status\", \"requested_by\".\"email_verified\" AS \"requested_by__email_verified\", \"requested_by\".\"initial_password_updated\" AS \"requested_by__initial_password_updated\", \"requested_by\".\"force_password_update\" AS \"requested_by__force_password_update\", \"requested_by\".\"grace_period\" AS \"requested_by__grace_period\", \"requested_by\".\"awaiting_second_factor\" AS \"requested_by__awaiting_second_factor\", \"requested_by\".\"role\" AS \"requested_by__role\", \"confirmed_by\".\"id\" AS \"confirmed_by__id\", \"confirmed_by\".\"created_at\" AS \"confirmed_by__created_at\", \"confirmed_by\".\"updated_at\" AS \"confirmed_by__updated_at\", \"confirmed_by\".\"name\" AS \"confirmed_by__name\", \"confirmed_by\".\"email\" AS \"confirmed_by__email\", \"confirmed_by\".\"phone_number\" AS \"confirmed_by__phone_number\", \"confirmed_by\".\"encrypted_password\" AS \"confirmed_by__encrypted_password\", \"confirmed_by\".\"reset_password_token\" AS \"confirmed_by__reset_password_token\", \"confirmed_by\".\"reset_password_sent_at\" AS \"confirmed_by__reset_password_sent_at\", \"confirmed_by\".\"remember_created_at\" AS \"confirmed_by__remember_created_at\", \"confirmed_by\".\"sign_in_count\" AS \"confirmed_by__sign_in_count\", \"confirmed_by\".\"current_sign_in_at\" AS \"confirmed_by__current_sign_in_at\", \"confirmed_by\".\"last_sign_in_at\" AS \"confirmed_by__last_sign_in_at\", \"confirmed_by\".\"current_sign_in_ip\" AS \"confirmed_by__current_sign_in_ip\", \"confirmed_by\".\"last_sign_in_ip\" AS \"confirmed_by__last_sign_in_ip\", \"confirmed_by\".\"institution_id\" AS \"confirmed_by__institution_id\", \"confirmed_by\".\"encrypted_api_secret_key\" AS \"confirmed_by__encrypted_api_secret_key\", \"confirmed_by\".\"password_changed_at\" AS \"confirmed_by__password_changed_at\", \"confirmed_by\".\"encrypted_otp_secret\" AS \"confirmed_by__encrypted_otp_secret\", \"confirmed_by\".\"encrypted_otp_secret_iv\" AS \"confirmed_by__encrypted_otp_secret_iv\", \"confirmed_by\".\"encrypted_otp_secret_salt\" AS \"confirmed_by__encrypted_otp_secret_salt\", \"confirmed_by\".\"encrypted_otp_sent_at\" AS \"confirmed_by__encrypted_otp_sent_at\", \"confirmed_by\".\"consumed_timestep\" AS \"confirmed_by__consumed_timestep\", \"confirmed_by\".\"otp_required_for_login\" AS \"confirmed_by__otp_required_for_login\", \"confirmed_by\".\"deactivated_at\" AS \"confirmed_by__deactivated_at\", \"confirmed_by\".\"enabled_two_factor\" AS \"confirmed_by__enabled_two_factor\", \"confirmed_by\".\"confirmed_two_factor\" AS \"confirmed_by__confirmed_two_factor\", \"confirmed_by\".\"otp_backup_codes\" AS \"confirmed_by__otp_backup_codes\", \"confirmed_by\".\"authy_id\" AS \"confirmed_by__authy_id\", \"confirmed_by\".\"last_sign_in_with_authy\" AS \"confirmed_by__last_sign_in_with_authy\", \"confirmed_by\".\"authy_status\" AS \"confirmed_by__authy_status\", \"confirmed_by\".\"email_verified\" AS \"confirmed_by__email_verified\", \"confirmed_by\".\"initial_password_updated\" AS \"confirmed_by__initial_password_updated\", \"confirmed_by\".\"force_password_update\" AS \"confirmed_by__force_password_update\", \"confirmed_by\".\"grace_period\" AS \"confirmed_by__grace_period\", \"confirmed_by\".\"awaiting_second_factor\" AS \"confirmed_by__awaiting_second_factor\", \"confirmed_by\".\"role\" AS \"confirmed_by__role\", \"cancelled_by\".\"id\" AS \"cancelled_by__id\", \"cancelled_by\".\"created_at\" AS \"cancelled_by__created_at\", \"cancelled_by\".\"updated_at\" AS \"cancelled_by__updated_at\", \"cancelled_by\".\"name\" AS \"cancelled_by__name\", \"cancelled_by\".\"email\" AS \"cancelled_by__email\", \"cancelled_by\".\"phone_number\" AS \"cancelled_by__phone_number\", \"cancelled_by\".\"encrypted_password\" AS \"cancelled_by__encrypted_password\", \"cancelled_by\".\"reset_password_token\" AS \"cancelled_by__reset_password_token\", \"cancelled_by\".\"reset_password_sent_at\" AS \"cancelled_by__reset_password_sent_at\", \"cancelled_by\".\"remember_created_at\" AS \"cancelled_by__remember_created_at\", \"cancelled_by\".\"sign_in_count\" AS \"cancelled_by__sign_in_count\", \"cancelled_by\".\"current_sign_in_at\" AS \"cancelled_by__current_sign_in_at\", \"cancelled_by\".\"last_sign_in_at\" AS \"cancelled_by__last_sign_in_at\", \"cancelled_by\".\"current_sign_in_ip\" AS \"cancelled_by__current_sign_in_ip\", \"cancelled_by\".\"last_sign_in_ip\" AS \"cancelled_by__last_sign_in_ip\", \"cancelled_by\".\"institution_id\" AS \"cancelled_by__institution_id\", \"cancelled_by\".\"encrypted_api_secret_key\" AS \"cancelled_by__encrypted_api_secret_key\", \"cancelled_by\".\"password_changed_at\" AS \"cancelled_by__password_changed_at\", \"cancelled_by\".\"encrypted_otp_secret\" AS \"cancelled_by__encrypted_otp_secret\", \"cancelled_by\".\"encrypted_otp_secret_iv\" AS \"cancelled_by__encrypted_otp_secret_iv\", \"cancelled_by\".\"encrypted_otp_secret_salt\" AS \"cancelled_by__encrypted_otp_secret_salt\", \"cancelled_by\".\"encrypted_otp_sent_at\" AS \"cancelled_by__encrypted_otp_sent_at\", \"cancelled_by\".\"consumed_timestep\" AS \"cancelled_by__consumed_timestep\", \"cancelled_by\".\"otp_required_for_login\" AS \"cancelled_by__otp_required_for_login\", \"cancelled_by\".\"deactivated_at\" AS \"cancelled_by__deactivated_at\", \"cancelled_by\".\"enabled_two_factor\" AS \"cancelled_by__enabled_two_factor\", \"cancelled_by\".\"confirmed_two_factor\" AS \"cancelled_by__confirmed_two_factor\", \"cancelled_by\".\"otp_backup_codes\" AS \"cancelled_by__otp_backup_codes\", \"cancelled_by\".\"authy_id\" AS \"cancelled_by__authy_id\", \"cancelled_by\".\"last_sign_in_with_authy\" AS \"cancelled_by__last_sign_in_with_authy\", \"cancelled_by\".\"authy_status\" AS \"cancelled_by__authy_status\", \"cancelled_by\".\"email_verified\" AS \"cancelled_by__email_verified\", \"cancelled_by\".\"initial_password_updated\" AS \"cancelled_by__initial_password_updated\", \"cancelled_by\".\"force_password_update\" AS \"cancelled_by__force_password_update\", \"cancelled_by\".\"grace_period\" AS \"cancelled_by__grace_period\", \"cancelled_by\".\"awaiting_second_factor\" AS \"cancelled_by__awaiting_second_factor\", \"cancelled_by\".\"role\" AS \"cancelled_by__role\", \"work_item\".\"id\" AS \"work_item__id\", \"work_item\".\"created_at\" AS \"work_item__created_at\", \"work_item\".\"updated_at\" AS \"work_item__updated_at\", \"work_item\".\"name\" AS \"work_item__name\", \"work_item\".\"etag\" AS \"work_item__etag\", \"work_item\".\"institution_id\" AS \"work_item__institution_id\", \"work_item\".\"intellectual_object_id\" AS \"work_item__intellectual_object_id\", \"work_item\".\"generic_file_id\" AS \"work_item__generic_file_id\", \"work_item\".\"bucket\" AS \"work_item__bucket\", \"work_item\".\"user\" AS \"work_item__user\", \"work_item\".\"note\" AS \"work_item__note\", \"work_item\".\"action\" AS \"work_item__action\", \"work_item\".\"stage\" AS \"work_item__stage\", \"work_item\".\"status\" AS \"work_item__status\", \"work_item\".\"outcome\" AS \"work_item__outcome\", \"work_item\".\"bag_date\" AS \"work_item__bag_date\", \"work_item\".\"date_processed\" AS \"work_item__date_processed\", \"work_item\".\"retry\" AS \"work_item__retry\", \"work_item\".\"node\" AS \"work_item__node\", \"work_item\".\"pid\" AS \"work_item__pid\", \"work_item\".\"needs_admin_review\" AS \"work_item__needs_admin_review\", \"work_item\".\"queued_at\" AS \"work_item__queued_at\", \"work_item\".\"size\" AS \"work_item__size\", \"work_item\".\"stage_started_at\" AS \"work_item__stage_started_at\", \"work_item\".\"aptrust_approver\" AS \"work_item__aptrust_approver\", \"work_item\".\"inst_approver\" AS \"work_item__inst_approver\" FROM \"deletion_requests\" AS \"deletion_request\" LEFT JOIN \"users\" AS \"requested_by\" ON \"requested_by\".\"id\" = \"deletion_request\".\"requested_by_id\" LEFT JOIN \"users\" AS \"confirmed_by\" ON \"confirmed_by\".\"id\" = \"deletion_request\".\"confirmed_by_id\" LEFT JOIN \"users\" AS \"cancelled_by\" ON \"cancelled_by\".\"id\" = \"deletion_request\".\"cancelled_by_id\" LEFT JOIN \"work_items\" AS \"work_item\" ON \"work_item\".\"id\" = \"deletion_request\".\"work_item_id\" WHERE ((\"deletion_request\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"deletion_requests_generic_files\".*, \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" JOIN \"deletion_requests_generic_files\" AS \"deletion_requests_generic_files\" ON (\"deletion_requests_generic_files\".\"deletion_request_id\") IN (1) WHERE (\"generic_file\".\"id\" = \"deletion_requests_generic_files\".\"generic_file_id\")"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"deletion_requests_intellectual_objects\".*, \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" FROM \"intellectual_objects\" AS \"intellectual_object\" JOIN \"deletion_requests_intellectual_objects\" AS \"deletion_requests_intellectual_objects\" ON (\"deletion_requests_intellectual_objects\".\"deletion_request_id\") IN (1) WHERE (\"intellectual_object\".\"id\" = \"deletion_requests_intellectual_objects\".\"intellectual_object_id\")"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((\"premis_event\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((institution_id = 2)) LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((institution_id = 2)) LIMIT 4"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((\"premis_event\".\"id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:24.188504+00:00:00', '2022-06-22 17:30:24.188527+00:00:00', 'Sheep', '2022-06-22 17:30:24.188504+00:00:00', 'Last compare neck secure.', 'ingestion', DEFAULT, '109874af-9324-4c76-b122-c9b3b65576d9', 4, DEFAULT, 'Unit obtain note view.', DEFAULT, 'Realize follow climb recommend period.', 'Racer 5 India Pale Ale, Bear Republic Bre', 'Open Data Nation') RETURNING \"id\", \"generic_file_id\", \"intellectual_object_id\", \"old_uuid\""}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: INSERT INTO \"premis_events\" (\"id\", \"created_at\", \"updated_at\", \"agent\", \"date_time\", \"detail\", \"event_type\", \"generic_file_id\", \"identifier\", \"institution_id\", \"intellectual_object_id\", \"object\", \"old_uuid\", \"outcome\", \"outcome_detail\", \"outcome_information\") VALUES (DEFAULT, '2022-06-22 17:30:24.188504+00:00:00', '2022-06-22 17:30:24.189969+00:00:00', 'Sheep', '2022-06-22 17:30:24.188504+00:00:00', 'Last compare neck secure.', DEFAULT, DEFAULT, '109874af-9324-4c76-b122-c9b3b65576d9', 4, DEFAULT, 'Unit obtain note view.', DEFAULT, 'Realize follow climb recommend period.', 'Racer 5 India Pale Ale, Bear Republic Bre', 'Open Data Nation') RETURNING \"id\", \"event_type\", \"generic_file_id\", \"intellectual_object_id\", \"old_uuid\""}
{"level":"error","time":"2022-06-22T13:30:24-04:00","message":"Transaction failed. Model: &{{{0} 2022-06-22 17:30:24.188504 +0000 UTC 2022-06-22 17:30:24.189969 +0000 UTC} Sheep 2022-06-22 17:30:24.188504 +0000 UTC Last compare neck secure.  0 109874af-9324-4c76-b122-c9b3b65576d9 4 0 Unit obtain note view.  Realize follow climb recommend period. Racer 5 India Pale Ale, Bear Republic Bre Open Data Nation}. Error: ERROR #23505 duplicate key value violates unique constraint \"index_premis_events_on_identifier\""}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: ROLLBACK"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT count(*) FROM \"premis_events\" AS \"premis_event\" WHERE (intellectual_object_id = 3 and generic_file_id is null)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT count(*) FROM \"premis_events\" AS \"premis_event\" WHERE (intellectual_object_id = 0 and generic_file_id is null)"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"id\" FROM \"premis_events\" AS \"premis_event\" WHERE ((\"premis_event\".\"identifier\" = '77e16041-8887-4739-af04-9d35e5cab4dc'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"id\" FROM \"premis_events\" AS \"premis_event\" WHERE ((\"premis_event\".\"identifier\" = '274e230a-dc6b-48a1-a96c-709e5728632b'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"id\" FROM \"premis_events\" AS \"premis_event\" WHERE ((\"premis_event\".\"identifier\" = 'bad identifier'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((identifier = 'a966ca54-ee5b-4606-81bd-7653dd5f3a63'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((intellectual_object_id = 1)) ORDER BY \"created_at\" asc"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((created_at is not null))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_option\".\"id\", \"storage_option\".\"provider\", \"storage_option\".\"service\", \"storage_option\".\"region\", \"storage_option\".\"name\", \"storage_option\".\"cost_gb_per_month\", \"storage_option\".\"comment\", \"storage_option\".\"updated_at\" FROM \"storage_options\" AS \"storage_option\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_option\".\"id\", \"storage_option\".\"provider\", \"storage_option\".\"service\", \"storage_option\".\"region\", \"storage_option\".\"name\", \"storage_option\".\"cost_gb_per_month\", \"storage_option\".\"comment\", \"storage_option\".\"updated_at\" FROM \"storage_options\" AS \"storage_option\" WHERE ((name = 'Glacier-Deep-OH'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_option\".\"id\", \"storage_option\".\"provider\", \"storage_option\".\"service\", \"storage_option\".\"region\", \"storage_option\".\"name\", \"storage_option\".\"cost_gb_per_month\", \"storage_option\".\"comment\", \"storage_option\".\"updated_at\" FROM \"storage_options\" AS \"storage_option\" WHERE ((name = 'Wasabi-VA'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_option\".\"id\", \"storage_option\".\"provider\", \"storage_option\".\"service\", \"storage_option\".\"region\", \"storage_option\".\"name\", \"storage_option\".\"cost_gb_per_month\", \"storage_option\".\"comment\", \"storage_option\".\"updated_at\" FROM \"storage_options\" AS \"storage_option\" ORDER BY \"name\" asc"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_option\".\"id\", \"storage_option\".\"provider\", \"storage_option\".\"service\", \"storage_option\".\"region\", \"storage_option\".\"name\", \"storage_option\".\"cost_gb_per_month\", \"storage_option\".\"comment\", \"storage_option\".\"updated_at\" FROM \"storage_options\" AS \"storage_option\" WHERE ((provider = 'AWS')) ORDER BY \"name\" asc"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_option\".\"id\", \"storage_option\".\"provider\", \"storage_option\".\"service\", \"storage_option\".\"region\", \"storage_option\".\"name\", \"storage_option\".\"cost_gb_per_month\", \"storage_option\".\"comment\", \"storage_option\".\"updated_at\" FROM \"storage_options\" AS \"storage_option\" WHERE ((name = 'Standard'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"storage_options\" AS \"storage_option\" SET \"provider\" = 'AWS', \"service\" = 'S3 VA + Glacier OR', \"region\" = 'VA-OR', \"name\" = 'Standard', \"cost_gb_per_month\" = 0.027, \"comment\" = 'Includes 1 S3 copy and 1 Glacier copy. Priced as of July 29, 2021 ** ', \"updated_at\" = '2022-06-22 17:30:24.211727+00:00:00' WHERE \"storage_option\".\"id\" = 1"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 1)) LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE ((generic_file_id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: INSERT INTO \"storage_records\" (\"id\", \"generic_file_id\", \"url\") VALUES (DEFAULT, 1, 'https://example.com/s3/54321') RETURNING \"id\""}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'system@aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"name\" = 'Inst One Admin'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'system@aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.291889+00:00:00', \"name\" = 'APTrust System', \"email\" = 'system@aptrust.org', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 2, \"current_sign_in_at\" = '2022-06-22 17:30:24.291888+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = '1.1.1.1', \"last_sign_in_ip\" = '127.0.0.1', \"institution_id\" = 1, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'admin' WHERE \"user\".\"id\" = 1"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'system@aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.369304+00:00:00', \"name\" = 'APTrust System', \"email\" = 'system@aptrust.org', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 3, \"current_sign_in_at\" = '2022-06-22 17:30:24.369303+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = '2.2.2.2', \"last_sign_in_ip\" = '1.1.1.1', \"institution_id\" = 1, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'admin' WHERE \"user\".\"id\" = 1"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.595282+00:00:00', \"name\" = 'APTrust System', \"email\" = 'system@aptrust.org', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 3, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = '2022-06-22 17:30:24.369303+00:00:00', \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = '2.2.2.2', \"institution_id\" = 1, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'admin' WHERE \"user\".\"id\" = 1"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.675669+00:00:00', \"name\" = 'Inst One Admin', \"email\" = 'admin@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 1, \"current_sign_in_at\" = '2022-06-22 17:30:24.675669+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = '1.1.1.1', \"last_sign_in_ip\" = NULL, \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_admin' WHERE \"user\".\"id\" = 2"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.748165+00:00:00', \"name\" = 'Inst One Admin', \"email\" = 'admin@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 2, \"current_sign_in_at\" = '2022-06-22 17:30:24.748164+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = '2.2.2.2', \"last_sign_in_ip\" = '1.1.1.1', \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_admin' WHERE \"user\".\"id\" = 2"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.750363+00:00:00', \"name\" = 'Inst One Admin', \"email\" = 'admin@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 2, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = '2022-06-22 17:30:24.748164+00:00:00', \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = '2.2.2.2', \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_admin' WHERE \"user\".\"id\" = 2"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.825193+00:00:00', \"name\" = 'Inst One User', \"email\" = 'user@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$raEJqJ7eRcEwWmeoiJ2vxenR8dqVXCI1SU9zcgkrxeS.6/haWGi4K', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 2, \"current_sign_in_at\" = '2022-06-22 17:30:24.825193+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = '1.1.1.1', \"last_sign_in_ip\" = NULL, \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 3"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.898418+00:00:00', \"name\" = 'Inst One User', \"email\" = 'user@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$raEJqJ7eRcEwWmeoiJ2vxenR8dqVXCI1SU9zcgkrxeS.6/haWGi4K', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 3, \"current_sign_in_at\" = '2022-06-22 17:30:24.898417+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = '2.2.2.2', \"last_sign_in_ip\" = '1.1.1.1', \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 3"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:24.900368+00:00:00', \"name\" = 'Inst One User', \"email\" = 'user@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$raEJqJ7eRcEwWmeoiJ2vxenR8dqVXCI1SU9zcgkrxeS.6/haWGi4K', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 3, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = '2022-06-22 17:30:24.898417+00:00:00', \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = '2.2.2.2', \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 3"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'noone@example.com'))"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'system@aptrust.org'))"}
{"level":"warn","time":"2022-06-22T13:30:24-04:00","message":"Wrong password for user system@aptrust.org"}
{"level":"debug","time":"2022-06-22T13:30:24-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'inactive@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"users\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"email\", \"phone_number\", \"encrypted_password\", \"reset_password_token\", \"reset_password_sent_at\", \"remember_created_at\", \"sign_in_count\", \"current_sign_in_at\", \"last_sign_in_at\", \"current_sign_in_ip\", \"last_sign_in_ip\", \"institution_id\", \"encrypted_api_secret_key\", \"password_changed_at\", \"encrypted_otp_secret\", \"encrypted_otp_secret_iv\", \"encrypted_otp_secret_salt\", \"encrypted_otp_sent_at\", \"consumed_timestep\", \"otp_required_for_login\", \"deactivated_at\", \"enabled_two_factor\", \"confirmed_two_factor\", \"otp_backup_codes\", \"authy_id\", \"last_sign_in_with_authy\", \"authy_status\", \"email_verified\", \"initial_password_updated\", \"force_password_update\", \"grace_period\", \"awaiting_second_factor\", \"role\") VALUES (DEFAULT, '2022-06-22 17:30:25.048221+00:00:00', '2022-06-22 17:30:25.048221+00:00:00', 'Barney Gumble', 'barney@simpsons.kom', DEFAULT, '$2a$10$qdUPiT5R9lsUQ1U6Xh9UeutHOZ86UeuY05kG6lKqNbn8BVGmXJFK6', DEFAULT, DEFAULT, DEFAULT, 0, DEFAULT, DEFAULT, DEFAULT, DEFAULT, 4, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, FALSE, 'institutional_user') RETURNING \"id\", \"phone_number\", \"reset_password_token\", \"reset_password_sent_at\", \"remember_created_at\", \"current_sign_in_at\", \"last_sign_in_at\", \"current_sign_in_ip\", \"last_sign_in_ip\", \"encrypted_api_secret_key\", \"password_changed_at\", \"encrypted_otp_secret\", \"encrypted_otp_secret_iv\", \"encrypted_otp_secret_salt\", \"encrypted_otp_sent_at\", \"consumed_timestep\", \"otp_required_for_login\", \"deactivated_at\", \"enabled_two_factor\", \"confirmed_two_factor\", \"otp_backup_codes\", \"authy_id\", \"last_sign_in_with_authy\", \"authy_status\", \"email_verified\", \"initial_password_updated\", \"force_password_update\", \"grace_period\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2022-06-22 17:30:25.048221+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.048221+00:00:00', \"name\" = 'Barney Gumble', \"email\" = 'barney@simpsons.kom', \"phone_number\" = NULL, \"encrypted_password\" = '$2a$10$qdUPiT5R9lsUQ1U6Xh9UeutHOZ86UeuY05kG6lKqNbn8BVGmXJFK6', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 0, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = NULL, \"institution_id\" = 4, \"encrypted_api_secret_key\" = NULL, \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = '2022-06-22 17:30:25.050921+00:00:00', \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = NULL, \"initial_password_updated\" = NULL, \"force_password_update\" = NULL, \"grace_period\" = NULL, \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 10"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2022-06-22 17:30:25.048221+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.048221+00:00:00', \"name\" = 'Barney Gumble', \"email\" = 'barney@simpsons.kom', \"phone_number\" = NULL, \"encrypted_password\" = '$2a$10$qdUPiT5R9lsUQ1U6Xh9UeutHOZ86UeuY05kG6lKqNbn8BVGmXJFK6', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 0, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = NULL, \"institution_id\" = 4, \"encrypted_api_secret_key\" = NULL, \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = NULL, \"initial_password_updated\" = NULL, \"force_password_update\" = NULL, \"grace_period\" = NULL, \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 10"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\" FROM \"users\" AS \"user\" WHERE ((institution_id = 2)) ORDER BY \"email\" asc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.127436+00:00:00', \"name\" = 'Inst One User', \"email\" = 'user@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$raEJqJ7eRcEwWmeoiJ2vxenR8dqVXCI1SU9zcgkrxeS.6/haWGi4K', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 3, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = '2022-06-22 17:30:24.898417+00:00:00', \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = '2.2.2.2', \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 3"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.197978+00:00:00', \"name\" = 'Inst One User', \"email\" = 'user@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$raEJqJ7eRcEwWmeoiJ2vxenR8dqVXCI1SU9zcgkrxeS.6/haWGi4K', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 3, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = '2022-06-22 17:30:24.898417+00:00:00', \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = '2.2.2.2', \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = '$2a$10$fdN2grgGtgyUgKho2T1W7eIIrM5.9AKa.8ZZrakwW.KWNYl8aEdbC', \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 3"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.200431+00:00:00', \"name\" = 'Inst One User', \"email\" = 'user@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$raEJqJ7eRcEwWmeoiJ2vxenR8dqVXCI1SU9zcgkrxeS.6/haWGi4K', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 3, \"current_sign_in_at\" = NULL, \"last_sign_in_at\" = '2022-06-22 17:30:24.898417+00:00:00', \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = '2.2.2.2', \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 3"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user_view\".\"id\", \"user_view\".\"name\", \"user_view\".\"email\", \"user_view\".\"phone_number\", \"user_view\".\"created_at\", \"user_view\".\"updated_at\", \"user_view\".\"reset_password_sent_at\", \"user_view\".\"remember_created_at\", \"user_view\".\"sign_in_count\", \"user_view\".\"current_sign_in_at\", \"user_view\".\"last_sign_in_at\", \"user_view\".\"current_sign_in_ip\", \"user_view\".\"last_sign_in_ip\", \"user_view\".\"institution_id\", \"user_view\".\"password_changed_at\", \"user_view\".\"consumed_timestep\", \"user_view\".\"otp_required_for_login\", \"user_view\".\"deactivated_at\", \"user_view\".\"enabled_two_factor\", \"user_view\".\"confirmed_two_factor\", \"user_view\".\"authy_id\", \"user_view\".\"last_sign_in_with_authy\", \"user_view\".\"authy_status\", \"user_view\".\"email_verified\", \"user_view\".\"initial_password_updated\", \"user_view\".\"force_password_update\", \"user_view\".\"grace_period\", \"user_view\".\"role\", \"user_view\".\"institution_name\", \"user_view\".\"institution_identifier\", \"user_view\".\"institution_state\", \"user_view\".\"institution_type\", \"user_view\".\"member_institution_id\", \"user_view\".\"member_institution_name\", \"user_view\".\"member_institution_identifier\", \"user_view\".\"member_institution_state\", \"user_view\".\"otp_enabled\", \"user_view\".\"receiving_bucket\", \"user_view\".\"restore_bucket\" FROM \"users_view\" AS \"user_view\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user_view\".\"id\", \"user_view\".\"name\", \"user_view\".\"email\", \"user_view\".\"phone_number\", \"user_view\".\"created_at\", \"user_view\".\"updated_at\", \"user_view\".\"reset_password_sent_at\", \"user_view\".\"remember_created_at\", \"user_view\".\"sign_in_count\", \"user_view\".\"current_sign_in_at\", \"user_view\".\"last_sign_in_at\", \"user_view\".\"current_sign_in_ip\", \"user_view\".\"last_sign_in_ip\", \"user_view\".\"institution_id\", \"user_view\".\"password_changed_at\", \"user_view\".\"consumed_timestep\", \"user_view\".\"otp_required_for_login\", \"user_view\".\"deactivated_at\", \"user_view\".\"enabled_two_factor\", \"user_view\".\"confirmed_two_factor\", \"user_view\".\"authy_id\", \"user_view\".\"last_sign_in_with_authy\", \"user_view\".\"authy_status\", \"user_view\".\"email_verified\", \"user_view\".\"initial_password_updated\", \"user_view\".\"force_password_update\", \"user_view\".\"grace_period\", \"user_view\".\"role\", \"user_view\".\"institution_name\", \"user_view\".\"institution_identifier\", \"user_view\".\"institution_state\", \"user_view\".\"institution_type\", \"user_view\".\"member_institution_id\", \"user_view\".\"member_institution_name\", \"user_view\".\"member_institution_identifier\", \"user_view\".\"member_institution_state\", \"user_view\".\"otp_enabled\", \"user_view\".\"receiving_bucket\", \"user_view\".\"restore_bucket\" FROM \"users_view\" AS \"user_view\" WHERE ((email = 'system@aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user_view\".\"id\", \"user_view\".\"name\", \"user_view\".\"email\", \"user_view\".\"phone_number\", \"user_view\".\"created_at\", \"user_view\".\"updated_at\", \"user_view\".\"reset_password_sent_at\", \"user_view\".\"remember_created_at\", \"user_view\".\"sign_in_count\", \"user_view\".\"current_sign_in_at\", \"user_view\".\"last_sign_in_at\", \"user_view\".\"current_sign_in_ip\", \"user_view\".\"last_sign_in_ip\", \"user_view\".\"institution_id\", \"user_view\".\"password_changed_at\", \"user_view\".\"consumed_timestep\", \"user_view\".\"otp_required_for_login\", \"user_view\".\"deactivated_at\", \"user_view\".\"enabled_two_factor\", \"user_view\".\"confirmed_two_factor\", \"user_view\".\"authy_id\", \"user_view\".\"last_sign_in_with_authy\", \"user_view\".\"authy_status\", \"user_view\".\"email_verified\", \"user_view\".\"initial_password_updated\", \"user_view\".\"force_password_update\", \"user_view\".\"grace_period\", \"user_view\".\"role\", \"user_view\".\"institution_name\", \"user_view\".\"institution_identifier\", \"user_view\".\"institution_state\", \"user_view\".\"institution_type\", \"user_view\".\"member_institution_id\", \"user_view\".\"member_institution_name\", \"user_view\".\"member_institution_identifier\", \"user_view\".\"member_institution_state\", \"user_view\".\"otp_enabled\", \"user_view\".\"receiving_bucket\", \"user_view\".\"restore_bucket\" FROM \"users_view\" AS \"user_view\" WHERE ((institution_id = 3)) ORDER BY \"created_at\" asc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((id = 23))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((name = 'pdfs.tar'))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((name != 'pdfs.tar') AND (name != 'coal.tar')) ORDER BY \"name\" asc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.210201+00:00:00', '2022-06-22 17:30:25.210201+00:00:00', 'unit_00001.tar', '12345678901234567890123456789099', 4, DEFAULT, DEFAULT, 'aptrust.receiving.test.test.edu', 'system@aptrust.org', 'Item is awaiting ingest.', 'Ingest', 'Requested', 'Pending', 'I said item is awaiting ingest.', '2021-06-16 10:24:16+00:00:00', '2021-06-16 10:24:16+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, 8000, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"intellectual_object_id\", \"generic_file_id\", \"node\", \"pid\", \"queued_at\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.212193+00:00:00', '2022-06-22 17:30:25.212193+00:00:00', 'unit_00002.tar', '12345678901234567890123456789022', 4, DEFAULT, DEFAULT, 'aptrust.receiving.test.test.edu', 'system@aptrust.org', 'Item is being stored.', 'Ingest', 'Store', 'Started', 'I said item is being stored.', '2021-06-16 10:24:16+00:00:00', '2021-06-16 10:24:16+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, 8000, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"intellectual_object_id\", \"generic_file_id\", \"node\", \"pid\", \"queued_at\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2022-06-22 17:30:25.212193+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.213761+00:00:00', \"name\" = 'unit_00002.tar', \"etag\" = '12345678901234567890123456789022', \"institution_id\" = 4, \"intellectual_object_id\" = NULL, \"generic_file_id\" = NULL, \"bucket\" = 'aptrust.receiving.test.test.edu', \"user\" = 'system@aptrust.org', \"note\" = 'Requeued for Format Identification', \"action\" = 'Ingest', \"stage\" = 'Format Identification', \"status\" = 'Pending', \"outcome\" = 'I said item is being stored.', \"bag_date\" = '2021-06-16 10:24:16+00:00:00', \"date_processed\" = '2021-06-16 10:24:16+00:00:00', \"retry\" = TRUE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = NULL, \"size\" = 8000, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = NULL WHERE \"work_item\".\"id\" = 34"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.215358+00:00:00', '2022-06-22 17:30:25.215358+00:00:00', 'pending.tar', '12345678901234567890123456789022', 4, DEFAULT, DEFAULT, 'aptrust.receiving.test.test.edu', 'system@aptrust.org', 'Item is being stored.', 'Ingest', 'Store', 'Started', 'I said item is being stored.', '2021-06-16 10:24:16+00:00:00', '2021-06-16 10:24:16+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, 8000, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"intellectual_object_id\", \"generic_file_id\", \"node\", \"pid\", \"queued_at\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((institution_id = 3) AND (name = 'pending.tar') AND (status NOT IN ('Cancelled', 'Failed', 'Success'))) ORDER BY \"date_processed\" desc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((institution_id = 4) AND (name = 'pending.tar') AND (status NOT IN ('Cancelled', 'Failed', 'Success'))) ORDER BY \"date_processed\" desc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2022-06-22 17:30:25.215358+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.218339+00:00:00', \"name\" = 'pending.tar', \"etag\" = '12345678901234567890123456789022', \"institution_id\" = 4, \"intellectual_object_id\" = NULL, \"generic_file_id\" = NULL, \"bucket\" = 'aptrust.receiving.test.test.edu', \"user\" = 'system@aptrust.org', \"note\" = 'Item is being stored.', \"action\" = 'Ingest', \"stage\" = 'Store', \"status\" = 'Cancelled', \"outcome\" = 'I said item is being stored.', \"bag_date\" = '2021-06-16 10:24:16+00:00:00', \"date_processed\" = '2021-06-16 10:24:16+00:00:00', \"retry\" = TRUE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = NULL, \"size\" = 8000, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = NULL WHERE \"work_item\".\"id\" = 35"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((institution_id = 4) AND (name = 'pending.tar') AND (status NOT IN ('Cancelled', 'Failed', 'Success'))) ORDER BY \"date_processed\" desc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.220709+00:00:00', '2022-06-22 17:30:25.220709+00:00:00', 'photos.tar', '99995678901234567890123456789999', 1, 1, 1, 'aptrust.receiving.test.test.edu', 'system@aptrust.org', 'Test restoration item (file)', 'Restore File', 'Requested', 'Pending', 'Item is pending', '2021-06-16 10:24:16+00:00:00', '2021-06-16 10:24:16+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, 8000, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"node\", \"pid\", \"queued_at\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 1) AND (status NOT IN ('Cancelled', 'Failed', 'Success'))) ORDER BY \"date_processed\" desc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2022-06-22 17:30:25.220709+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.222675+00:00:00', \"name\" = 'photos.tar', \"etag\" = '99995678901234567890123456789999', \"institution_id\" = 1, \"intellectual_object_id\" = 1, \"generic_file_id\" = 1, \"bucket\" = 'aptrust.receiving.test.test.edu', \"user\" = 'system@aptrust.org', \"note\" = 'This thing is done. Look in S3.', \"action\" = 'Restore File', \"stage\" = 'Available in S3', \"status\" = 'Success', \"outcome\" = 'Item is pending', \"bag_date\" = '2021-06-16 10:24:16+00:00:00', \"date_processed\" = '2021-06-16 10:24:16+00:00:00', \"retry\" = TRUE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = NULL, \"size\" = 8000, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = NULL WHERE \"work_item\".\"id\" = 36"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((generic_file_id = 1) AND (status NOT IN ('Cancelled', 'Failed', 'Success'))) ORDER BY \"date_processed\" desc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((id = 26))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 4) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: UPDATE \"work_items\" AS \"work_item\" SET \"created_at\" = '2016-08-20 16:01:59+00:00:00', \"updated_at\" = '2022-06-22 17:30:25.226353+00:00:00', \"name\" = 'chocolate.tar', \"etag\" = 'aaaabbbb4939474aa6f5f77bf56faaaa', \"institution_id\" = 3, \"intellectual_object_id\" = 4, \"generic_file_id\" = NULL, \"bucket\" = 'aptrust.receiving.institution2.edu', \"user\" = 'system@aptrust.org', \"note\" = 'Item ingested successfully', \"action\" = 'Ingest', \"stage\" = 'Cleanup', \"status\" = 'Success', \"outcome\" = 'No problems', \"bag_date\" = '2016-08-24 10:04:06+00:00:00', \"date_processed\" = '2022-06-22 17:30:25.226353+00:00:00', \"retry\" = FALSE, \"node\" = NULL, \"pid\" = NULL, \"needs_admin_review\" = FALSE, \"queued_at\" = '2016-08-30 15:41:45+00:00:00', \"size\" = NULL, \"stage_started_at\" = NULL, \"aptrust_approver\" = NULL, \"inst_approver\" = NULL WHERE \"work_item\".\"id\" = 26"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 4) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 4))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 11) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (11)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (11)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (11))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 4) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.23351+00:00:00', '2022-06-22 17:30:25.233511+00:00:00', 'chocolate.tar', 'aaaabbbb4939474aa6f5f77bf56faaaa', 3, 4, DEFAULT, 'aptrust.receiving.institution2.edu', 'unittest@example.com', 'Not started', 'Restore Object', 'Requested', 'Pending', 'Not started', '2016-08-24 10:04:06+00:00:00', '2022-06-22 17:30:25.23351+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"generic_file_id\", \"node\", \"pid\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 4) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.235712+00:00:00', '2022-06-22 17:30:25.235713+00:00:00', 'chocolate.tar', 'aaaabbbb4939474aa6f5f77bf56faaaa', 3, 4, 11, 'aptrust.receiving.institution2.edu', 'unittest@example.com', 'Not started', 'Restore File', 'Requested', 'Pending', 'Not started', '2016-08-24 10:04:06+00:00:00', '2022-06-22 17:30:25.235712+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"node\", \"pid\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 4) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.238196+00:00:00', '2022-06-22 17:30:25.238198+00:00:00', 'chocolate.tar', 'aaaabbbb4939474aa6f5f77bf56faaaa', 3, 4, DEFAULT, 'aptrust.receiving.institution2.edu', 'unittest@example.com', 'Not started', 'Glacier Restore', 'Requested', 'Pending', 'Not started', '2016-08-24 10:04:06+00:00:00', '2022-06-22 17:30:25.238196+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"generic_file_id\", \"node\", \"pid\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 4) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.240839+00:00:00', '2022-06-22 17:30:25.24084+00:00:00', 'chocolate.tar', 'aaaabbbb4939474aa6f5f77bf56faaaa', 3, 4, 11, 'aptrust.receiving.institution2.edu', 'unittest@example.com', 'Not started', 'Glacier Restore', 'Requested', 'Pending', 'Not started', '2016-08-24 10:04:06+00:00:00', '2022-06-22 17:30:25.240839+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT) RETURNING \"id\", \"node\", \"pid\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((institution_id = 2) AND (state = 'A') AND (role = 'institutional_user')) LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((institution_id = 2) AND (state = 'A') AND (role = 'institutional_admin')) LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 2) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.246692+00:00:00', '2022-06-22 17:30:25.246693+00:00:00', 'pdfs.tar', '6b5b18c999dc4fdc9c47a2db90782cee', 2, 2, DEFAULT, 'aptrust.receiving.institution1.edu', 'user@inst1.edu', 'Not started', 'Delete', 'Requested', 'Pending', 'Not started', '2016-08-24 10:04:06+00:00:00', '2022-06-22 17:30:25.246692+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, DEFAULT, DEFAULT, DEFAULT, 'admin@inst1.edu') RETURNING \"id\", \"generic_file_id\", \"node\", \"pid\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" WHERE ((intellectual_object_id = 2) AND (state = 'A')) LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 2) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: INSERT INTO \"work_items\" (\"id\", \"created_at\", \"updated_at\", \"name\", \"etag\", \"institution_id\", \"intellectual_object_id\", \"generic_file_id\", \"bucket\", \"user\", \"note\", \"action\", \"stage\", \"status\", \"outcome\", \"bag_date\", \"date_processed\", \"retry\", \"node\", \"pid\", \"needs_admin_review\", \"queued_at\", \"size\", \"stage_started_at\", \"aptrust_approver\", \"inst_approver\") VALUES (DEFAULT, '2022-06-22 17:30:25.249563+00:00:00', '2022-06-22 17:30:25.249564+00:00:00', 'pdfs.tar', '6b5b18c999dc4fdc9c47a2db90782cee', 2, 2, 4, 'aptrust.receiving.institution1.edu', 'user@inst1.edu', 'Not started', 'Delete', 'Requested', 'Pending', 'Not started', '2016-08-24 10:04:06+00:00:00', '2022-06-22 17:30:25.249563+00:00:00', TRUE, DEFAULT, DEFAULT, FALSE, DEFAULT, 11169445000, DEFAULT, DEFAULT, 'admin@inst1.edu') RETURNING \"id\", \"node\", \"pid\", \"queued_at\", \"stage_started_at\", \"aptrust_approver\""}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((intellectual_object_id = 0) AND (status = 'Success') AND (stage IN ('Record', 'Cleanup'))) ORDER BY \"date_processed\" desc LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:25-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: select update_counts();"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((id = 23))"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((name = 'pdfs.tar'))"}
{"level":"debug","time":"2022-06-22T13:30:26-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((name != 'pdfs.tar') AND (name != 'coal.tar')) ORDER BY \"name\" asc"}
