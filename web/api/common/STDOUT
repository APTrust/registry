{"level":"info","time":"2022-06-22T13:30:39-04:00","message":"Email service is disabled. Alerts will be written to the log file."}
{"level":"info","time":"2022-06-22T13:30:39-04:00","message":"Two-factor SMS is disabled. OTP codes will be written to the log file."}
{"level":"info","time":"2022-06-22T13:30:39-04:00","message":"Initializing cron jobs"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"info","time":"2022-06-22T13:30:39-04:00","message":"cron: starting update_counts() to refresh views"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: select update_counts()"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"ar_internal_metadata\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"bulk_delete_jobs_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"confirmation_tokens\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"emails\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"emails_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"emails_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"emails_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"emails_work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"old_passwords\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"schema_migrations\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"snapshots\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"usage_samples\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"alerts_work_items\" cascade"}
{"level":"info","time":"2022-06-22T13:30:39-04:00","message":"cron: update_counts completed after 0.107250 seconds"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"alerts_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"alerts_premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"alerts\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"deletion_requests_intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"deletion_requests\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"work_items\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"premis_events\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"storage_records\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"checksums\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"generic_files\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"intellectual_objects\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"roles_users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"users\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"institutions\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"roles\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: drop table if exists \"storage_options\" cascade"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:39-04:00","message":"Starting SQL: --\n-- schema.sql\n--\n-- This file represents the full registry schema.\n--\n-- The migrations.sql file updates the old Pharos schema, as it existed\n-- in the feature/storage_record branch, so that it matches this schema.\n--\n-- https://github.com/APTrust/pharos/blob/feature/storage-record/db/schema.rb\n--\n\n\n-- public.ar_internal_metadata definition\n--\n-- This is a legacy table used by ActiveRecord.\n-- We can drop this once production is stable.\n--\nCREATE TABLE public.ar_internal_metadata (\n\t\"key\" varchar NOT NULL,\n\tvalue varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT ar_internal_metadata_pkey PRIMARY KEY (key)\n);\n\n\n-- public.bulk_delete_jobs definition\n--\n-- This is the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs (\n\tid bigserial NOT NULL,\n\trequested_by varchar NULL,\n\tinstitutional_approver varchar NULL,\n\taptrust_approver varchar NULL,\n\tinstitutional_approval_at timestamp NULL,\n\taptrust_approval_at timestamp NULL,\n\tnote text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id int4 NOT NULL,\n\tCONSTRAINT bulk_delete_jobs_pkey PRIMARY KEY (id)\n);\n\n\n-- public.bulk_delete_jobs_emails definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_emails (\n\tbulk_delete_job_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_emails_on_bulk_delete_job_id ON public.bulk_delete_jobs_emails USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_emails_on_email_id ON public.bulk_delete_jobs_emails USING btree (email_id);\n\n\n-- public.bulk_delete_jobs_generic_files definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_generic_files (\n\tbulk_delete_job_id int8 NULL,\n\tgeneric_file_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_bulk_delete_job_id ON public.bulk_delete_jobs_generic_files USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_generic_files_on_generic_file_id ON public.bulk_delete_jobs_generic_files USING btree (generic_file_id);\n\n\n-- public.bulk_delete_jobs_institutions definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_institutions (\n\tbulk_delete_job_id int8 NULL,\n\tinstitution_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_bulk_delete_job_id ON public.bulk_delete_jobs_institutions USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_institutions_on_institution_id ON public.bulk_delete_jobs_institutions USING btree (institution_id);\n\n\n-- public.bulk_delete_jobs_intellectual_objects definition\n--\n-- Related to the legacy bulk delete table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.bulk_delete_jobs_intellectual_objects (\n\tbulk_delete_job_id int8 NULL,\n\tintellectual_object_id int8 NULL\n);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_bulk_job_id ON public.bulk_delete_jobs_intellectual_objects USING btree (bulk_delete_job_id);\nCREATE INDEX index_bulk_delete_jobs_intellectual_objects_on_object_id ON public.bulk_delete_jobs_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.confirmation_tokens definition\n--\n-- This is a legacy table. We can likely delete it\n-- after production is stable.\n--\nCREATE TABLE public.confirmation_tokens (\n\tid bigserial NOT NULL,\n\t\"token\" varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tuser_id int4 NULL,\n\tCONSTRAINT confirmation_tokens_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails definition\n--\n-- This legacy table will be replaced by the new alerts table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails (\n\tid bigserial NOT NULL,\n\temail_type varchar NULL,\n\tevent_identifier varchar NULL,\n\titem_id int4 NULL,\n\temail_text text NULL,\n\tuser_list text NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tinstitution_id int4 NULL,\n\tCONSTRAINT emails_pkey PRIMARY KEY (id)\n);\n\n\n-- public.emails_generic_files definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_generic_files (\n\tgeneric_file_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_generic_files_on_email_id ON public.emails_generic_files USING btree (email_id);\nCREATE INDEX index_emails_generic_files_on_generic_file_id ON public.emails_generic_files USING btree (generic_file_id);\n\n\n-- public.emails_intellectual_objects definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_intellectual_objects (\n\tintellectual_object_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_intellectual_objects_on_email_id ON public.emails_intellectual_objects USING btree (email_id);\nCREATE INDEX index_emails_intellectual_objects_on_intellectual_object_id ON public.emails_intellectual_objects USING btree (intellectual_object_id);\n\n\n-- public.emails_premis_events definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_premis_events (\n\tpremis_event_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_premis_events_on_email_id ON public.emails_premis_events USING btree (email_id);\nCREATE INDEX index_emails_premis_events_on_premis_event_id ON public.emails_premis_events USING btree (premis_event_id);\n\n\n-- public.emails_work_items definition\n--\n-- Related to the legacy emails table.\n-- We should eventually archive this, but keep the\n-- data somewhere for historical and audit purposes.\n--\nCREATE TABLE public.emails_work_items (\n\twork_item_id int8 NULL,\n\temail_id int8 NULL\n);\nCREATE INDEX index_emails_work_items_on_email_id ON public.emails_work_items USING btree (email_id);\nCREATE INDEX index_emails_work_items_on_work_item_id ON public.emails_work_items USING btree (work_item_id);\n\n\n-- public.generic_files definition\nCREATE TABLE public.generic_files (\n\tid serial NOT NULL,\n\tfile_format varchar NULL,\n\t\"size\" int8 NULL,\n\tidentifier varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tlast_fixity_check timestamp NOT NULL DEFAULT '2000-01-01 00:00:00'::timestamp without time zone,\n\tinstitution_id int4 NOT NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tuuid varchar NOT NULL,\n\tCONSTRAINT generic_files_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_generic_files_on_created_at ON public.generic_files USING btree (created_at);\nCREATE UNIQUE INDEX index_generic_files_on_identifier ON public.generic_files USING btree (identifier);\nCREATE INDEX index_generic_files_on_institution_id ON public.generic_files USING btree (institution_id);\nCREATE INDEX index_generic_files_on_institution_id_and_state ON public.generic_files USING btree (institution_id, state);\nCREATE INDEX index_generic_files_on_institution_id_and_updated_at ON public.generic_files USING btree (institution_id, updated_at);\nCREATE INDEX index_generic_files_on_intellectual_object_id ON public.generic_files USING btree (intellectual_object_id);\nCREATE INDEX index_generic_files_on_updated_at ON public.generic_files USING btree (updated_at);\nCREATE UNIQUE INDEX index_generic_files_on_uuid ON public.generic_files USING btree (uuid);\nCREATE INDEX ix_gf_last_fixity_check ON public.generic_files USING btree (last_fixity_check);\n\n\n-- public.institutions definition\nCREATE TABLE public.institutions (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\tidentifier varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\t\"type\" varchar NULL,\n\tmember_institution_id int4 NULL,\n\tdeactivated_at timestamp NULL,\n\totp_enabled bool NULL,\n    enable_spot_restore bool not null default false,\n\treceiving_bucket varchar NOT NULL,\n\trestore_bucket varchar NOT NULL,\n\tCONSTRAINT institutions_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_institutions_on_name ON public.institutions USING btree (name);\n\n\n-- public.intellectual_objects definition\nCREATE TABLE public.intellectual_objects (\n\tid serial NOT NULL,\n\ttitle varchar NULL,\n\tdescription text NULL,\n\tidentifier varchar NULL,\n\talt_identifier varchar NULL,\n\t\"access\" varchar NULL,\n\tbag_name varchar NULL,\n\tinstitution_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tstate varchar NULL,\n\tetag varchar NULL,\n\tbag_group_identifier varchar NULL,\n\tstorage_option varchar NOT NULL DEFAULT 'Standard'::character varying,\n\tbagit_profile_identifier varchar NULL,\n\tsource_organization varchar NULL,\n\tinternal_sender_identifier varchar NULL,\n\tinternal_sender_description text NULL,\n\tCONSTRAINT intellectual_objects_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_intellectual_objects_on_bag_name ON public.intellectual_objects USING btree (bag_name);\nCREATE INDEX index_intellectual_objects_on_created_at ON public.intellectual_objects USING btree (created_at);\nCREATE UNIQUE INDEX index_intellectual_objects_on_identifier ON public.intellectual_objects USING btree (identifier);\nCREATE INDEX index_intellectual_objects_on_institution_id ON public.intellectual_objects USING btree (institution_id);\nCREATE INDEX index_intellectual_objects_on_updated_at ON public.intellectual_objects USING btree (updated_at);\n\n\n-- public.old_passwords definition\n--\n-- This is a legacy table. We can get rid of this if we\n-- abandon mandatory password changes. Wait until that's\n-- decided.\n--\nCREATE TABLE public.old_passwords (\n\tid bigserial NOT NULL,\n\tencrypted_password varchar NOT NULL,\n\tpassword_salt varchar NULL,\n\tpassword_archivable_type varchar NOT NULL,\n\tpassword_archivable_id int4 NOT NULL,\n\tcreated_at timestamp NULL,\n\tCONSTRAINT old_passwords_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_password_archivable ON public.old_passwords USING btree (password_archivable_type, password_archivable_id);\n\n\n-- public.premis_events definition\nCREATE TABLE public.premis_events (\n\tid serial NOT NULL,\n\tidentifier varchar NULL,\n\tevent_type varchar NULL,\n\tdate_time varchar NULL,\n\toutcome_detail varchar NULL,\n\tdetail varchar NULL,\n\toutcome_information varchar NULL,\n\t\"object\" varchar NULL,\n\tagent varchar NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\toutcome varchar NULL,\n\tinstitution_id int4 NULL,\n\told_uuid varchar NULL,\n\tCONSTRAINT premis_events_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_premis_events_date_time_desc ON public.premis_events USING btree (date_time DESC);\nCREATE INDEX index_premis_events_on_event_type ON public.premis_events USING btree (event_type);\nCREATE INDEX index_premis_events_on_event_type_and_outcome ON public.premis_events USING btree (event_type, outcome);\nCREATE INDEX index_premis_events_on_generic_file_id ON public.premis_events USING btree (generic_file_id);\nCREATE UNIQUE INDEX index_premis_events_on_identifier ON public.premis_events USING btree (identifier);\nCREATE INDEX index_premis_events_on_institution_id ON public.premis_events USING btree (institution_id);\nCREATE INDEX index_premis_events_on_intellectual_object_id ON public.premis_events USING btree (intellectual_object_id);\nCREATE INDEX index_premis_events_on_outcome ON public.premis_events USING btree (outcome);\n\n\n-- public.schema_migrations definition\n--\n-- This is a legacy table used by ActiveRecord\n-- to track which migrations have been applied.\n--\n-- We can delete this when production is stable.\n--\nCREATE TABLE public.schema_migrations (\n\t\"version\" varchar NOT NULL,\n\tCONSTRAINT schema_migrations_pkey PRIMARY KEY (version)\n);\n\n\n-- public.snapshots definition\n--\n-- This table stores point-in-time snapshots\n-- of how much data each depositor has in the repo.\n--\n-- We may eventually delete this, but keep for now.\n--\nCREATE TABLE public.snapshots (\n\tid bigserial NOT NULL,\n\taudit_date timestamp NULL,\n\tinstitution_id int4 NULL,\n\tapt_bytes int8 NULL,\n\t\"cost\" numeric NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tsnapshot_type varchar NULL,\n\tcs_bytes int8 NULL,\n\tgo_bytes int8 NULL,\n\tCONSTRAINT snapshots_pkey PRIMARY KEY (id)\n);\n\n\n-- public.usage_samples definition\n--\n-- No idea what this was supposed to be, but the\n-- table never had any data in the production DB.\n-- Consider deleting this after we're sure it's not used.\n--\nCREATE TABLE public.usage_samples (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tinstitution_id varchar NULL,\n\t\"data\" text NULL,\n\tCONSTRAINT usage_samples_pkey PRIMARY KEY (id)\n);\n\n\n-- public.work_items definition\nCREATE TABLE public.work_items (\n\tid serial NOT NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tintellectual_object_id int4 NULL,\n\tgeneric_file_id int4 NULL,\n\t\"name\" varchar NULL,\n\tetag varchar NULL,\n\tbucket varchar NULL,\n\t\"user\" varchar NULL,\n\tnote text NULL,\n\t\"action\" varchar NULL,\n\tstage varchar NULL,\n\tstatus varchar NULL,\n\toutcome text NULL,\n\tbag_date timestamp NULL,\n\tdate_processed timestamp NULL,\n\tretry bool NOT NULL DEFAULT false,\n\tnode varchar(255) NULL,\n\tpid int4 NULL DEFAULT 0,\n\tneeds_admin_review bool NOT NULL DEFAULT false,\n\tinstitution_id int4 NULL,\n\tqueued_at timestamp NULL,\n\t\"size\" int8 NULL,\n\tstage_started_at timestamp NULL,\n\taptrust_approver varchar NULL,\n\tinst_approver varchar NULL,\n\tCONSTRAINT work_items_pkey PRIMARY KEY (id)\n);\nCREATE INDEX index_work_items_on_action ON public.work_items USING btree (action);\nCREATE INDEX index_work_items_on_date ON public.work_items USING btree (date_processed);\nCREATE INDEX index_work_items_on_etag_and_name ON public.work_items USING btree (etag, name);\nCREATE INDEX index_work_items_on_generic_file_id ON public.work_items USING btree (generic_file_id);\nCREATE INDEX index_work_items_on_institution_id ON public.work_items USING btree (institution_id);\nCREATE INDEX index_work_items_on_institution_id_and_date ON public.work_items USING btree (institution_id, date_processed);\nCREATE INDEX index_work_items_on_intellectual_object_id ON public.work_items USING btree (intellectual_object_id);\nCREATE INDEX index_work_items_on_stage ON public.work_items USING btree (stage);\nCREATE INDEX index_work_items_on_status ON public.work_items USING btree (status);\n\n\n-- public.checksums definition\nCREATE TABLE public.checksums (\n\tid serial NOT NULL,\n\talgorithm varchar NULL,\n\tdatetime timestamp NULL,\n\tdigest varchar NULL,\n\tgeneric_file_id int4 NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tCONSTRAINT checksums_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_89bb0866e7 FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_checksums_on_generic_file_id ON public.checksums USING btree (generic_file_id);\n\n\n-- public.storage_records definition\nCREATE TABLE public.storage_records (\n\tid bigserial NOT NULL,\n\tgeneric_file_id int4 NULL,\n\turl varchar NULL,\n\tCONSTRAINT storage_records_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_a126ea6adc FOREIGN KEY (generic_file_id) REFERENCES generic_files(id)\n);\nCREATE INDEX index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\n\n-- public.users definition\nCREATE TABLE public.users (\n\tid serial NOT NULL,\n\t\"name\" varchar NULL,\n\temail varchar NULL,\n\tphone_number varchar NULL,\n\tcreated_at timestamp NOT NULL,\n\tupdated_at timestamp NOT NULL,\n\tencrypted_password varchar NOT NULL DEFAULT ''::character varying,\n\treset_password_token varchar NULL,\n\treset_password_sent_at timestamp NULL,\n\tremember_created_at timestamp NULL,\n\tsign_in_count int4 NOT NULL DEFAULT 0,\n\tcurrent_sign_in_at timestamp NULL,\n\tlast_sign_in_at timestamp NULL,\n\tcurrent_sign_in_ip varchar NULL,\n\tlast_sign_in_ip varchar NULL,\n\tinstitution_id int4 NULL,\n\tencrypted_api_secret_key text NULL,\n\tpassword_changed_at timestamp NULL,\n\tencrypted_otp_secret varchar NULL,\n\tencrypted_otp_secret_iv varchar NULL,\n\tencrypted_otp_secret_salt varchar NULL,\n    encrypted_otp_sent_at timestamp NULL,\n\tconsumed_timestep int4 NULL,\n\totp_required_for_login bool NULL,\n\tdeactivated_at timestamp NULL,\n\tenabled_two_factor bool NULL DEFAULT false,\n\tconfirmed_two_factor bool NULL DEFAULT false,\n\totp_backup_codes _varchar NULL,\n\tauthy_id varchar NULL,\n\tlast_sign_in_with_authy timestamp NULL,\n\tauthy_status varchar NULL,\n\temail_verified bool NULL DEFAULT false,\n\tinitial_password_updated bool NULL DEFAULT false,\n\tforce_password_update bool NULL DEFAULT false,\n\taccount_confirmed bool NULL DEFAULT true,\n\tgrace_period timestamp NULL,\n    awaiting_second_factor boolean not null default false,\n    \"role\" varchar(50) NOT NULL default 'none',\n\tCONSTRAINT users_pkey PRIMARY KEY (id),\n\tCONSTRAINT fk_rails_7fcf39ca13 FOREIGN KEY (institution_id) REFERENCES institutions(id)\n);\nCREATE INDEX index_users_on_authy_id ON public.users USING btree (authy_id);\nCREATE UNIQUE INDEX index_users_on_email ON public.users USING btree (email);\nCREATE INDEX index_users_on_institution_id ON public.users USING btree (institution_id);\nCREATE INDEX index_users_on_password_changed_at ON public.users USING btree (password_changed_at);\nCREATE UNIQUE INDEX index_users_on_reset_password_token ON public.users USING btree (reset_password_token);\n\n-------------------------------------------------------------------------------\n-- New tables that were not part of Pharos.\n-- alerts              + join tables\n-- deletion_requests   + join tables\n-------------------------------------------------------------------------------\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index index_alerts_institution_id ON public.alerts (institution_id);\ncreate index index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table public.alerts_users (\n    alert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table public.alerts_work_items (\n    alert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index index_storage_options_name ON public.storage_options (\"name\");\n\n\n\n-------------------------------------------------------------------------------\n-- Functions\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: -- migrations.sql\n--\n-- This file contains ALL alterations that should be applied to the\n-- existing Pharos DB schema (as it exists in the feature/storage-option\n-- branch) to make it match schema.sql.\n--\n-- All operations in this file must be idempotent, so we can run it\n-- any number of times and always know that it will leave the DB in\n-- consistent and known state that matches schema.sql.\n--\n-- NOTE: When migrating old Pharos DB, we will also need to create the\n--       views in the schema.sql file.\n-------------------------------------------------------------------------------\n\n---------------------------------------------------------\n-- START OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n---------------------------------------------------------\n\n-- Drop legacy table from Pharos DB.\ndrop table if exists work_item_states;\n\n-- Create the storage_records table, with indexes.\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\tcreate table public.storage_records (\n    \tid bigserial not null,\n    \tgeneric_file_id int8 not null,\n    \turl varchar not null,\n    \tconstraint storage_records_pkey primary key (id),\n    \tconstraint fk_rails_a126ea6adc foreign key (generic_file_id) references generic_files(id)\n\t);\n\tcreate index if not exists index_storage_records_on_generic_file_id ON public.storage_records USING btree (generic_file_id);\n\tcreate unique index if not exists index_storage_records_on_url ON public.storage_records(\"url\");\n  end if;\nend\n$$;\n\n-- Add column generic_files.uuid.\nalter table generic_files add column if not exists \"uuid\" varchar;\n\n-- Copy uuid from uri into uuid field.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\tupdate generic_files set uuid=split_part(uri, '/', 5);\n  end if;\nend\n$$;\n\n-- Change generic_files.uuid to not null and add a unique index.\ndo\n$$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uuid' and is_nullable = 'YES') then\n  \talter table generic_files alter column \"uuid\" set not null;\n\tcreate unique index if not exists index_generic_files_on_uuid on generic_files(uuid);\n  end if;\nend\n$$;\n\n-- Copy generic_files.uri from storage_records.url.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='generic_files' AND column_name='uri') then\n\n  \t  -- Get the intial URL. All items, regadless of storage option, have one URL.\n      -- The inner if statement makes sure this hasn't already run. (Prevents duplicate inserts.)\n\t  if exists (select 1 from information_schema.columns where table_schema='public' AND table_name='storage_records') then\n\t    if not exists (select 1 from storage_records where length(url) > 0) then\n\t\t  insert into storage_records (generic_file_id, url) select id, uri from generic_files gf order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- For items in standard storage, we need to add a Glacier URL. URLs differ per environment, so we check.\n\t  -- In each case, the inner if statement tries to ensure that these inserts have not already run.\n\n\t  -- Production\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.preservation.storage/', '/aptrust.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.preservation.storage/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Test/Demo\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.test.preservation.oregon/%') then\n\t      insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.test.preservation/', '/aptrust.test.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.test.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n\t  -- Staging\n\t  if exists (select 1 from generic_files gf where uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%') then\n\t    if not exists (select 1 from storage_records where url like 'https://s3.amazonaws.com/aptrust.staging.preservation.oregon/%') then\n\t\t  insert into storage_records(generic_file_id, url)\n\t\t  select gf.id, replace(uri, '/aptrust.staging.preservation/', '/aptrust.staging.preservation.oregon/') from generic_files gf\n\t\t  where gf.uri like 'https://s3.amazonaws.com/aptrust.staging.preservation/%' order by gf.id;\n\t\tend if;\n\t  end if;\n\n  end if;\nend\n$$;\n\n-- Now remove generic_files.uri, since the data is now in storage_records\nalter table generic_files drop column if exists uri;\n\n-------------------------------------------------------\n-- END OF PHAROS MASTER -> STORAGE RECORD MIGRATIONS --\n-------------------------------------------------------\n\n-- The premis_events.date_time column is varchar, but it should be\n-- timestamp. We need to change it. This change may fail if 1) there\n-- are invalid or badly formatted dates in the date_time column, or\n-- 2) if any views referencing premis_events.date_time already exist.\n-- Drop premis_events_view if necessary and recreate it after this alteration.\n--\n-- This change may take a long time, as premis_events has over 100M rows.\ndo\n$$\nbegin\n\tif exists(\n\t\tselect 1 from information_schema.columns\n\t\twhere table_schema = 'public'\n\t\tand table_name = 'premis_events'\n\t\tand column_name = 'date_time'\n\t\tand data_type = 'character varying')\n\tthen\n\t\talter table premis_events alter column date_time type timestamp\n\t\tusing TO_TIMESTAMP(date_time, 'YYYY-MM-DDTHH24:MI:SS');\n\tend if;\nend\n$$;\n\n-- We need to fix the user role structure. Pharos allows a user to have\n-- multiple roles at a single institution, though our business rules disallow\n-- that, and no user has ever had more than one role. To simplify the DB\n-- and our queries, we need to do the following:\n--\n-- 1. Create a role column in the users table.\n-- 2. Populate that column with the value with each user's role from\n--    user -> roles_user -> roles.\n-- 3. Drop the roles_users table.\n-- 4. Drop the roles table.\n\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='role') then\n \talter table users add column \"role\" varchar(50) not null default 'none';\n \tupdate users u set \"role\" = coalesce((select r.name from \"roles\" r inner join roles_users ru on ru.role_id = r.id where ru.user_id = u.id), 'none');\n    drop table if exists roles_users;\n    drop table if exists roles;\n  end if;\nend\n$$;\n\n-- Add awaiting_second_factor\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='awaiting_second_factor') then\n \talter table users add column \"awaiting_second_factor\" boolean not null default false;\n  end if;\nend\n$$;\n\n-- Add encrypted_otp_sent_at\ndo $$\nbegin\n  if not exists (select 1 from information_schema.columns where table_schema='public' AND table_name='users' AND column_name='encrypted_otp_sent_at') then\n \talter table users add column \"encrypted_otp_sent_at\" timestamp null;\n  end if;\nend\n$$;\n\n\n-- The ingest_state columns were part of a proposed architecture we never\n-- implemented. They have never been used, and we don't need them.\nalter table intellectual_objects drop column if exists ingest_state;\nalter table generic_files drop column if exists ingest_state;\n\n\n-- intellectual_objects.bag_group_identifier is almost always empty.\n-- Make this column nullable to ease inserts.\nalter table intellectual_objects alter column bag_group_identifier drop not null;\n\n\n-- Remove object_identifier and generic_file_identifier from work_items.\n-- We can use a view to join the files & objects tables, avoiding the\n-- duplicate data.\nalter table work_items drop column if exists object_identifier;\nalter table work_items drop column if exists generic_file_identifier;\n\n-- The work_items.date column actually refers to the datetime on which\n-- the item was last processed by one of our Go workers. The name \"date\"\n-- is too vague and ambiguous, so let's call it what it is.\ndo $$\nbegin\n  if exists (select 1 from information_schema.columns\n    where table_schema='public' AND table_name='work_items' AND column_name='date') then\n    alter table work_items rename column \"date\" to \"date_processed\";\n  end if;\nend\n$$;\n\n-- Update the indexes on work_items to reflect the change from date to\n-- date_processed.\n\ndrop index if exists index_work_items_on_date;\ndrop index if exists index_work_items_on_institution_id_and_date;\n\ncreate index if not exists index_work_items_on_date_processed on work_items(date_processed);\ncreate index if not exists index_work_items_on_inst_id_and_date_processed on work_items(institution_id, date_processed);\n\n-- These columns are unnecessary in the premis_events table.\n-- We can get them by joining other tables in a view.\n-- This will have a large impact on storage space, since these\n-- two fields together average ~100 bytes per record, and as of\n-- Jan. 2021, we have around 120M records. Dropping these columns\n-- also drops the indexes on these two columns, which are huge and\n-- are rarely used.\nalter table premis_events drop column if exists intellectual_object_identifier;\nalter table premis_events drop column if exists generic_file_identifier;\n\n-- Get rid of useless indexes. We can add these back if they actually turn\n-- out to be useful.\n--\n-- generic_files\ndrop index if exists index_files_on_inst_state_and_format;\ndrop index if exists index_files_on_inst_state_and_updated;\ndrop index if exists index_generic_files_on_file_format;\ndrop index if exists index_generic_files_on_file_format_and_state;\ndrop index if exists index_generic_files_on_institution_id_and_size_and_state;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_file_format;\ndrop index if exists index_generic_files_on_intellectual_object_id_and_state;\ndrop index if exists index_generic_files_on_size;\ndrop index if exists index_generic_files_on_size_and_state;\ndrop index if exists index_generic_files_on_state;\ndrop index if exists index_generic_files_on_state_and_updated_at;\n\n-- intellectual_objects\ndrop index if exists index_intellectual_objects_on_access;\ndrop index if exists index_intellectual_objects_on_institution_id_and_state;\ndrop index if exists index_intellectual_objects_on_state;\n\n-- premis_events\ndrop index if exists index_premis_events_on_generic_file_id_and_event_type;\ndrop index if exists index_premis_events_on_identifier_and_institution_id;\n\n-- institutions\ncreate unique index if not exists index_institutions_identifier on institutions using btree(identifier);\ncreate unique index if not exists index_institutions_receiving_bucket on institutions using btree(receiving_bucket);\ncreate unique index if not exists index_institutions_restore_bucket on institutions using btree(restore_bucket);\n\n-- Allow institutions to turn spot restoration tests on or off.\n-- Default is off.\nalter table institutions add column if not exists enable_spot_restore boolean not null default false;\n\n-- ********************************************************************\n--\n-- Add tables for alerts and deletions that did not exist in Pharos\n--\n-- ********************************************************************\n\n-- deletion_requests track requests for file and object deletions,\n-- who initiated them and who approved them\ncreate table if not exists public.deletion_requests (\n\tid bigserial primary key,\n\tinstitution_id integer not null references public.institutions(id),\n\trequested_by_id integer not null references public.users(id),\n\trequested_at timestamp not null,\n\tencrypted_confirmation_token varchar not null,\n\tconfirmed_by_id integer references public.users(id),\n\tconfirmed_at timestamp,\n\tcancelled_by_id integer references public.users(id),\n\tcancelled_at timestamp,\n    work_item_id integer null references public.work_items(id)\n);\ncreate index if not exists index_deletion_requests_institution_id ON public.deletion_requests (institution_id);\n\n\n-- deletion_requests_generic_files records which files belong to a deletion request\ncreate table if not exists public.deletion_requests_generic_files (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tgeneric_file_id integer not null references public.generic_files(id)\n);\ncreate unique index if not exists index_drgf_unique ON public.deletion_requests_generic_files (deletion_request_id, generic_file_id);\n\n-- deletion_requests_intellectual_objects records which objects belong to a deletion request\ncreate table if not exists public.deletion_requests_intellectual_objects (\n\tdeletion_request_id integer not null references public.deletion_requests(id),\n\tintellectual_object_id integer not null references public.intellectual_objects(id)\n);\ncreate unique index if not exists index_drio_unique ON public.deletion_requests_intellectual_objects (deletion_request_id, intellectual_object_id);\n\n\n-- alerts stores the content of alert messages. These messages appear in the web UI\n-- and may also be emailed to users, depending on the alert type.\n-- Column deletion_request_id will typically be null.\ncreate table if not exists public.alerts (\n\tid bigserial primary key,\n\tinstitution_id integer references public.institutions(id),\n\t\"type\" varchar not null,\n    \"subject\" varchar not null,\n\t\"content\" text not null,\n\tdeletion_request_id integer references public.deletion_requests(id),\n\tcreated_at timestamp not null\n);\ncreate index if not exists index_alerts_institution_id ON public.alerts (institution_id);\ncreate index if not exists index_alerts_type ON public.alerts (\"type\");\n\n\n-- alerts_users tracks which users should see which alerts. Depending on alert.type,\n-- the message may be emailed to the user (for example, a deletion approval alert),\n-- or it may simply be displayed in the web UI.\ncreate table if not exists public.alerts_users (\n\talert_id integer not null references public.alerts(id),\n\tuser_id integer not null references public.users(id),\n\tsent_at timestamp default null,\n\tread_at timestamp default null\n);\ncreate index if not exists index_alerts_users_alert_id ON public.alerts_users (alert_id);\ncreate index if not exists index_alerts_users_user_id ON public.alerts_users (user_id);\ncreate unique index if not exists index_alerts_users_unique ON public.alerts_users (alert_id, user_id);\n\n\n-- alerts_work_items link an alerts to one or more work items.\ncreate table if not exists public.alerts_work_items (\n\talert_id integer not null references public.alerts(id),\n\twork_item_id integer not null references public.work_items(id)\n);\ncreate index if not exists index_alerts_work_items_alert_id ON public.alerts_work_items (alert_id);\ncreate unique index if not exists index_alerts_work_items_unique ON public.alerts_work_items (alert_id, work_item_id);\n\n\n-- alerts_premis_events link alerts to one or more premis_events.\ncreate table if not exists public.alerts_premis_events (\n\talert_id integer not null references public.alerts(id),\n\tpremis_event_id integer not null references public.premis_events(id)\n);\ncreate index if not exists index_alerts_premis_events_alert_id ON public.alerts_premis_events(alert_id);\ncreate unique index if not exists index_alerts_premis_events_unique ON public.alerts_premis_events(alert_id, premis_event_id);\n\n\n-- storage_options contains info about storage options that we use\n-- to calculate monthly bills.\ncreate table if not exists public.storage_options (\n\tid bigserial primary key,\n\t\"provider\" varchar not null,\n    \"service\" varchar not null,\n    \"region\" varchar not null,\n    \"name\" varchar not null,\n    cost_gb_per_month decimal(12,8) not null,\n    \"comment\" varchar not null,\n\tupdated_at timestamp not null\n);\ncreate unique index if not exists index_storage_options_name ON public.storage_options (\"name\");\n\n-- In Pharos DB, many generic_file_ids in premis_events are set to zero when they should be null.\n-- Fix that here.\nupdate premis_events set generic_file_id = null where generic_file_id = 0;\n\n-- In Pharos, the Devise auth system leaves stale password reset data forever.\n-- We have to clear these values in Registry, or all users will be stuck in\n-- the \"please finish resetting your password\" loop forever. We have no idea\n-- what reset tokens Devise sent two years ago, so no one will be able to\n-- unlock their accounts.\nupdate users set reset_password_token = null, reset_password_sent_at = null;\n\n\n-------------------------------------------------------------------------------\n-- Functions\n--\n-- Fuctions are defined in schema.sql as well. Adding them to migrations\n-- ensures they'll be present in converted DB.\n-------------------------------------------------------------------------------\n\nCREATE OR REPLACE FUNCTION create_constraint_if_not_exists (t_name text, c_name text, constraint_sql text)\n  RETURNS void\nAS\n$BODY$\n  begin\n    -- Look for our constraint\n    if not exists (select constraint_name\n                   from information_schema.constraint_column_usage\n                   where table_name = t_name  and constraint_name = c_name) then\n        execute 'ALTER TABLE ' || t_name || ' ADD CONSTRAINT ' || c_name || ' ' || constraint_sql;\n    end if;\nend;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: -------------------------------------------------------------------------------\n-- Views\n-------------------------------------------------------------------------------\n\n-- Create a view to pull in columns that used to be in the WorkItems table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view work_items_view as\nselect\n\twi.id,\n\twi.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\twi.intellectual_object_id,\n\tio.identifier as \"object_identifier\",\n\tio.alt_identifier,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\twi.generic_file_id,\n\tgf.identifier as \"generic_file_identifier\",\n\twi.\"name\",\n\twi.etag,\n\twi.bucket,\n\twi.\"user\",\n\twi.note,\n\twi.\"action\",\n\twi.stage,\n\twi.status,\n\twi.outcome,\n\twi.bag_date,\n\twi.date_processed,\n\twi.retry,\n\twi.node,\n\twi.pid,\n\twi.needs_admin_review,\n\twi.\"size\",\n\twi.queued_at,\n\twi.stage_started_at,\n\twi.aptrust_approver,\n\twi.inst_approver,\n\twi.created_at,\n\twi.updated_at\nfrom work_items wi\nleft join institutions i on wi.institution_id = i.id\nleft join intellectual_objects io on wi.intellectual_object_id = io.id\nleft join generic_files gf on wi.generic_file_id = gf.id;\n\n\n-- Create a view to pull in columns that used to be in the PremisEvents table.\n-- These include intellectual_object_identifier and generic_file_identifier.\ncreate or replace view premis_events_view as\nselect\n\tpe.id,\n\tpe.identifier,\n\tpe.institution_id,\n\ti.\"name\" as institution_name,\n\tpe.intellectual_object_id,\n\tio.identifier as intellectual_object_identifier,\n\tpe.generic_file_id,\n\tgf.identifier as generic_file_identifier,\n\tpe.event_type,\n\tpe.date_time,\n\tpe.detail,\n\tpe.outcome,\n\tpe.outcome_detail,\n\tpe.outcome_information,\n\tpe.\"object\",\n\tpe.agent,\n\tpe.created_at,\n\tpe.updated_at,\n\tpe.old_uuid\nfrom premis_events pe\nleft join institutions i on pe.institution_id = i.id\nleft join intellectual_objects io on pe.intellectual_object_id = io.id\nleft join generic_files gf on pe.generic_file_id = gf.id;\n\n\n-- users_view makes it easier to list and search on institution-related\n-- attributes for users.\ncreate or replace view users_view as\nselect\n\tu.id,\n\tu.\"name\",\n\tu.email,\n\tu.phone_number,\n\tu.created_at,\n\tu.updated_at,\n\tu.reset_password_sent_at,\n\tu.remember_created_at,\n\tu.sign_in_count,\n\tu.current_sign_in_at,\n\tu.last_sign_in_at,\n\tu.current_sign_in_ip,\n\tu.last_sign_in_ip,\n\tu.institution_id,\n\tu.password_changed_at,\n\tu.consumed_timestep,\n\tu.otp_required_for_login,\n\tu.deactivated_at,\n\tu.enabled_two_factor,\n\tu.confirmed_two_factor,\n\tu.authy_id,\n\tu.last_sign_in_with_authy,\n\tu.authy_status,\n\tu.email_verified,\n\tu.initial_password_updated,\n\tu.force_password_update,\n\tu.account_confirmed,\n\tu.grace_period,\n\tu.\"role\",\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.state as institution_state,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id,\n\ti2.\"name\" as member_institution_name,\n\ti2.identifier as member_institution_identifier,\n\ti2.state as member_institution_state,\n\ti.otp_enabled,\n\ti.receiving_bucket,\n\ti.restore_bucket\nfrom users u\nleft join institutions i on u.institution_id = i.id\nleft join institutions i2 on i.member_institution_id = i2.id;\n\n\n-- institutions_view shows an institution along with essential\n-- information about its parent, if it has a parent.\n\ncreate or replace view institutions_view as\nselect\n\ti.id,\n\ti.\"name\",\n\ti.identifier,\n\ti.state,\n\ti.\"type\",\n\ti.deactivated_at,\n\ti.otp_enabled,\n\ti.enable_spot_restore,\n\ti.receiving_bucket,\n\ti.restore_bucket,\n\ti.created_at,\n\ti.updated_at,\n\ti.member_institution_id as \"parent_id\",\n\tparent.\"name\" as \"parent_name\",\n\tparent.identifier as \"parent_identifier\",\n\tparent.state as \"parent_state\",\n\tparent.deactivated_at as \"parent_deactivated_at\"\nfrom institutions i\nleft join institutions parent on i.member_institution_id = parent.id;\n\n-- intellectual_objects_view\n\ncreate or replace view intellectual_objects_view as\nselect\n\tio.id,\n\tio.title,\n\tio.description,\n\tio.identifier,\n\tio.alt_identifier,\n\tio.access,\n\tio.bag_name,\n\tio.institution_id,\n\tio.state,\n\tio.etag,\n\tio.bag_group_identifier,\n\tio.storage_option,\n\tio.bagit_profile_identifier,\n\tio.source_organization,\n\tio.internal_sender_identifier,\n\tio.internal_sender_description,\n\tio.created_at,\n\tio.updated_at,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ti.\"type\" as institution_type,\n\ti.member_institution_id as institution_parent_id,\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A') as \"size\",\n\t(select count(*) from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_file_count\",\n\t(select sum(gf.\"size\") from generic_files gf where gf.intellectual_object_id = io.id and gf.state = 'A' and identifier like concat(io.identifier, '/data/%')) as \"payload_size\"\nfrom intellectual_objects io\nleft join institutions i on io.institution_id = i.id;\n\n-- deletion_requests_view\n\ncreate or replace view deletion_requests_view as\nselect dr.id,\n       dr.institution_id,\n       i.\"name\" as institution_name,\n       i.identifier as institution_identifier,\n       dr.requested_by_id,\n       req.\"name\" as requested_by_name,\n       req.email as requested_by_email,\n       dr.requested_at,\n       dr.confirmed_by_id,\n       conf.\"name\" as confirmed_by_name,\n       conf.email as confirmed_by_email,\n       dr.confirmed_at,\n       dr.cancelled_by_id,\n       can.\"name\" as cancelled_by_name,\n       can.email as cancelled_by_email,\n       dr.cancelled_at,\n       (select count(*) from deletion_requests_generic_files drgf where drgf.deletion_request_id = dr.id) as file_count,\n       (select count(*) from deletion_requests_intellectual_objects drio where drio.deletion_request_id = dr.id) as object_count,\n       dr.work_item_id,\n       wi.stage,\n       wi.status,\n       wi.date_processed,\n       wi.\"size\",\n       wi.note\nfrom deletion_requests dr\nleft join institutions i on dr.institution_id = i.id\nleft join users req on dr.requested_by_id = req.id\nleft join users conf on dr.confirmed_by_id = conf.id\nleft join users can on dr.confirmed_by_id = can.id\nleft join work_items wi on dr.work_item_id = wi.id;\n\n-- alerts view\n\ncreate or replace view alerts_view as\nselect\n\ta.id,\n\ta.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\ta.\"type\",\n\ta.subject,\n\ta.\"content\",\n\ta.deletion_request_id,\n\ta.created_at,\n\tau.user_id,\n\tu.\"name\" as user_name,\n\tau.sent_at,\n\tau.read_at\nfrom alerts a\nleft join alerts_users au on a.id = au.alert_id\nleft join users u on au.user_id = u.id\nleft join institutions i on a.institution_id = i.id;\n\n-- storage_option_stats\ncreate or replace view storage_option_stats as\nwith stats as (\n\tselect\n\t\tsum(\"gf\".\"size\") as total_bytes,\n\t\tcount(*) as file_count,\n\t\tgf.institution_id,\n\t\tgf.storage_option\n\tfrom generic_files gf\n\twhere gf.state = 'A'\n\tgroup by rollup (gf.institution_id, gf.storage_option)\n\t)\nselect\n\ts.total_bytes,\n\ts.file_count,\n\ts.institution_id,\n\ts.storage_option,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier\nfrom stats s\nleft join institutions i on s.institution_id = i.id;\n\ncreate or replace view generic_files_view as\nselect\n\tgf.id,\n\tgf.file_format,\n\tgf.\"size\",\n\tgf.identifier,\n\tgf.intellectual_object_id,\n\tio.identifier as object_identifier,\n\tio.\"access\",\n\tgf.state,\n\tgf.last_fixity_check,\n\tgf.institution_id,\n\ti.\"name\" as institution_name,\n\ti.identifier as institution_identifier,\n\tgf.storage_option,\n\tgf.uuid,\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='md5' order by created_at desc limit 1) as \"md5\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha1' order by created_at desc limit 1) as \"sha1\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha256' order by created_at desc limit 1) as \"sha256\",\n\t(select digest from checksums where generic_file_id = gf.id and algorithm='sha512' order by created_at desc limit 1) as \"sha512\",\n\tgf.created_at,\n\tgf.updated_at\nfrom generic_files gf\nleft join intellectual_objects io on io.id = gf.intellectual_object_id\nleft join institutions i on i.id = gf.institution_id;\n\n-- Checksums view\ncreate or replace view checksums_view as\nselect cs.id,\n       cs.algorithm,\n       cs.datetime,\n       cs.digest,\n       gf.state,\n       gf.identifier as \"generic_file_identifier\",\n       cs.generic_file_id,\n       gf.intellectual_object_id,\n       gf.institution_id,\n       cs.created_at,\n       cs.updated_at\nfrom checksums cs\nleft join generic_files gf on cs.generic_file_id = gf.id;\n\n\n---------------------------------------------------------------------------\n--\n-- Count Views\n--\n-- We create these views because count queries on large tables are slow\n-- in postgres. Even if a query can use an index to get a count, it still\n-- has to scan every row in the result set to see if that row is visible\n-- under postgres' mvcc rules. \n--\n-- If the count returns a million rows, postgres has to scan all million\n-- rows. The result is a query that can take 5-15 seconds. The \n-- premis_events table is the worst of the lot. It should surpass 200M\n-- rows by the end of 2022. We do not want to scan those rows every time\n-- someone hits the events page or the events API endpoint.\n--\n-- We run count queries all the time to manage paging in both the web UI\n-- and the API. For large counts, such as \"all events for an institution\",\n-- or \"all files for an institution\", we'll use the counts in the views\n-- below. \n--\n-- For smaller counts, such as \"all files for my institution created \n-- within the past week\", we'll suck it up and let postgres scan the \n-- smaller row sets.\n--\n-- These views will be refreshed every hour or so using an async go \n-- routine so they don't slow down web and API requests.\n--\n-- That means some large counts may be up to an hour out of date, but we\n-- can live with that tradeoff, since this will vastly speed up the loading\n-- of our most commonly hit web and API endpoints.\n--\n-- Note the function update_counts() below. It refreshes all of the count\n-- views.\n-- \n---------------------------------------------------------------------------\n\n-- premis_event_counts\ncreate materialized view if not exists premis_event_counts as\n\tselect institution_id, count(id) as row_count, event_type, outcome\n\tfrom premis_events group by cube(institution_id, event_type, outcome)\n\torder by institution_id, event_type, outcome;\n\n-- intellectual_object_counts\ncreate materialized view if not exists intellectual_object_counts as\n\tselect institution_id, count(id) as row_count, \"state\" \n\tfrom intellectual_objects group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- generic_file_counts\ncreate materialized view if not exists generic_file_counts as\n\tselect institution_id, count(id) as row_count, \"state\"\n\tfrom generic_files group by cube(institution_id, \"state\")\n\torder by institution_id, state; \n\n-- work_item_counts\ncreate materialized view if not exists work_item_counts as\n\tselect institution_id, count(id) as row_count, \"action\"\n\tfrom work_items group by cube(institution_id, \"action\")\n\torder by institution_id, \"action\";\n\n-- \nCREATE OR REPLACE FUNCTION update_counts ()\n  RETURNS integer\nAS\n$BODY$\n  begin\n    refresh materialized view premis_event_counts;\n    refresh materialized view intellectual_object_counts;\n    refresh materialized view generic_file_counts;\n    refresh materialized view work_item_counts;    \n    return 1;\n  end;\n$BODY$\nLANGUAGE plpgsql VOLATILE;\n"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"storage_options\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_options.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"institutions\" from '/Users/diamond/aptrust/registry/db/fixtures/institutions.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"users\" from '/Users/diamond/aptrust/registry/db/fixtures/users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"checksums\" from '/Users/diamond/aptrust/registry/db/fixtures/checksums.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"storage_records\" from '/Users/diamond/aptrust/registry/db/fixtures/storage_records.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"deletion_requests\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"deletion_requests_generic_files\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_generic_files.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"deletion_requests_intellectual_objects\" from '/Users/diamond/aptrust/registry/db/fixtures/deletion_requests_intellectual_objects.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"alerts\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"alerts_premis_events\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_premis_events.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"alerts_users\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_users.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: copy \"alerts_work_items\" from '/Users/diamond/aptrust/registry/db/fixtures/alerts_work_items.csv' csv header"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_options', 'id'), MAX(id)) FROM \"storage_options\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('institutions', 'id'), MAX(id)) FROM \"institutions\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('users', 'id'), MAX(id)) FROM \"users\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('intellectual_objects', 'id'), MAX(id)) FROM \"intellectual_objects\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('generic_files', 'id'), MAX(id)) FROM \"generic_files\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('checksums', 'id'), MAX(id)) FROM \"checksums\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('storage_records', 'id'), MAX(id)) FROM \"storage_records\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('premis_events', 'id'), MAX(id)) FROM \"premis_events\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('work_items', 'id'), MAX(id)) FROM \"work_items\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('deletion_requests', 'id'), MAX(id)) FROM \"deletion_requests\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT setval(pg_get_serial_sequence('alerts', 'id'), MAX(id)) FROM \"alerts\";"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: select update_counts();"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'system@aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"institution\".\"id\", \"institution\".\"created_at\", \"institution\".\"updated_at\", \"institution\".\"name\", \"institution\".\"identifier\", \"institution\".\"state\", \"institution\".\"type\", \"institution\".\"member_institution_id\", \"institution\".\"deactivated_at\", \"institution\".\"otp_enabled\", \"institution\".\"enable_spot_restore\", \"institution\".\"receiving_bucket\", \"institution\".\"restore_bucket\" FROM \"institutions\" AS \"institution\" WHERE ((identifier = 'aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:40.601322+00:00:00', \"name\" = 'APTrust System', \"email\" = 'system@aptrust.org', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 2, \"current_sign_in_at\" = '2022-06-22 17:30:40.601312+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = '127.0.0.1', \"institution_id\" = 1, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'admin' WHERE \"user\".\"id\" = 1"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"info","status":302,"method":"POST","path":"/users/sign_in","ip":"","latency":78.710229,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" ORDER BY \"date_processed\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = 1)) ORDER BY \"created_at\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (0 = 0 or i.id = 0)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2022-06-22 17:30:40.616958+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2022-06-22 17:30:40.616958+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"info","status":200,"method":"GET","path":"/dashboard","ip":"","latency":32.59974,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:40.711465+00:00:00', \"name\" = 'Inst One Admin', \"email\" = 'admin@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 1, \"current_sign_in_at\" = '2022-06-22 17:30:40.711465+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = NULL, \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_admin' WHERE \"user\".\"id\" = 2"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"info","status":302,"method":"POST","path":"/users/sign_in","ip":"","latency":74.922419,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = 2)) ORDER BY \"date_processed\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = 2)) ORDER BY \"created_at\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (2 = 0 or i.id = 2)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2022-06-22 17:30:40.717935+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2022-06-22 17:30:40.717935+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"info","status":200,"method":"GET","path":"/dashboard","ip":"","latency":22.160138,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:40.807815+00:00:00', \"name\" = 'Inst One User', \"email\" = 'user@inst1.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$raEJqJ7eRcEwWmeoiJ2vxenR8dqVXCI1SU9zcgkrxeS.6/haWGi4K', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 2, \"current_sign_in_at\" = '2022-06-22 17:30:40.807814+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = NULL, \"institution_id\" = 2, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 3"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"info","status":302,"method":"POST","path":"/users/sign_in","ip":"","latency":73.581202,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = 2)) ORDER BY \"date_processed\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = 3)) ORDER BY \"created_at\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (2 = 0 or i.id = 2)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2022-06-22 17:30:40.81556+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2022-06-22 17:30:40.81556+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"info","status":200,"method":"GET","path":"/dashboard","ip":"","latency":25.863162,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@inst2.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:40.909353+00:00:00', \"name\" = 'Inst Two Admin', \"email\" = 'admin@inst2.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 1, \"current_sign_in_at\" = '2022-06-22 17:30:40.909353+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = NULL, \"institution_id\" = 3, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_admin' WHERE \"user\".\"id\" = 5"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: COMMIT"}
{"level":"info","status":302,"method":"POST","path":"/users/sign_in","ip":"","latency":75.113149,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = 3)) ORDER BY \"date_processed\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = 5)) ORDER BY \"created_at\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (3 = 0 or i.id = 3)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2022-06-22 17:30:40.916201+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2022-06-22 17:30:40.916201+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"info","status":200,"method":"GET","path":"/dashboard","ip":"","latency":21.737092,"user-agent":"","time":"2022-06-22T13:30:40-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:40-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst2.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-01-12 17:14:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:41.004775+00:00:00', \"name\" = 'Inst Two User', \"email\" = 'user@inst2.edu', \"phone_number\" = '+14345551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 1, \"current_sign_in_at\" = '2022-06-22 17:30:41.004774+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = NULL, \"institution_id\" = 3, \"encrypted_api_secret_key\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = NULL, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = TRUE, \"initial_password_updated\" = TRUE, \"force_password_update\" = NULL, \"grace_period\" = '1999-12-31 23:59:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 7"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: COMMIT"}
{"level":"info","status":302,"method":"POST","path":"/users/sign_in","ip":"","latency":73.648052,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = 3)) ORDER BY \"date_processed\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = 7)) ORDER BY \"created_at\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (3 = 0 or i.id = 3)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2022-06-22 17:30:41.013485+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2022-06-22 17:30:41.013485+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"info","status":200,"method":"GET","path":"/dashboard","ip":"","latency":25.267151,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'sms_user@example.com'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: BEGIN"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: UPDATE \"users\" AS \"user\" SET \"created_at\" = '2021-09-10 14:25:00+00:00:00', \"updated_at\" = '2022-06-22 17:30:41.104334+00:00:00', \"name\" = 'Two Factor SMS User', \"email\" = 'sms_user@example.com', \"phone_number\" = '+12125551212', \"encrypted_password\" = '$2a$10$7aoot2KFFqikpTYVEbErYOxZijCHDPvqT4OMoFwdmsYBE9SK2PibC', \"reset_password_token\" = NULL, \"reset_password_sent_at\" = NULL, \"remember_created_at\" = NULL, \"sign_in_count\" = 1, \"current_sign_in_at\" = '2022-06-22 17:30:41.104334+00:00:00', \"last_sign_in_at\" = NULL, \"current_sign_in_ip\" = NULL, \"last_sign_in_ip\" = NULL, \"institution_id\" = 2, \"encrypted_api_secret_key\" = NULL, \"password_changed_at\" = NULL, \"encrypted_otp_secret\" = NULL, \"encrypted_otp_secret_iv\" = NULL, \"encrypted_otp_secret_salt\" = NULL, \"encrypted_otp_sent_at\" = NULL, \"consumed_timestep\" = NULL, \"otp_required_for_login\" = TRUE, \"deactivated_at\" = NULL, \"enabled_two_factor\" = NULL, \"confirmed_two_factor\" = NULL, \"otp_backup_codes\" = NULL, \"authy_id\" = NULL, \"last_sign_in_with_authy\" = NULL, \"authy_status\" = NULL, \"email_verified\" = NULL, \"initial_password_updated\" = NULL, \"force_password_update\" = TRUE, \"grace_period\" = '2021-11-09 05:00:00+00:00:00', \"awaiting_second_factor\" = FALSE, \"role\" = 'institutional_user' WHERE \"user\".\"id\" = 6"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: COMMIT"}
{"level":"info","status":302,"method":"POST","path":"/users/sign_in","ip":"","latency":74.372512,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 6))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = 2)) ORDER BY \"date_processed\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = 6)) ORDER BY \"created_at\" desc LIMIT 10"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: \n\t\tselect\n\t\t  coalesce(stats.institution_name, 'Total') as institution_name,\n\t\t  i2.id as institution_id,\n\t\t  coalesce(stats.storage_option, 'Total') as storage_option,\n\t\t  stats.file_count,\n\t\t  stats.object_count,\n\t\t  stats.total_bytes,\n\t\t  (stats.total_bytes / 1073741824) as total_gb,\n\t\t  (stats.total_bytes / 1099511627776) as total_tb,\n\t\t  so.cost_gb_per_month,\n\t\t  ((stats.total_bytes / 1073741824) * so.cost_gb_per_month) as monthly_cost\n\t\tfrom\n\t\t  (select\n\t\t\ti.\"name\" as institution_name,\n\t\t\tcount(gf.id) as file_count,\n\t\t\tcount(distinct(gf.intellectual_object_id)) as object_count,\n\t\t\tsum(gf.size) as total_bytes,\n\t\t\tgf.storage_option\n\t\t  from generic_files gf\n\t\t  left join institutions i on i.id = gf.institution_id\n\t\t  where gf.state = 'A'\n\t\t  and (2 = 0 or i.id = 2)\n\t\t  and ('' = '' or gf.storage_option = '')\n\t\t  and ('2022-06-22 17:30:41.113574+00:00:00' = '0001-01-01 00:00:00+00:00:00' or gf.updated_at < '2022-06-22 17:30:41.113574+00:00:00')\n\t\t  group by cube (i.\"name\", gf.storage_option)) stats\n\t\tleft join storage_options so on so.\"name\" = stats.storage_option\n\t\tleft join institutions i2 on i2.\"name\" = stats.institution_name\n\t\torder by stats.institution_name, stats.storage_option\n"}
{"level":"info","status":200,"method":"GET","path":"/dashboard","ip":"","latency":24.646257,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'system@aptrust.org'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst1.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'admin@inst2.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'user@inst2.edu'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"email\" = 'sms_user@example.com'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert\".\"id\", \"alert\".\"institution_id\", \"alert\".\"type\", \"alert\".\"subject\", \"alert\".\"content\", \"alert\".\"deletion_request_id\", \"alert\".\"created_at\", \"deletion_request\".\"id\" AS \"deletion_request__id\", \"deletion_request\".\"institution_id\" AS \"deletion_request__institution_id\", \"deletion_request\".\"requested_by_id\" AS \"deletion_request__requested_by_id\", \"deletion_request\".\"requested_at\" AS \"deletion_request__requested_at\", \"deletion_request\".\"encrypted_confirmation_token\" AS \"deletion_request__encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\" AS \"deletion_request__confirmed_by_id\", \"deletion_request\".\"confirmed_at\" AS \"deletion_request__confirmed_at\", \"deletion_request\".\"cancelled_by_id\" AS \"deletion_request__cancelled_by_id\", \"deletion_request\".\"cancelled_at\" AS \"deletion_request__cancelled_at\", \"deletion_request\".\"work_item_id\" AS \"deletion_request__work_item_id\" FROM \"alerts\" AS \"alert\" LEFT JOIN \"deletion_requests\" AS \"deletion_request\" ON \"deletion_request\".\"id\" = \"alert\".\"deletion_request_id\" WHERE ((\"alert\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alerts_premis_events\".*, \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" JOIN \"alerts_premis_events\" AS \"alerts_premis_events\" ON (\"alerts_premis_events\".\"alert_id\") IN (1) WHERE (\"premis_event\".\"id\" = \"alerts_premis_events\".\"premis_event_id\")"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alerts_users\".*, \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\" FROM \"users\" AS \"user\" JOIN \"alerts_users\" AS \"alerts_users\" ON (\"alerts_users\".\"alert_id\") IN (1) WHERE (\"user\".\"id\" = \"alerts_users\".\"user_id\")"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alerts_work_items\".*, \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" JOIN \"alerts_work_items\" AS \"alerts_work_items\" ON (\"alerts_work_items\".\"alert_id\") IN (1) WHERE (\"work_item\".\"id\" = \"alerts_work_items\".\"work_item_id\")"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"alerts\" AS \"alert\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 1) AND (\"alert_view\".\"user_id\" = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts/show/1/1","ip":"","latency":4.826966,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"alerts\" AS \"alert\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 1) AND (\"alert_view\".\"user_id\" = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts/show/1/2","ip":"","latency":4.761681,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"alerts\" AS \"alert\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((\"alert_view\".\"id\" = 1) AND (\"alert_view\".\"user_id\" = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts/show/1/2","ip":"","latency":3.769728,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"alerts\" AS \"alert\" WHERE (id = 1)"}
{"level":"warn","time":"2022-06-22T13:30:41-04:00","message":"User 2 illegally tried to access alert 1 belonging to user 1. Permission was denied."}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/alerts/show/1/1","ip":"","latency":1.696938,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Error #01: permission denied\n"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"alerts\" AS \"alert\" WHERE (id = 1)"}
{"level":"warn","time":"2022-06-22T13:30:41-04:00","message":"User 3 illegally tried to access alert 1 belonging to user 2. Permission was denied."}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/alerts/show/1/2","ip":"","latency":1.478111,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Error #01: permission denied\n"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" ORDER BY \"created_at\" asc LIMIT 5 OFFSET 5"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): AlertView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type AlertView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for ''"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"alerts_view\" AS \"alert_view\""}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts?page=2&per_page=5&sort=created_at__asc","ip":"","latency":3.301958,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((type = 'Deletion Requested') AND (user_id = '2')) ORDER BY \"created_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): AlertView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type AlertView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(type = ?) AND (user_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"alerts_view\" AS \"alert_view\" WHERE ((type = 'Deletion Requested') AND (user_id = '2'))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts?type=Deletion+Requested&user_id=2","ip":"","latency":3.63582,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((institution_id = 2) AND (user_id = 2)) ORDER BY \"created_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): AlertView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type AlertView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(institution_id = ?) AND (user_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"alerts_view\" AS \"alert_view\" WHERE ((institution_id = 2) AND (user_id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts","ip":"","latency":3.968528,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst1.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.AlertIndex, ResourceType: Alert, ResourceID: 0, InstID: 3, Gin Path: /member-api/v3/alerts, Request Path: /member-api/v3/alerts, Permission: AlertRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/alerts"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/alerts?institution_id=3","ip":"","latency":1.80202,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = '3') AND (institution_id = 2) AND (user_id = 2)) ORDER BY \"created_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): AlertView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type AlertView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(user_id = ?) AND (institution_id = ?) AND (user_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = '3') AND (institution_id = 2) AND (user_id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts?user_id=3","ip":"","latency":2.930246,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((institution_id = '2') AND (user_id = '3') AND (institution_id = 2) AND (user_id = 3)) ORDER BY \"created_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): AlertView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type AlertView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(institution_id = ?) AND (user_id = ?) AND (institution_id = ?) AND (user_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"alerts_view\" AS \"alert_view\" WHERE ((institution_id = '2') AND (user_id = '3') AND (institution_id = 2) AND (user_id = 3))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts?institution_id=2&user_id=3","ip":"","latency":4.196193,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst1.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.AlertIndex, ResourceType: Alert, ResourceID: 0, InstID: 3, Gin Path: /member-api/v3/alerts, Request Path: /member-api/v3/alerts, Permission: AlertRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/alerts"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/alerts?institution_id=3","ip":"","latency":1.463164,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"alert_view\".\"id\", \"alert_view\".\"institution_id\", \"alert_view\".\"institution_name\", \"alert_view\".\"institution_identifier\", \"alert_view\".\"type\", \"alert_view\".\"subject\", \"alert_view\".\"content\", \"alert_view\".\"deletion_request_id\", \"alert_view\".\"created_at\", \"alert_view\".\"user_id\", \"alert_view\".\"user_name\", \"alert_view\".\"sent_at\", \"alert_view\".\"read_at\" FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = '2') AND (institution_id = 2) AND (user_id = 3)) ORDER BY \"created_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): AlertView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type AlertView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(user_id = ?) AND (institution_id = ?) AND (user_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"alerts_view\" AS \"alert_view\" WHERE ((user_id = '2') AND (institution_id = 2) AND (user_id = 3))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/alerts?user_id=2","ip":"","latency":4.38888,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"institution_id\" AS \"generic_file__institution_id\" FROM \"checksums\" AS \"checksum\" LEFT JOIN \"generic_files\" AS \"generic_file\" ON \"generic_file\".\"id\" = \"checksum\".\"generic_file_id\" WHERE (\"checksum\".\"id\" = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" WHERE ((id = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/checksums/show/1","ip":"","latency":4.673414,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"institution_id\" AS \"generic_file__institution_id\" FROM \"checksums\" AS \"checksum\" LEFT JOIN \"generic_files\" AS \"generic_file\" ON \"generic_file\".\"id\" = \"checksum\".\"generic_file_id\" WHERE (\"checksum\".\"id\" = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" WHERE ((id = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/checksums/show/1","ip":"","latency":4.074932,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"institution_id\" AS \"generic_file__institution_id\" FROM \"checksums\" AS \"checksum\" LEFT JOIN \"generic_files\" AS \"generic_file\" ON \"generic_file\".\"id\" = \"checksum\".\"generic_file_id\" WHERE (\"checksum\".\"id\" = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.ChecksumShow, ResourceType: Checksum, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/checksums/show/:id, Request Path: /member-api/v3/checksums/show/1, Permission: ChecksumRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/checksums/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/checksums/show/1","ip":"","latency":3.024445,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"institution_id\" AS \"generic_file__institution_id\" FROM \"checksums\" AS \"checksum\" LEFT JOIN \"generic_files\" AS \"generic_file\" ON \"generic_file\".\"id\" = \"checksum\".\"generic_file_id\" WHERE (\"checksum\".\"id\" = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" WHERE ((id = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/checksums/show/1","ip":"","latency":3.391995,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"institution_id\" AS \"generic_file__institution_id\" FROM \"checksums\" AS \"checksum\" LEFT JOIN \"generic_files\" AS \"generic_file\" ON \"generic_file\".\"id\" = \"checksum\".\"generic_file_id\" WHERE (\"checksum\".\"id\" = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.ChecksumShow, ResourceType: Checksum, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/checksums/show/:id, Request Path: /member-api/v3/checksums/show/1, Permission: ChecksumRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/checksums/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/checksums/show/1","ip":"","latency":2.326341,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" ORDER BY \"id\" asc LIMIT 5 OFFSET 5"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): ChecksumView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type ChecksumView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for ''"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"checksums_view\" AS \"checksum_view\""}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/checksums?page=2&per_page=5&sort=id__asc","ip":"","latency":2.694211,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" WHERE ((intellectual_object_id = '7') AND (state = 'A')) ORDER BY \"datetime\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): ChecksumView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type ChecksumView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(intellectual_object_id = ?) AND (state = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"checksums_view\" AS \"checksum_view\" WHERE ((intellectual_object_id = '7') AND (state = 'A'))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/checksums?intellectual_object_id=7&state=A","ip":"","latency":5.098827,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" WHERE ((institution_id = 2)) ORDER BY \"datetime\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): ChecksumView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type ChecksumView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(institution_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"checksums_view\" AS \"checksum_view\" WHERE ((institution_id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/checksums","ip":"","latency":2.682796,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.ChecksumIndex, ResourceType: Checksum, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/checksums, Request Path: /member-api/v3/checksums, Permission: ChecksumRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/checksums"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/checksums?institution_id=2","ip":"","latency":1.301058,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum_view\".\"id\", \"checksum_view\".\"algorithm\", \"checksum_view\".\"datetime\", \"checksum_view\".\"digest\", \"checksum_view\".\"state\", \"checksum_view\".\"generic_file_identifier\", \"checksum_view\".\"generic_file_id\", \"checksum_view\".\"intellectual_object_id\", \"checksum_view\".\"institution_id\", \"checksum_view\".\"created_at\", \"checksum_view\".\"updated_at\" FROM \"checksums_view\" AS \"checksum_view\" WHERE ((institution_id = 2)) ORDER BY \"datetime\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): ChecksumView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type ChecksumView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(institution_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"checksums_view\" AS \"checksum_view\" WHERE ((institution_id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/checksums","ip":"","latency":3.555241,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.ChecksumIndex, ResourceType: Checksum, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/checksums, Request Path: /member-api/v3/checksums, Permission: ChecksumRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/checksums"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/checksums?institution_id=2","ip":"","latency":1.152222,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_request\".\"id\", \"deletion_request\".\"institution_id\", \"deletion_request\".\"requested_by_id\", \"deletion_request\".\"requested_at\", \"deletion_request\".\"encrypted_confirmation_token\", \"deletion_request\".\"confirmed_by_id\", \"deletion_request\".\"confirmed_at\", \"deletion_request\".\"cancelled_by_id\", \"deletion_request\".\"cancelled_at\", \"deletion_request\".\"work_item_id\", \"requested_by\".\"id\" AS \"requested_by__id\", \"requested_by\".\"created_at\" AS \"requested_by__created_at\", \"requested_by\".\"updated_at\" AS \"requested_by__updated_at\", \"requested_by\".\"name\" AS \"requested_by__name\", \"requested_by\".\"email\" AS \"requested_by__email\", \"requested_by\".\"phone_number\" AS \"requested_by__phone_number\", \"requested_by\".\"encrypted_password\" AS \"requested_by__encrypted_password\", \"requested_by\".\"reset_password_token\" AS \"requested_by__reset_password_token\", \"requested_by\".\"reset_password_sent_at\" AS \"requested_by__reset_password_sent_at\", \"requested_by\".\"remember_created_at\" AS \"requested_by__remember_created_at\", \"requested_by\".\"sign_in_count\" AS \"requested_by__sign_in_count\", \"requested_by\".\"current_sign_in_at\" AS \"requested_by__current_sign_in_at\", \"requested_by\".\"last_sign_in_at\" AS \"requested_by__last_sign_in_at\", \"requested_by\".\"current_sign_in_ip\" AS \"requested_by__current_sign_in_ip\", \"requested_by\".\"last_sign_in_ip\" AS \"requested_by__last_sign_in_ip\", \"requested_by\".\"institution_id\" AS \"requested_by__institution_id\", \"requested_by\".\"encrypted_api_secret_key\" AS \"requested_by__encrypted_api_secret_key\", \"requested_by\".\"password_changed_at\" AS \"requested_by__password_changed_at\", \"requested_by\".\"encrypted_otp_secret\" AS \"requested_by__encrypted_otp_secret\", \"requested_by\".\"encrypted_otp_secret_iv\" AS \"requested_by__encrypted_otp_secret_iv\", \"requested_by\".\"encrypted_otp_secret_salt\" AS \"requested_by__encrypted_otp_secret_salt\", \"requested_by\".\"encrypted_otp_sent_at\" AS \"requested_by__encrypted_otp_sent_at\", \"requested_by\".\"consumed_timestep\" AS \"requested_by__consumed_timestep\", \"requested_by\".\"otp_required_for_login\" AS \"requested_by__otp_required_for_login\", \"requested_by\".\"deactivated_at\" AS \"requested_by__deactivated_at\", \"requested_by\".\"enabled_two_factor\" AS \"requested_by__enabled_two_factor\", \"requested_by\".\"confirmed_two_factor\" AS \"requested_by__confirmed_two_factor\", \"requested_by\".\"otp_backup_codes\" AS \"requested_by__otp_backup_codes\", \"requested_by\".\"authy_id\" AS \"requested_by__authy_id\", \"requested_by\".\"last_sign_in_with_authy\" AS \"requested_by__last_sign_in_with_authy\", \"requested_by\".\"authy_status\" AS \"requested_by__authy_status\", \"requested_by\".\"email_verified\" AS \"requested_by__email_verified\", \"requested_by\".\"initial_password_updated\" AS \"requested_by__initial_password_updated\", \"requested_by\".\"force_password_update\" AS \"requested_by__force_password_update\", \"requested_by\".\"grace_period\" AS \"requested_by__grace_period\", \"requested_by\".\"awaiting_second_factor\" AS \"requested_by__awaiting_second_factor\", \"requested_by\".\"role\" AS \"requested_by__role\", \"confirmed_by\".\"id\" AS \"confirmed_by__id\", \"confirmed_by\".\"created_at\" AS \"confirmed_by__created_at\", \"confirmed_by\".\"updated_at\" AS \"confirmed_by__updated_at\", \"confirmed_by\".\"name\" AS \"confirmed_by__name\", \"confirmed_by\".\"email\" AS \"confirmed_by__email\", \"confirmed_by\".\"phone_number\" AS \"confirmed_by__phone_number\", \"confirmed_by\".\"encrypted_password\" AS \"confirmed_by__encrypted_password\", \"confirmed_by\".\"reset_password_token\" AS \"confirmed_by__reset_password_token\", \"confirmed_by\".\"reset_password_sent_at\" AS \"confirmed_by__reset_password_sent_at\", \"confirmed_by\".\"remember_created_at\" AS \"confirmed_by__remember_created_at\", \"confirmed_by\".\"sign_in_count\" AS \"confirmed_by__sign_in_count\", \"confirmed_by\".\"current_sign_in_at\" AS \"confirmed_by__current_sign_in_at\", \"confirmed_by\".\"last_sign_in_at\" AS \"confirmed_by__last_sign_in_at\", \"confirmed_by\".\"current_sign_in_ip\" AS \"confirmed_by__current_sign_in_ip\", \"confirmed_by\".\"last_sign_in_ip\" AS \"confirmed_by__last_sign_in_ip\", \"confirmed_by\".\"institution_id\" AS \"confirmed_by__institution_id\", \"confirmed_by\".\"encrypted_api_secret_key\" AS \"confirmed_by__encrypted_api_secret_key\", \"confirmed_by\".\"password_changed_at\" AS \"confirmed_by__password_changed_at\", \"confirmed_by\".\"encrypted_otp_secret\" AS \"confirmed_by__encrypted_otp_secret\", \"confirmed_by\".\"encrypted_otp_secret_iv\" AS \"confirmed_by__encrypted_otp_secret_iv\", \"confirmed_by\".\"encrypted_otp_secret_salt\" AS \"confirmed_by__encrypted_otp_secret_salt\", \"confirmed_by\".\"encrypted_otp_sent_at\" AS \"confirmed_by__encrypted_otp_sent_at\", \"confirmed_by\".\"consumed_timestep\" AS \"confirmed_by__consumed_timestep\", \"confirmed_by\".\"otp_required_for_login\" AS \"confirmed_by__otp_required_for_login\", \"confirmed_by\".\"deactivated_at\" AS \"confirmed_by__deactivated_at\", \"confirmed_by\".\"enabled_two_factor\" AS \"confirmed_by__enabled_two_factor\", \"confirmed_by\".\"confirmed_two_factor\" AS \"confirmed_by__confirmed_two_factor\", \"confirmed_by\".\"otp_backup_codes\" AS \"confirmed_by__otp_backup_codes\", \"confirmed_by\".\"authy_id\" AS \"confirmed_by__authy_id\", \"confirmed_by\".\"last_sign_in_with_authy\" AS \"confirmed_by__last_sign_in_with_authy\", \"confirmed_by\".\"authy_status\" AS \"confirmed_by__authy_status\", \"confirmed_by\".\"email_verified\" AS \"confirmed_by__email_verified\", \"confirmed_by\".\"initial_password_updated\" AS \"confirmed_by__initial_password_updated\", \"confirmed_by\".\"force_password_update\" AS \"confirmed_by__force_password_update\", \"confirmed_by\".\"grace_period\" AS \"confirmed_by__grace_period\", \"confirmed_by\".\"awaiting_second_factor\" AS \"confirmed_by__awaiting_second_factor\", \"confirmed_by\".\"role\" AS \"confirmed_by__role\", \"cancelled_by\".\"id\" AS \"cancelled_by__id\", \"cancelled_by\".\"created_at\" AS \"cancelled_by__created_at\", \"cancelled_by\".\"updated_at\" AS \"cancelled_by__updated_at\", \"cancelled_by\".\"name\" AS \"cancelled_by__name\", \"cancelled_by\".\"email\" AS \"cancelled_by__email\", \"cancelled_by\".\"phone_number\" AS \"cancelled_by__phone_number\", \"cancelled_by\".\"encrypted_password\" AS \"cancelled_by__encrypted_password\", \"cancelled_by\".\"reset_password_token\" AS \"cancelled_by__reset_password_token\", \"cancelled_by\".\"reset_password_sent_at\" AS \"cancelled_by__reset_password_sent_at\", \"cancelled_by\".\"remember_created_at\" AS \"cancelled_by__remember_created_at\", \"cancelled_by\".\"sign_in_count\" AS \"cancelled_by__sign_in_count\", \"cancelled_by\".\"current_sign_in_at\" AS \"cancelled_by__current_sign_in_at\", \"cancelled_by\".\"last_sign_in_at\" AS \"cancelled_by__last_sign_in_at\", \"cancelled_by\".\"current_sign_in_ip\" AS \"cancelled_by__current_sign_in_ip\", \"cancelled_by\".\"last_sign_in_ip\" AS \"cancelled_by__last_sign_in_ip\", \"cancelled_by\".\"institution_id\" AS \"cancelled_by__institution_id\", \"cancelled_by\".\"encrypted_api_secret_key\" AS \"cancelled_by__encrypted_api_secret_key\", \"cancelled_by\".\"password_changed_at\" AS \"cancelled_by__password_changed_at\", \"cancelled_by\".\"encrypted_otp_secret\" AS \"cancelled_by__encrypted_otp_secret\", \"cancelled_by\".\"encrypted_otp_secret_iv\" AS \"cancelled_by__encrypted_otp_secret_iv\", \"cancelled_by\".\"encrypted_otp_secret_salt\" AS \"cancelled_by__encrypted_otp_secret_salt\", \"cancelled_by\".\"encrypted_otp_sent_at\" AS \"cancelled_by__encrypted_otp_sent_at\", \"cancelled_by\".\"consumed_timestep\" AS \"cancelled_by__consumed_timestep\", \"cancelled_by\".\"otp_required_for_login\" AS \"cancelled_by__otp_required_for_login\", \"cancelled_by\".\"deactivated_at\" AS \"cancelled_by__deactivated_at\", \"cancelled_by\".\"enabled_two_factor\" AS \"cancelled_by__enabled_two_factor\", \"cancelled_by\".\"confirmed_two_factor\" AS \"cancelled_by__confirmed_two_factor\", \"cancelled_by\".\"otp_backup_codes\" AS \"cancelled_by__otp_backup_codes\", \"cancelled_by\".\"authy_id\" AS \"cancelled_by__authy_id\", \"cancelled_by\".\"last_sign_in_with_authy\" AS \"cancelled_by__last_sign_in_with_authy\", \"cancelled_by\".\"authy_status\" AS \"cancelled_by__authy_status\", \"cancelled_by\".\"email_verified\" AS \"cancelled_by__email_verified\", \"cancelled_by\".\"initial_password_updated\" AS \"cancelled_by__initial_password_updated\", \"cancelled_by\".\"force_password_update\" AS \"cancelled_by__force_password_update\", \"cancelled_by\".\"grace_period\" AS \"cancelled_by__grace_period\", \"cancelled_by\".\"awaiting_second_factor\" AS \"cancelled_by__awaiting_second_factor\", \"cancelled_by\".\"role\" AS \"cancelled_by__role\", \"work_item\".\"id\" AS \"work_item__id\", \"work_item\".\"created_at\" AS \"work_item__created_at\", \"work_item\".\"updated_at\" AS \"work_item__updated_at\", \"work_item\".\"name\" AS \"work_item__name\", \"work_item\".\"etag\" AS \"work_item__etag\", \"work_item\".\"institution_id\" AS \"work_item__institution_id\", \"work_item\".\"intellectual_object_id\" AS \"work_item__intellectual_object_id\", \"work_item\".\"generic_file_id\" AS \"work_item__generic_file_id\", \"work_item\".\"bucket\" AS \"work_item__bucket\", \"work_item\".\"user\" AS \"work_item__user\", \"work_item\".\"note\" AS \"work_item__note\", \"work_item\".\"action\" AS \"work_item__action\", \"work_item\".\"stage\" AS \"work_item__stage\", \"work_item\".\"status\" AS \"work_item__status\", \"work_item\".\"outcome\" AS \"work_item__outcome\", \"work_item\".\"bag_date\" AS \"work_item__bag_date\", \"work_item\".\"date_processed\" AS \"work_item__date_processed\", \"work_item\".\"retry\" AS \"work_item__retry\", \"work_item\".\"node\" AS \"work_item__node\", \"work_item\".\"pid\" AS \"work_item__pid\", \"work_item\".\"needs_admin_review\" AS \"work_item__needs_admin_review\", \"work_item\".\"queued_at\" AS \"work_item__queued_at\", \"work_item\".\"size\" AS \"work_item__size\", \"work_item\".\"stage_started_at\" AS \"work_item__stage_started_at\", \"work_item\".\"aptrust_approver\" AS \"work_item__aptrust_approver\", \"work_item\".\"inst_approver\" AS \"work_item__inst_approver\" FROM \"deletion_requests\" AS \"deletion_request\" LEFT JOIN \"users\" AS \"requested_by\" ON \"requested_by\".\"id\" = \"deletion_request\".\"requested_by_id\" LEFT JOIN \"users\" AS \"confirmed_by\" ON \"confirmed_by\".\"id\" = \"deletion_request\".\"confirmed_by_id\" LEFT JOIN \"users\" AS \"cancelled_by\" ON \"cancelled_by\".\"id\" = \"deletion_request\".\"cancelled_by_id\" LEFT JOIN \"work_items\" AS \"work_item\" ON \"work_item\".\"id\" = \"deletion_request\".\"work_item_id\" WHERE ((\"deletion_request\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_requests_generic_files\".*, \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\" FROM \"generic_files\" AS \"generic_file\" JOIN \"deletion_requests_generic_files\" AS \"deletion_requests_generic_files\" ON (\"deletion_requests_generic_files\".\"deletion_request_id\") IN (2) WHERE (\"generic_file\".\"id\" = \"deletion_requests_generic_files\".\"generic_file_id\")"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_requests_intellectual_objects\".*, \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" FROM \"intellectual_objects\" AS \"intellectual_object\" JOIN \"deletion_requests_intellectual_objects\" AS \"deletion_requests_intellectual_objects\" ON (\"deletion_requests_intellectual_objects\".\"deletion_request_id\") IN (2) WHERE (\"intellectual_object\".\"id\" = \"deletion_requests_intellectual_objects\".\"intellectual_object_id\")"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE (id = 2)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/deletions/show/2","ip":"","latency":7.039157,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE (id = 2)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/deletions/show/2","ip":"","latency":7.496561,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE (id = 2)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.DeletionRequestShow, ResourceType: DeletionRequest, ResourceID: 2, InstID: 2, Gin Path: /member-api/v3/deletions/show/:id, Request Path: /member-api/v3/deletions/show/2, Permission: DeletionRequestShow, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/deletions/show/2"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/deletions/show/2","ip":"","latency":2.296919,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE (id = 2)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/deletions/show/2","ip":"","latency":6.73952,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"deletion_requests\" AS \"deletion_request\" WHERE (id = 2)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.DeletionRequestShow, ResourceType: DeletionRequest, ResourceID: 2, InstID: 2, Gin Path: /member-api/v3/deletions/show/:id, Request Path: /member-api/v3/deletions/show/2, Permission: DeletionRequestShow, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/deletions/show/2"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/deletions/show/2","ip":"","latency":1.909845,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" ORDER BY \"requested_at\" desc LIMIT 1 OFFSET 1"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): DeletionRequestView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type DeletionRequestView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for ''"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"deletion_requests_view\" AS \"deletion_request_view\""}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/deletions?page=2&per_page=1","ip":"","latency":7.379656,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((institution_id = 2)) ORDER BY \"requested_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): DeletionRequestView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type DeletionRequestView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(institution_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((institution_id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/deletions","ip":"","latency":9.776638,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.DeletionRequestIndex, ResourceType: DeletionRequest, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/deletions, Request Path: /member-api/v3/deletions, Permission: DeletionRequestList, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/deletions"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/deletions?institution_id=2","ip":"","latency":1.3923,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"deletion_request_view\".\"id\", \"deletion_request_view\".\"institution_id\", \"deletion_request_view\".\"institution_name\", \"deletion_request_view\".\"institution_identifier\", \"deletion_request_view\".\"requested_by_id\", \"deletion_request_view\".\"requested_by_name\", \"deletion_request_view\".\"requested_by_email\", \"deletion_request_view\".\"requested_at\", \"deletion_request_view\".\"confirmed_by_id\", \"deletion_request_view\".\"confirmed_by_name\", \"deletion_request_view\".\"confirmed_by_email\", \"deletion_request_view\".\"confirmed_at\", \"deletion_request_view\".\"cancelled_by_id\", \"deletion_request_view\".\"cancelled_by_name\", \"deletion_request_view\".\"cancelled_by_email\", \"deletion_request_view\".\"cancelled_at\", \"deletion_request_view\".\"file_count\", \"deletion_request_view\".\"object_count\", \"deletion_request_view\".\"work_item_id\", \"deletion_request_view\".\"stage\", \"deletion_request_view\".\"status\", \"deletion_request_view\".\"date_processed\", \"deletion_request_view\".\"size\", \"deletion_request_view\".\"note\" FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((institution_id = 2)) ORDER BY \"requested_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): DeletionRequestView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Cannot query count view for type DeletionRequestView: type is not supported for view count"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(institution_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"deletion_requests_view\" AS \"deletion_request_view\" WHERE ((institution_id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/deletions","ip":"","latency":7.908701,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.DeletionRequestIndex, ResourceType: DeletionRequest, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/deletions, Request Path: /member-api/v3/deletions, Permission: DeletionRequestList, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/deletions"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/deletions?institution_id=2","ip":"","latency":1.017308,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 1) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (1)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"generic_files\" AS \"generic_file\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 1) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (1)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/files/show/1","ip":"","latency":6.732035,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"generic_files\" AS \"generic_file\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 1) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (1)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/files/show/1","ip":"","latency":6.840452,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"generic_files\" AS \"generic_file\" WHERE (id = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.GenericFileShow, ResourceType: GenericFile, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/files/show/*id, Request Path: /member-api/v3/files/show/1, Permission: FileRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/files/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/files/show/1","ip":"","latency":1.47166,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"generic_files\" AS \"generic_file\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file\".\"id\", \"generic_file\".\"created_at\", \"generic_file\".\"updated_at\", \"generic_file\".\"file_format\", \"generic_file\".\"size\", \"generic_file\".\"identifier\", \"generic_file\".\"intellectual_object_id\", \"generic_file\".\"state\", \"generic_file\".\"last_fixity_check\", \"generic_file\".\"institution_id\", \"generic_file\".\"storage_option\", \"generic_file\".\"uuid\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\", \"intellectual_object\".\"id\" AS \"intellectual_object__id\", \"intellectual_object\".\"created_at\" AS \"intellectual_object__created_at\", \"intellectual_object\".\"updated_at\" AS \"intellectual_object__updated_at\", \"intellectual_object\".\"title\" AS \"intellectual_object__title\", \"intellectual_object\".\"description\" AS \"intellectual_object__description\", \"intellectual_object\".\"identifier\" AS \"intellectual_object__identifier\", \"intellectual_object\".\"alt_identifier\" AS \"intellectual_object__alt_identifier\", \"intellectual_object\".\"access\" AS \"intellectual_object__access\", \"intellectual_object\".\"bag_name\" AS \"intellectual_object__bag_name\", \"intellectual_object\".\"institution_id\" AS \"intellectual_object__institution_id\", \"intellectual_object\".\"state\" AS \"intellectual_object__state\", \"intellectual_object\".\"etag\" AS \"intellectual_object__etag\", \"intellectual_object\".\"bag_group_identifier\" AS \"intellectual_object__bag_group_identifier\", \"intellectual_object\".\"storage_option\" AS \"intellectual_object__storage_option\", \"intellectual_object\".\"bagit_profile_identifier\" AS \"intellectual_object__bagit_profile_identifier\", \"intellectual_object\".\"source_organization\" AS \"intellectual_object__source_organization\", \"intellectual_object\".\"internal_sender_identifier\" AS \"intellectual_object__internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\" AS \"intellectual_object__internal_sender_description\" FROM \"generic_files\" AS \"generic_file\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"generic_file\".\"institution_id\" LEFT JOIN \"intellectual_objects\" AS \"intellectual_object\" ON \"intellectual_object\".\"id\" = \"generic_file\".\"intellectual_object_id\" WHERE (generic_file.id = 1) ORDER BY \"generic_file\".\"id\" LIMIT 1"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE (\"premis_event\".\"generic_file_id\" IN (1)) ORDER BY \"premis_event\".\"date_time\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"checksum\".\"id\", \"checksum\".\"created_at\", \"checksum\".\"updated_at\", \"checksum\".\"algorithm\", \"checksum\".\"datetime\", \"checksum\".\"digest\", \"checksum\".\"generic_file_id\" FROM \"checksums\" AS \"checksum\" WHERE (\"checksum\".\"generic_file_id\" IN (1)) ORDER BY \"checksum\".\"created_at\" desc"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"storage_record\".\"id\", \"storage_record\".\"generic_file_id\", \"storage_record\".\"url\" FROM \"storage_records\" AS \"storage_record\" WHERE (\"storage_record\".\"generic_file_id\" IN (1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/files/show/1","ip":"","latency":3.963246,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"generic_files\" AS \"generic_file\" WHERE (id = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.GenericFileShow, ResourceType: GenericFile, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/files/show/*id, Request Path: /member-api/v3/files/show/1, Permission: FileRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/files/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/files/show/1","ip":"","latency":1.660452,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file_view\".\"id\", \"generic_file_view\".\"file_format\", \"generic_file_view\".\"size\", \"generic_file_view\".\"identifier\", \"generic_file_view\".\"intellectual_object_id\", \"generic_file_view\".\"object_identifier\", \"generic_file_view\".\"access\", \"generic_file_view\".\"state\", \"generic_file_view\".\"last_fixity_check\", \"generic_file_view\".\"institution_id\", \"generic_file_view\".\"institution_name\", \"generic_file_view\".\"institution_identifier\", \"generic_file_view\".\"storage_option\", \"generic_file_view\".\"uuid\", \"generic_file_view\".\"md5\", \"generic_file_view\".\"sha1\", \"generic_file_view\".\"sha256\", \"generic_file_view\".\"sha512\", \"generic_file_view\".\"created_at\", \"generic_file_view\".\"updated_at\" FROM \"generic_files_view\" AS \"generic_file_view\" ORDER BY \"id\" asc LIMIT 5 OFFSET 5"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query ''"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): GenericFileView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id is null) AND (state is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/files?page=2&per_page=5&sort=id__asc","ip":"","latency":5.39746,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file_view\".\"id\", \"generic_file_view\".\"file_format\", \"generic_file_view\".\"size\", \"generic_file_view\".\"identifier\", \"generic_file_view\".\"intellectual_object_id\", \"generic_file_view\".\"object_identifier\", \"generic_file_view\".\"access\", \"generic_file_view\".\"state\", \"generic_file_view\".\"last_fixity_check\", \"generic_file_view\".\"institution_id\", \"generic_file_view\".\"institution_name\", \"generic_file_view\".\"institution_identifier\", \"generic_file_view\".\"storage_option\", \"generic_file_view\".\"uuid\", \"generic_file_view\".\"md5\", \"generic_file_view\".\"sha1\", \"generic_file_view\".\"sha256\", \"generic_file_view\".\"sha512\", \"generic_file_view\".\"created_at\", \"generic_file_view\".\"updated_at\" FROM \"generic_files_view\" AS \"generic_file_view\" WHERE ((intellectual_object_id = '3') AND (state = 'A')) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Filter too specific for GenericFileView: intellectual_object_id -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(intellectual_object_id = ?) AND (state = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"generic_files_view\" AS \"generic_file_view\" WHERE ((intellectual_object_id = '3') AND (state = 'A'))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/files?intellectual_object_id=3&state=A","ip":"","latency":4.706206,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file_view\".\"id\", \"generic_file_view\".\"file_format\", \"generic_file_view\".\"size\", \"generic_file_view\".\"identifier\", \"generic_file_view\".\"intellectual_object_id\", \"generic_file_view\".\"object_identifier\", \"generic_file_view\".\"access\", \"generic_file_view\".\"state\", \"generic_file_view\".\"last_fixity_check\", \"generic_file_view\".\"institution_id\", \"generic_file_view\".\"institution_name\", \"generic_file_view\".\"institution_identifier\", \"generic_file_view\".\"storage_option\", \"generic_file_view\".\"uuid\", \"generic_file_view\".\"md5\", \"generic_file_view\".\"sha1\", \"generic_file_view\".\"sha256\", \"generic_file_view\".\"sha512\", \"generic_file_view\".\"created_at\", \"generic_file_view\".\"updated_at\" FROM \"generic_files_view\" AS \"generic_file_view\" WHERE ((institution_id = 2)) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): GenericFileView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 2) AND (state is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/files","ip":"","latency":5.09664,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.GenericFileIndex, ResourceType: GenericFile, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/files, Request Path: /member-api/v3/files, Permission: FileRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/files"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/files?institution_id=2","ip":"","latency":1.450982,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"generic_file_view\".\"id\", \"generic_file_view\".\"file_format\", \"generic_file_view\".\"size\", \"generic_file_view\".\"identifier\", \"generic_file_view\".\"intellectual_object_id\", \"generic_file_view\".\"object_identifier\", \"generic_file_view\".\"access\", \"generic_file_view\".\"state\", \"generic_file_view\".\"last_fixity_check\", \"generic_file_view\".\"institution_id\", \"generic_file_view\".\"institution_name\", \"generic_file_view\".\"institution_identifier\", \"generic_file_view\".\"storage_option\", \"generic_file_view\".\"uuid\", \"generic_file_view\".\"md5\", \"generic_file_view\".\"sha1\", \"generic_file_view\".\"sha256\", \"generic_file_view\".\"sha512\", \"generic_file_view\".\"created_at\", \"generic_file_view\".\"updated_at\" FROM \"generic_files_view\" AS \"generic_file_view\" WHERE ((institution_id = 2)) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): GenericFileView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): GenericFileView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"generic_file_counts\" AS \"generic_file_count\" WHERE ((institution_id = 2) AND (state is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/files","ip":"","latency":3.888675,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.GenericFileIndex, ResourceType: GenericFile, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/files, Request Path: /member-api/v3/files, Permission: FileRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/files"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/files?institution_id=2","ip":"","latency":1.007616,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object\".\"id\", \"intellectual_object\".\"created_at\", \"intellectual_object\".\"updated_at\", \"intellectual_object\".\"title\", \"intellectual_object\".\"description\", \"intellectual_object\".\"identifier\", \"intellectual_object\".\"alt_identifier\", \"intellectual_object\".\"access\", \"intellectual_object\".\"bag_name\", \"intellectual_object\".\"institution_id\", \"intellectual_object\".\"state\", \"intellectual_object\".\"etag\", \"intellectual_object\".\"bag_group_identifier\", \"intellectual_object\".\"storage_option\", \"intellectual_object\".\"bagit_profile_identifier\", \"intellectual_object\".\"source_organization\", \"intellectual_object\".\"internal_sender_identifier\", \"intellectual_object\".\"internal_sender_description\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"intellectual_objects\" AS \"intellectual_object\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"intellectual_object\".\"institution_id\" WHERE ((\"intellectual_object\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((\"intellectual_object_view\".\"id\" = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/objects/show/1","ip":"","latency":8.156417,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((\"intellectual_object_view\".\"id\" = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/objects/show/1","ip":"","latency":5.312274,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE (id = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.IntellectualObjectShow, ResourceType: IntellectualObject, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/objects/show/*id, Request Path: /member-api/v3/objects/show/1, Permission: IntellectualObjectRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/objects/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/objects/show/1","ip":"","latency":2.202555,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((\"intellectual_object_view\".\"id\" = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/objects/show/1","ip":"","latency":3.8032,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"intellectual_objects\" AS \"intellectual_object\" WHERE (id = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.IntellectualObjectShow, ResourceType: IntellectualObject, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/objects/show/*id, Request Path: /member-api/v3/objects/show/1, Permission: IntellectualObjectRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/objects/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/objects/show/1","ip":"","latency":1.483185,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" ORDER BY \"updated_at\" desc LIMIT 5 OFFSET 5"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query ''"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id is null) AND (state is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/objects?page=2&per_page=5","ip":"","latency":5.387687,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((access = 'consortia') AND (state = 'A')) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Filter too specific for IntellectualObjectView: access -> institution_id, state"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(access = ?) AND (state = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((access = 'consortia') AND (state = 'A'))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/objects?access=consortia&state=A","ip":"","latency":5.592574,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((institution_id = 2)) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id = 2) AND (state is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/objects","ip":"","latency":5.145262,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.IntellectualObjectIndex, ResourceType: IntellectualObject, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/objects, Request Path: /member-api/v3/objects, Permission: IntellectualObjectRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/objects"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/objects?institution_id=2","ip":"","latency":0.993602,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"intellectual_object_view\".\"id\", \"intellectual_object_view\".\"title\", \"intellectual_object_view\".\"description\", \"intellectual_object_view\".\"identifier\", \"intellectual_object_view\".\"alt_identifier\", \"intellectual_object_view\".\"access\", \"intellectual_object_view\".\"bag_name\", \"intellectual_object_view\".\"institution_id\", \"intellectual_object_view\".\"created_at\", \"intellectual_object_view\".\"updated_at\", \"intellectual_object_view\".\"state\", \"intellectual_object_view\".\"etag\", \"intellectual_object_view\".\"bag_group_identifier\", \"intellectual_object_view\".\"storage_option\", \"intellectual_object_view\".\"bagit_profile_identifier\", \"intellectual_object_view\".\"source_organization\", \"intellectual_object_view\".\"internal_sender_identifier\", \"intellectual_object_view\".\"internal_sender_description\", \"intellectual_object_view\".\"institution_name\", \"intellectual_object_view\".\"institution_identifier\", \"intellectual_object_view\".\"institution_type\", \"intellectual_object_view\".\"institution_parent_id\", \"intellectual_object_view\".\"file_count\", \"intellectual_object_view\".\"size\", \"intellectual_object_view\".\"payload_file_count\", \"intellectual_object_view\".\"payload_size\" FROM \"intellectual_objects_view\" AS \"intellectual_object_view\" WHERE ((institution_id = 2)) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): IntellectualObjectView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"intellectual_object_counts\" AS \"intellectual_object_count\" WHERE ((institution_id = 2) AND (state is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/objects","ip":"","latency":3.396268,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.IntellectualObjectIndex, ResourceType: IntellectualObject, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/objects, Request Path: /member-api/v3/objects, Permission: IntellectualObjectRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/objects"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/objects?institution_id=2","ip":"","latency":1.115391,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event\".\"id\", \"premis_event\".\"created_at\", \"premis_event\".\"updated_at\", \"premis_event\".\"agent\", \"premis_event\".\"date_time\", \"premis_event\".\"detail\", \"premis_event\".\"event_type\", \"premis_event\".\"generic_file_id\", \"premis_event\".\"identifier\", \"premis_event\".\"institution_id\", \"premis_event\".\"intellectual_object_id\", \"premis_event\".\"object\", \"premis_event\".\"old_uuid\", \"premis_event\".\"outcome\", \"premis_event\".\"outcome_detail\", \"premis_event\".\"outcome_information\" FROM \"premis_events\" AS \"premis_event\" WHERE ((\"premis_event\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"premis_events\" AS \"premis_event\" WHERE (id = 2)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events/show/2","ip":"","latency":3.346012,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"id\" FROM \"premis_events\" AS \"premis_event\" WHERE ((\"premis_event\".\"identifier\" = '6e9e665a-4f7e-41f4-9594-d511f9fc1edf'))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"premis_events\" AS \"premis_event\" WHERE (id = 2)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events/show/6e9e665a-4f7e-41f4-9594-d511f9fc1edf","ip":"","latency":6.145584,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"premis_events\" AS \"premis_event\" WHERE (id = 2)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events/show/2","ip":"","latency":4.753046,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"premis_events\" AS \"premis_event\" WHERE (id = 2)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.PremisEventShow, ResourceType: PremisEvent, ResourceID: 2, InstID: 2, Gin Path: /member-api/v3/events/show/*id, Request Path: /member-api/v3/events/show/2, Permission: EventRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/events/show/2"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/events/show/2","ip":"","latency":2.46381,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"premis_events\" AS \"premis_event\" WHERE (id = 2)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((id = 2))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events/show/2","ip":"","latency":3.798033,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"premis_events\" AS \"premis_event\" WHERE (id = 2)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.PremisEventShow, ResourceType: PremisEvent, ResourceID: 2, InstID: 2, Gin Path: /member-api/v3/events/show/*id, Request Path: /member-api/v3/events/show/2, Permission: EventRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/events/show/2"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/events/show/2","ip":"","latency":2.151136,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" ORDER BY \"date_time\" desc LIMIT 5 OFFSET 5"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query ''"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id is null) AND (event_type is null) AND (outcome is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events?page=2&per_page=5","ip":"","latency":3.397684,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((intellectual_object_id = '3')) ORDER BY \"date_time\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"Filter too specific for PremisEventView: intellectual_object_id -> institution_id, event_type, outcome"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using standard count query for '(intellectual_object_id = ?)'"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT count(*) FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((intellectual_object_id = '3'))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events?intellectual_object_id=3","ip":"","latency":3.227175,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((institution_id = 2)) ORDER BY \"date_time\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 2) AND (event_type is null) AND (outcome is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events","ip":"","latency":3.515238,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.PremisEventIndex, ResourceType: PremisEvent, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/events, Request Path: /member-api/v3/events, Permission: EventRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/events"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/events?institution_id=2","ip":"","latency":1.496502,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"premis_event_view\".\"id\", \"premis_event_view\".\"agent\", \"premis_event_view\".\"created_at\", \"premis_event_view\".\"date_time\", \"premis_event_view\".\"detail\", \"premis_event_view\".\"event_type\", \"premis_event_view\".\"generic_file_id\", \"premis_event_view\".\"generic_file_identifier\", \"premis_event_view\".\"identifier\", \"premis_event_view\".\"institution_id\", \"premis_event_view\".\"institution_name\", \"premis_event_view\".\"intellectual_object_id\", \"premis_event_view\".\"intellectual_object_identifier\", \"premis_event_view\".\"object\", \"premis_event_view\".\"old_uuid\", \"premis_event_view\".\"outcome\", \"premis_event_view\".\"outcome_detail\", \"premis_event_view\".\"outcome_information\", \"premis_event_view\".\"updated_at\" FROM \"premis_events_view\" AS \"premis_event_view\" WHERE ((institution_id = 2)) ORDER BY \"date_time\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): PremisEventView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): PremisEventView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"premis_event_counts\" AS \"premis_event_count\" WHERE ((institution_id = 2) AND (event_type is null) AND (outcome is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/events","ip":"","latency":4.854622,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.PremisEventIndex, ResourceType: PremisEvent, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/events, Request Path: /member-api/v3/events, Permission: EventRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/events"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/events?institution_id=2","ip":"","latency":1.009645,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item\".\"id\", \"work_item\".\"created_at\", \"work_item\".\"updated_at\", \"work_item\".\"name\", \"work_item\".\"etag\", \"work_item\".\"institution_id\", \"work_item\".\"intellectual_object_id\", \"work_item\".\"generic_file_id\", \"work_item\".\"bucket\", \"work_item\".\"user\", \"work_item\".\"note\", \"work_item\".\"action\", \"work_item\".\"stage\", \"work_item\".\"status\", \"work_item\".\"outcome\", \"work_item\".\"bag_date\", \"work_item\".\"date_processed\", \"work_item\".\"retry\", \"work_item\".\"node\", \"work_item\".\"pid\", \"work_item\".\"needs_admin_review\", \"work_item\".\"queued_at\", \"work_item\".\"size\", \"work_item\".\"stage_started_at\", \"work_item\".\"aptrust_approver\", \"work_item\".\"inst_approver\" FROM \"work_items\" AS \"work_item\" WHERE ((id = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"work_items\" AS \"work_item\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((id = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/items/show/1","ip":"","latency":3.650692,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"work_items\" AS \"work_item\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((id = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/items/show/1","ip":"","latency":3.367948,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"work_items\" AS \"work_item\" WHERE (id = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.WorkItemShow, ResourceType: WorkItem, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/items/show/:id, Request Path: /member-api/v3/items/show/1, Permission: WorkItemRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/items/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/items/show/1","ip":"","latency":1.786145,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"work_items\" AS \"work_item\" WHERE (id = 1)"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((id = 1))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/items/show/1","ip":"","latency":5.44266,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"institution_id\" FROM \"work_items\" AS \"work_item\" WHERE (id = 1)"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.WorkItemShow, ResourceType: WorkItem, ResourceID: 1, InstID: 2, Gin Path: /member-api/v3/items/show/:id, Request Path: /member-api/v3/items/show/1, Permission: WorkItemRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/items/show/1"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/items/show/1","ip":"","latency":2.393426,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" ORDER BY \"updated_at\" desc LIMIT 5 OFFSET 5"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query ''"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id is null) AND (action is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/items?page=2&per_page=5","ip":"","latency":6.559042,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 1))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = '3')) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = '3') AND (action is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/items?institution_id=3","ip":"","latency":5.125294,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 2))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = 2)) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 2) AND (action is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/items","ip":"","latency":4.61331,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 5))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User admin@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.WorkItemIndex, ResourceType: WorkItem, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/items, Request Path: /member-api/v3/items, Permission: WorkItemRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/items"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/items?institution_id=2","ip":"","latency":2.040488,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 3))"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"work_item_view\".\"id\", \"work_item_view\".\"name\", \"work_item_view\".\"etag\", \"work_item_view\".\"institution_id\", \"work_item_view\".\"institution_name\", \"work_item_view\".\"institution_identifier\", \"work_item_view\".\"intellectual_object_id\", \"work_item_view\".\"object_identifier\", \"work_item_view\".\"alt_identifier\", \"work_item_view\".\"bag_group_identifier\", \"work_item_view\".\"storage_option\", \"work_item_view\".\"bagit_profile_identifier\", \"work_item_view\".\"source_organization\", \"work_item_view\".\"internal_sender_identifier\", \"work_item_view\".\"generic_file_id\", \"work_item_view\".\"generic_file_identifier\", \"work_item_view\".\"bucket\", \"work_item_view\".\"user\", \"work_item_view\".\"note\", \"work_item_view\".\"action\", \"work_item_view\".\"stage\", \"work_item_view\".\"status\", \"work_item_view\".\"outcome\", \"work_item_view\".\"bag_date\", \"work_item_view\".\"date_processed\", \"work_item_view\".\"retry\", \"work_item_view\".\"node\", \"work_item_view\".\"pid\", \"work_item_view\".\"needs_admin_review\", \"work_item_view\".\"queued_at\", \"work_item_view\".\"size\", \"work_item_view\".\"stage_started_at\", \"work_item_view\".\"aptrust_approver\", \"work_item_view\".\"inst_approver\", \"work_item_view\".\"created_at\", \"work_item_view\".\"updated_at\" FROM \"work_items_view\" AS \"work_item_view\" WHERE ((institution_id = 2)) ORDER BY \"updated_at\" desc LIMIT 20"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"API: Using view to count query '(institution_id = ?)'"}
{"level":"info","time":"2022-06-22T13:30:41-04:00","message":"TypeName (1): WorkItemView"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"row_count\" FROM \"work_item_counts\" AS \"work_item_count\" WHERE ((institution_id = 2) AND (action is null))"}
{"level":"info","status":200,"method":"GET","path":"/member-api/v3/items","ip":"","latency":5.509855,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"Starting SQL: SELECT \"user\".\"id\", \"user\".\"created_at\", \"user\".\"updated_at\", \"user\".\"name\", \"user\".\"email\", \"user\".\"phone_number\", \"user\".\"encrypted_password\", \"user\".\"reset_password_token\", \"user\".\"reset_password_sent_at\", \"user\".\"remember_created_at\", \"user\".\"sign_in_count\", \"user\".\"current_sign_in_at\", \"user\".\"last_sign_in_at\", \"user\".\"current_sign_in_ip\", \"user\".\"last_sign_in_ip\", \"user\".\"institution_id\", \"user\".\"encrypted_api_secret_key\", \"user\".\"password_changed_at\", \"user\".\"encrypted_otp_secret\", \"user\".\"encrypted_otp_secret_iv\", \"user\".\"encrypted_otp_secret_salt\", \"user\".\"encrypted_otp_sent_at\", \"user\".\"consumed_timestep\", \"user\".\"otp_required_for_login\", \"user\".\"deactivated_at\", \"user\".\"enabled_two_factor\", \"user\".\"confirmed_two_factor\", \"user\".\"otp_backup_codes\", \"user\".\"authy_id\", \"user\".\"last_sign_in_with_authy\", \"user\".\"authy_status\", \"user\".\"email_verified\", \"user\".\"initial_password_updated\", \"user\".\"force_password_update\", \"user\".\"grace_period\", \"user\".\"awaiting_second_factor\", \"user\".\"role\", \"institution\".\"id\" AS \"institution__id\", \"institution\".\"created_at\" AS \"institution__created_at\", \"institution\".\"updated_at\" AS \"institution__updated_at\", \"institution\".\"name\" AS \"institution__name\", \"institution\".\"identifier\" AS \"institution__identifier\", \"institution\".\"state\" AS \"institution__state\", \"institution\".\"type\" AS \"institution__type\", \"institution\".\"member_institution_id\" AS \"institution__member_institution_id\", \"institution\".\"deactivated_at\" AS \"institution__deactivated_at\", \"institution\".\"otp_enabled\" AS \"institution__otp_enabled\", \"institution\".\"enable_spot_restore\" AS \"institution__enable_spot_restore\", \"institution\".\"receiving_bucket\" AS \"institution__receiving_bucket\", \"institution\".\"restore_bucket\" AS \"institution__restore_bucket\" FROM \"users\" AS \"user\" LEFT JOIN \"institutions\" AS \"institution\" ON \"institution\".\"id\" = \"user\".\"institution_id\" WHERE ((\"user\".\"id\" = 7))"}
{"level":"error","time":"2022-06-22T13:30:41-04:00","message":"Not Authorized: User user@inst2.edu, Remote IP: , Handler: github.com/APTrust/registry/web/api/common.WorkItemIndex, ResourceType: WorkItem, ResourceID: 0, InstID: 2, Gin Path: /member-api/v3/items, Request Path: /member-api/v3/items, Permission: WorkItemRead, ResourceIdentifier:  "}
{"level":"debug","time":"2022-06-22T13:30:41-04:00","message":"IsAPIRoute - YES - /member-api/v3/items"}
{"level":"warn","status":403,"method":"GET","path":"/member-api/v3/items?institution_id=2","ip":"","latency":1.479649,"user-agent":"","time":"2022-06-22T13:30:41-04:00","message":"Request"}
